<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>(Mask R-CNN) AssertionError when I run inspect_model.py in run_graph()</title>
      <link href="/2021/09/17/(Mask-R-CNN)-AssertionError-in%20run_graph()/"/>
      <url>/2021/09/17/(Mask-R-CNN)-AssertionError-in%20run_graph()/</url>
      
        <content type="html"><![CDATA[<h1 id="Mask-R-CNN-AssertionError-when-I-run-inspect-model-py-in-run-graph"><a href="#Mask-R-CNN-AssertionError-when-I-run-inspect-model-py-in-run-graph" class="headerlink" title="(Mask R-CNN) AssertionError when I run inspect_model.py in run_graph()"></a>(Mask R-CNN) AssertionError when I run inspect_model.py in run_graph()</h1><p>BUG:</p><p><code>inspect_model.ipynb</code>的 <code>###1.b RPN Prediction</code>部分，<code>run_graph()</code>报错``AssertionError`</p><pre class="line-numbers language-none"><code class="language-none">\# Run RPN sub-graphpillar = model.keras_model.get_layer("ROI").output # node to start searching fromrpn = model.run_graph([image], [  ("rpn_class", model.keras_model.get_layer("rpn_class").output),  ("pre_nms_anchors", model.ancestor(pillar, "ROI/pre_nms_anchors:0")),  ("refined_anchors", model.ancestor(pillar, "ROI/refined_anchors:0")),  ("refined_anchors_clipped", model.ancestor(pillar, "ROI/refined_anchors_clipped:0")),  ("post_nms_anchor_ix", model.ancestor(pillar, "ROI/rpn_non_max_suppression:0")),  ("proposals", model.keras_model.get_layer("ROI").output),])<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>====&gt;</p><pre class="line-numbers language-none"><code class="language-none">AssertionError      Traceback (most recent call last)&lt;ipython-input-14-799ca4676404&gt; in &lt;module&gt;()   7   ("refined_anchors_clipped", model.ancestor(pillar, "ROI/refined_anchors_clipped:0")),   8   ("post_nms_anchor_ix", model.ancestor(pillar, "ROI/rpn_non_max_suppression:0")),----&gt; 9   ("proposals", model.keras_model.get_layer("ROI").output),   10 ])/home/orestisz/repositories/Mask_RCNN/model.py in run_graph(self, images, outputs)  2296     for o in outputs.values():  2297       print(o)-&gt; 2298       assert o is not None  2299   2300     # Build a Keras function to run parts of the computation graphAssertionError:<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><strong>解决：</strong></p><p>TensorFlow 1.4引入了一个新版本的NMS(No-max-suppression)操作，并使用了一个新名称。</p><p>学会在github上找issue：<a href="https://github.com/matterport/Mask_RCNN/issues?q=run_graph++AssertionError">run_graph AssertionError </a></p><ul><li><p><a href="https://github.com/matterport/Mask_RCNN/issues/941">Working with a more recent Tensorflow version #941 说是版本问题</a></p></li><li><p><a href="https://github.com/matterport/Mask_RCNN/issues/23"><strong>AssertionError in run_graph #23</strong> 成功解决,我用这个</a></p></li><li><p><a href="https://github.com/matterport/Mask_RCNN/issues/893">AssertionError when I run inspect_model.py #893 也能解决</a></p></li><li><p><a href="https://github.com/matterport/Mask_RCNN/commit/c61909a392e5f124e756140903aa34c093e95cfb">make it compatible with TF 1.9~1.10, fix bugs 官方采用 接issue#893</a></p></li></ul>]]></content>
      
      
      <categories>
          
          <category> BUG </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 深度学习 </tag>
            
            <tag> tensorflow </tag>
            
            <tag> keras </tag>
            
            <tag> Mask R-CNN </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>解决tensorboard 1.13.1 无法打开生成的网址</title>
      <link href="/2021/09/11/solve-tensorboard-1.13.1-cannot-open-url/"/>
      <url>/2021/09/11/solve-tensorboard-1.13.1-cannot-open-url/</url>
      
        <content type="html"><![CDATA[<h1 id="解决tensorboard-1-13-1-无法打开生成的网址"><a href="#解决tensorboard-1-13-1-无法打开生成的网址" class="headerlink" title="解决tensorboard 1.13.1 无法打开生成的网址"></a>解决tensorboard 1.13.1 无法打开生成的网址</h1><p>使用命令：</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">tensorboard --logdir<span class="token operator">=</span>logs<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>得到如下网址：</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">TensorBoard <span class="token number">1.15</span>.0 at http://LAPTOP-10GIDQTB:6006/ <span class="token punctuation">(</span>Press CTRL+C to quit<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>出现了计算机的名字<code>LAPTOP-10GIDQTB</code></p><p><strong>在命令行中加上<code>--host=127.0.0.1</code>，即可完美解决</strong></p><p>完整命令：</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">tensorboard --logdir<span class="token operator">=</span>colab_logs --host<span class="token operator">=</span><span class="token number">127.0</span>.0.1<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>]]></content>
      
      
      <categories>
          
          <category> tensorflow </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 深度学习 </tag>
            
            <tag> tensorflow </tag>
            
            <tag> keras </tag>
            
            <tag> BUG </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>python开发中遇到的原生问题</title>
      <link href="/2021/09/11/python_BUG/"/>
      <url>/2021/09/11/python_BUG/</url>
      
        <content type="html"><![CDATA[<h1 id="python开发中遇到的原生问题"><a href="#python开发中遇到的原生问题" class="headerlink" title="python开发中遇到的原生问题"></a>python开发中遇到的原生问题</h1><p><strong>BUG：</strong></p><ul><li><p>```<br>BUG:QObject::startTimer: Timers cannot be started from another thread</p><pre class="line-numbers language-none"><code class="language-none">- 原因：多线程问题。在子线程中对主线程的对象进行操作。- 解决方案：子线程中发送信号，然后再主线程中接受信号并执行相应的操作。**BUG：**- ```  QObject::setParent: Cannot set parent, new parent is in a different thread  QBackingStore::endPaint() called with active painter; did you forget to destroy it or call QPainter::end() on it?<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></li><li><p>解决方法：子线程发送信号，数据为item，报错！！</p></li><li><p>暂未解决</p></li></ul><p>BUG：</p><ul><li><pre><code>ImportError: cannot import name ‘Flask’ from partially initialized module ‘flask’ (most likely due to a circular import) (C:\Users\Administrator\PycharmProjects\test\venv\lib\site-packages\flask_init_.py)</code></pre></li><li><p>原因：导入的包和运行.py脚本的名字相同，改名即可</p></li></ul>]]></content>
      
      
      <categories>
          
          <category> Python </category>
          
      </categories>
      
      
        <tags>
            
            <tag> BUG </tag>
            
            <tag> Python </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>mask r-cnn 遇到的坑</title>
      <link href="/2021/09/09/mask_rcnn-bug-note/"/>
      <url>/2021/09/09/mask_rcnn-bug-note/</url>
      
        <content type="html"><![CDATA[<h1 id="mask-r-cnn-遇到的坑-记录"><a href="#mask-r-cnn-遇到的坑-记录" class="headerlink" title="mask r-cnn 遇到的坑 记录"></a>mask r-cnn 遇到的坑 记录</h1><h2 id="BUG：module-‘tensorflow-compat-v2-internal‘-has-no-attribute-‘register-clear-session-function’-已解决"><a href="#BUG：module-‘tensorflow-compat-v2-internal‘-has-no-attribute-‘register-clear-session-function’-已解决" class="headerlink" title="BUG：module ‘tensorflow.compat.v2.internal‘ has no attribute ‘register_clear_session_function’ 已解决"></a>BUG：module ‘tensorflow.compat.v2.<strong>internal</strong>‘ has no attribute ‘register_clear_session_function’ 已解决</h2><p>更新tensorflow版本</p><h2 id="tensorflow-python-keras-engine’-has-no-attribute-‘Layer’-已解决"><a href="#tensorflow-python-keras-engine’-has-no-attribute-‘Layer’-已解决" class="headerlink" title="tensorflow.python.keras.engine’ has no attribute ‘Layer’ 已解决"></a>tensorflow.python.keras.engine’ has no attribute ‘Layer’ 已解决</h2><p>改为：</p><pre class="line-numbers language-none"><code class="language-none">keras.layers.Layer<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><a href="https://www.e-learn.cn/topic/2433086">https://www.e-learn.cn/topic/2433086</a></p><h2 id="Tried-to-convert-‘shape’-to-a-tensor-and-failed-Error-None-values-not-supported"><a href="#Tried-to-convert-‘shape’-to-a-tensor-and-failed-Error-None-values-not-supported" class="headerlink" title="Tried to convert ‘shape’ to a tensor and failed. Error: None values not supported."></a>Tried to convert ‘shape’ to a tensor and failed. Error: None values not supported.</h2><p><a href="https://github.com/matterport/Mask_RCNN/issues/1820">https://github.com/matterport/Mask_RCNN/issues/1820</a></p><h3 id="NO-1"><a href="#NO-1" class="headerlink" title="NO.1"></a>NO.1</h3><p>You can also try call <code>tf.reshape(out_tensor, self.compute_output_shape(input_shape))</code> after each usage of Custom Layer.<br>More info:<br><a href="https://stackoverflow.com/questions/51028861/tensorflow-compute-output-shape-not-working-for-custom-layer">https://stackoverflow.com/questions/51028861/tensorflow-compute-output-shape-not-working-for-custom-layer</a><br><a href="https://github.com/tensorflow/tensorflow/issues/33785">tensorflow/tensorflow#33785</a></p><p>But in spite of this, the model summary differ in keras and tf.keras.</p><h3 id="NO-2"><a href="#NO-2" class="headerlink" title="NO.2"></a>NO.2</h3><p>To solve the problem, you can change this line:<br><code>mrcnn_bbox = KL.Reshape((s[1], num_classes, 4), name="mrcnn_bbox")(x)</code><br>by :<br><code>mrcnn_bbox = KL.Reshape((-1, num_classes, 4), name="mrcnn_bbox")(x)</code></p><p>It works for me and the output is fine.</p><h1 id="tf1-13-2"><a href="#tf1-13-2" class="headerlink" title="tf1.13.2"></a>tf1.13.2</h1><h2 id="解决编码问题：AttributeError-‘str’-object-has-no-attribute-‘decode’"><a href="#解决编码问题：AttributeError-‘str’-object-has-no-attribute-‘decode’" class="headerlink" title="解决编码问题：AttributeError: ‘str’ object has no attribute ‘decode’"></a>解决编码问题：AttributeError: ‘str’ object has no attribute ‘decode’</h2><ol><li>出现问题原因：str与bytes表示的是两种数据类型，str为字符串型，bytes为字节型。对str编码encode得到bytes，<br>对bytes解码得到str，两者互为转换。而上面出现问题的原因是对str字符串使用了解码，显然是猪头不对马尾。</li><li>删除<code>decode('utf-8')</code></li></ol><pre class="line-numbers language-none"><code class="language-none">pip install h5py==2.10.0<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h2 id="invalid-literal-for-int-with-base-10-‘pths’"><a href="#invalid-literal-for-int-with-base-10-‘pths’" class="headerlink" title="invalid literal for int() with base 10: ‘pths’"></a>invalid literal for int() with base 10: ‘pths’</h2><pre class="line-numbers language-python" data-language="python"><code class="language-python">nameinfo <span class="token operator">=</span> <span class="token string">"pths"</span>image_info<span class="token punctuation">.</span>update<span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token string">"id"</span><span class="token punctuation">:</span> <span class="token builtin">int</span><span class="token punctuation">(</span>name_info<span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>强制转换成int类型时，传入的字符串必须是有数字字符组成的，例如：<code>x = int("111")</code></p><h2 id="加载权重时出现“AttributeError-‘str‘-object-has-no-attribute-‘decode‘-“"><a href="#加载权重时出现“AttributeError-‘str‘-object-has-no-attribute-‘decode‘-“" class="headerlink" title="加载权重时出现“AttributeError: ‘str‘ object has no attribute ‘decode‘ “"></a>加载权重时出现“AttributeError: ‘str‘ object has no attribute ‘decode‘ “</h2><p><a href="https://blog.csdn.net/weixin_45371989/article/details/109789132?utm_medium=distribute.pc_relevant.none-task-blog-2~default~BlogCommendFromMachineLearnPai2~default-3.essearch_pc_relevant&amp;depth_1-utm_source=distribute.pc_relevant.none-task-blog-2~default~BlogCommendFromMachineLearnPai2~default-3.essearch_pc_relevant">https://blog.csdn.net/weixin_45371989/article/details/109789132?utm_medium=distribute.pc_relevant.none-task-blog-2%7Edefault%7EBlogCommendFromMachineLearnPai2%7Edefault-3.essearch_pc_relevant&amp;depth_1-utm_source=distribute.pc_relevant.none-task-blog-2%7Edefault%7EBlogCommendFromMachineLearnPai2%7Edefault-3.essearch_pc_relevant</a></p><h3 id="解决办法"><a href="#解决办法" class="headerlink" title="解决办法"></a>解决办法</h3><p>貌似是由于h5py模块的版本问题，改用2.10版本</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">pip install h5py<span class="token operator">==</span><span class="token number">2.10</span> <span class="token operator">-</span>i https<span class="token punctuation">:</span><span class="token operator">//</span>pypi<span class="token punctuation">.</span>doubanio<span class="token punctuation">.</span>com<span class="token operator">/</span>simple<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h2 id="发生异常-IndexError-：boolean-index-did-not-match-indexed-array-along-dimension-0-dimension-is-0-but-corresponding-boolean-dimension-is-1"><a href="#发生异常-IndexError-：boolean-index-did-not-match-indexed-array-along-dimension-0-dimension-is-0-but-corresponding-boolean-dimension-is-1" class="headerlink" title="发生异常: IndexError ：boolean index did not match indexed array along dimension 0; dimension is 0 but corresponding boolean dimension is 1"></a>发生异常: IndexError ：boolean index did not match indexed array along dimension 0; dimension is 0 but corresponding boolean dimension is 1</h2><ul><li><p>暂未解决，环境配置成一模一样也没用</p></li><li><p><strong>后来发现没有更改分类的参数</strong>T_T</p></li></ul><h2 id="Input-image-dtype-is-bool-Interpolation-is-not-defined-with-bool-data-type"><a href="#Input-image-dtype-is-bool-Interpolation-is-not-defined-with-bool-data-type" class="headerlink" title="Input image dtype is bool. Interpolation is not defined with bool data type"></a>Input image dtype is bool. Interpolation is not defined with bool data type</h2><p><a href="https://stackoverflow.com/questions/62330374/input-image-dtype-is-bool-interpolation-is-not-defined-with-bool-data-type">https://stackoverflow.com/questions/62330374/input-image-dtype-is-bool-interpolation-is-not-defined-with-bool-data-type</a></p><pre class="line-numbers language-none"><code class="language-none">pip install -U scikit-image==0.16.2<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h2 id="Error-when-checking-input-expected-input-image-meta-to-have-shape-15-but-got-array-with-shape-16"><a href="#Error-when-checking-input-expected-input-image-meta-to-have-shape-15-but-got-array-with-shape-16" class="headerlink" title="Error when checking input: expected input_image_meta to have shape (15,) but got array with shape (16,)"></a>Error when checking input: expected input_image_meta to have shape (15,) but got array with shape (16,)</h2><p><strong>解决：</strong>因为我增加了一类，但是没有修改<code>class_nums</code></p><p>解决办法是修改NUM_CLASSES参数，增加了多少类，就对应的修改对应数值</p><pre class="line-numbers language-none"><code class="language-none">NUM_CLASSES = 1 + 1  <span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><a href="https://blog.csdn.net/oMoDao1/article/details/83860101">https://blog.csdn.net/oMoDao1/article/details/83860101</a></p><h2 id="AttributeError-module-‘yaml’-has-no-attribute-‘FullLoader’"><a href="#AttributeError-module-‘yaml’-has-no-attribute-‘FullLoader’" class="headerlink" title="AttributeError: module ‘yaml’ has no attribute ‘FullLoader’"></a>AttributeError: module ‘yaml’ has no attribute ‘FullLoader’</h2><pre class="line-numbers language-none"><code class="language-none">pip install --ignore-installed PyYAML<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><ul><li><p>[1].AttributeError: ‘module’ object has no attribute ‘FullLoader’. <a href="https://github.com/Yelp/elastalert/issues/2298">https://github.com/Yelp/elastalert/issues/2298</a></p></li><li><p>[2].安装yaml报错：ERROR: Cannot uninstall ‘PyYAML’. <a href="https://blog.csdn.net/weixin_41010198/article/details/103852838">https://blog.csdn.net/weixin_41010198/article/details/103852838</a></p></li></ul><h2 id="keras-导入包报错-ImportError-cannot-import-name-‘moving-averages’"><a href="#keras-导入包报错-ImportError-cannot-import-name-‘moving-averages’" class="headerlink" title="keras 导入包报错 ImportError: cannot import name ‘moving_averages’"></a>keras 导入包报错 ImportError: cannot import name ‘moving_averages’</h2><pre class="line-numbers language-none"><code class="language-none">pip3 install --upgrade --ignore-installed tensorflow-gpu==1.13.2<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><a href="https://github.com/tensorflow/tensorflow/issues/8513">https://github.com/tensorflow/tensorflow/issues/8513</a></p><h2 id="AttributeError-module-‘labelme-utils’-has-no-attribute-‘draw-label’"><a href="#AttributeError-module-‘labelme-utils’-has-no-attribute-‘draw-label’" class="headerlink" title="AttributeError: module ‘labelme.utils’ has no attribute ‘draw_label’"></a>AttributeError: module ‘labelme.utils’ has no attribute ‘draw_label’</h2><p>将版本降为3.16.2</p><pre class="line-numbers language-none"><code class="language-none">pip install labelme==3.16.2<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h2 id="IndexError-boolean-index-did-not-match-indexed-array-along-dimension-0-dimension-is-0-but-corresponding-boolean-dimension-is-1"><a href="#IndexError-boolean-index-did-not-match-indexed-array-along-dimension-0-dimension-is-0-but-corresponding-boolean-dimension-is-1" class="headerlink" title="IndexError: boolean index did not match indexed array along dimension 0; dimension is 0 but corresponding boolean dimension is 1"></a>IndexError: boolean index did not match indexed array along dimension 0; dimension is 0 but corresponding boolean dimension is 1</h2><p><a href="https://blog.csdn.net/Alchemist_wjt/article/details/89954791?ops_request_misc=&amp;request_id=&amp;biz_id=102&amp;utm_term=IndexError:%20boolean%20index%20did%20&amp;utm_medium=distribute.pc_search_result.none-task-blog-2~all~sobaiduweb~default-6-89954791.pc_search_result_hbase_insert&amp;spm=1018.2226.3001.4187">https://blog.csdn.net/Alchemist_wjt/article/details/89954791?ops_request_misc=&amp;request_id=&amp;biz_id=102&amp;utm_term=IndexError:%20boolean%20index%20did%20&amp;utm_medium=distribute.pc_search_result.none-task-blog-2~all~sobaiduweb~default-6-89954791.pc_search_result_hbase_insert&amp;spm=1018.2226.3001.4187</a></p><p>新版本的labelme生成的label.png图为8位彩色图，不需要16位转8位转换！！！直接使用即可！注意观察自己的label.png的位深度！</p><h1 id="BUG"><a href="#BUG" class="headerlink" title="BUG"></a>BUG</h1><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">---------------------------------------------------------------------------AssertionError                            Traceback <span class="token punctuation">(</span>most recent call last<span class="token punctuation">)</span><span class="token operator">&lt;</span>ipython-input-28-90029a2660a<span class="token operator"><span class="token file-descriptor important">7</span>&gt;</span> <span class="token keyword">in</span> <span class="token operator">&lt;</span>module<span class="token operator">&gt;</span><span class="token punctuation">(</span><span class="token punctuation">)</span>     <span class="token number">13</span>     <span class="token punctuation">(</span><span class="token string">"refined_anchors_clipped"</span>, model.ancestor<span class="token punctuation">(</span>pillar, <span class="token string">"ROI/refined_anchors_clipped:0"</span><span class="token punctuation">))</span>,     <span class="token number">14</span>     <span class="token punctuation">(</span><span class="token string">"post_nms_anchor_ix"</span>, nms_node<span class="token punctuation">)</span>,---<span class="token operator">&gt;</span> <span class="token number">15</span>     <span class="token punctuation">(</span><span class="token string">"proposals"</span>, model.keras_model.get_layer<span class="token punctuation">(</span><span class="token string">"ROI"</span><span class="token punctuation">)</span>.output<span class="token punctuation">)</span>,     <span class="token number">16</span> <span class="token punctuation">]</span><span class="token punctuation">)</span>/content/drive/My Drive/mask rcnn_test/mrcnn/model.py <span class="token keyword">in</span> run_graph<span class="token punctuation">(</span>self, images, outputs, image_metas<span class="token punctuation">)</span>   <span class="token number">2663</span>         outputs <span class="token operator">=</span> OrderedDict<span class="token punctuation">(</span>outputs<span class="token punctuation">)</span>   <span class="token number">2664</span>         <span class="token keyword">for</span> <span class="token for-or-select variable">o</span> <span class="token keyword">in</span> outputs.values<span class="token punctuation">(</span><span class="token punctuation">)</span>:-<span class="token operator">&gt;</span> <span class="token number">2665</span>             assert o is not None   <span class="token number">2666</span>    <span class="token number">2667</span>         <span class="token comment"># Build a Keras function to run parts of the computation graph</span>AssertionError: <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>暂未找到解决方法，或许：</p><ul><li>版本问题，使用的是1.13 1.15</li><li>是分割单类别，多类别是否会出现？</li></ul>]]></content>
      
      
      <categories>
          
          <category> Mask R-CNN </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 深度学习 </tag>
            
            <tag> tensorflow </tag>
            
            <tag> keras </tag>
            
            <tag> Mask R-CNN </tag>
            
            <tag> 实例分割 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>使用Mask-R-CNN训练自己的数据集</title>
      <link href="/2021/09/09/use-Mask-R-CNN-train-dataset-myself/"/>
      <url>/2021/09/09/use-Mask-R-CNN-train-dataset-myself/</url>
      
        <content type="html"><![CDATA[<h1 id="使用Mask-R-CNN训练自己的数据集"><a href="#使用Mask-R-CNN训练自己的数据集" class="headerlink" title="使用Mask-R-CNN训练自己的数据集"></a>使用Mask-R-CNN训练自己的数据集</h1><p>训练自己数据的步骤：</p><h2 id="安装Labelme"><a href="#安装Labelme" class="headerlink" title="安装Labelme"></a>安装Labelme</h2><pre class="line-numbers language-none"><code class="language-none">pip install labelme<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><pre class="line-numbers language-none"><code class="language-none">pip install pyqt5<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><pre class="line-numbers language-none"><code class="language-none">pip install pillow==4.0.0<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h2 id="标注数据"><a href="#标注数据" class="headerlink" title="标注数据"></a>标注数据</h2><ol><li><p>使用labelme得到json标注文件</p></li><li><p>使用命令labelme_json_to_dataset 1.json得到json文件夹</p></li><li><p>也可以用批处理脚本得到所有json文件夹</p></li><li><p>得到4个文件夹标注信息</p></li></ol><h2 id="代码中需要改动的地方："><a href="#代码中需要改动的地方：" class="headerlink" title="代码中需要改动的地方："></a>代码中需要改动的地方：</h2><ul><li><p>NUM_CLASSES：表示类别的个数</p></li><li><p>self.add_class(“shapes”, 1, “category1”) 添加标签中定义的类别</p></li><li><p>指定好路径</p></li></ul><pre class="line-numbers language-python" data-language="python"><code class="language-python">dataset_root_path<span class="token operator">=</span><span class="token string">"mydata/"</span>img_floder <span class="token operator">=</span> dataset_root_path <span class="token operator">+</span> <span class="token string">"pic"</span>mask_floder <span class="token operator">=</span> dataset_root_path <span class="token operator">+</span> <span class="token string">"cv2_mask"</span>imglist <span class="token operator">=</span> os<span class="token punctuation">.</span>listdir<span class="token punctuation">(</span>img_floder<span class="token punctuation">)</span>count <span class="token operator">=</span> <span class="token builtin">len</span><span class="token punctuation">(</span>imglist<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><ul><li>DETECTION_MIN_CONFIDENCE 指定的稍微小一点可以得到更多结果</li></ul><h2 id="训练之后测试结果"><a href="#训练之后测试结果" class="headerlink" title="训练之后测试结果"></a>训练之后测试结果</h2><ul><li><p>先得到.h5的模型文件</p></li><li><p>参考demo.ipynb文件来写测试脚本</p></li></ul><h1 id="Using-a-generator-with-use-multiprocessing-True-and-multiple-workers-may-duplicate-your-data-Plea"><a href="#Using-a-generator-with-use-multiprocessing-True-and-multiple-workers-may-duplicate-your-data-Plea" class="headerlink" title="Using a generator with use_multiprocessing=True and multiple workers may duplicate your data. Plea"></a>Using a generator with <code>use_multiprocessing=True</code> and multiple workers may duplicate your data. Plea</h1><p><a href="https://github.com/keras-team/keras/pull/8662">https://github.com/keras-team/keras/pull/8662</a></p><p><a href="https://github.com/matterport/Mask_RCNN/issues/514">https://github.com/matterport/Mask_RCNN/issues/514</a></p><p><a href="https://github.com/matterport/Mask_RCNN/pull/740">https://github.com/matterport/Mask_RCNN/pull/740</a></p><p><a href="https://blog.csdn.net/qq_35874169/article/details/116203228">https://blog.csdn.net/qq_35874169/article/details/116203228</a></p><p><a href="https://www.gitmemory.com/issue/reigngt09/mask-rcnn/2/623180746">https://www.gitmemory.com/issue/reigngt09/mask-rcnn/2/623180746</a></p><p>退出重新启动Google colab运行时即可解决问题。</p>]]></content>
      
      
      <categories>
          
          <category> Mask R-CNN </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 深度学习 </tag>
            
            <tag> tensorflow </tag>
            
            <tag> keras </tag>
            
            <tag> Mask R-CNN </tag>
            
            <tag> 实例分割 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>tensorflow.js部署到web 笔记</title>
      <link href="/2021/09/02/tensorflow.js-deploy-web/"/>
      <url>/2021/09/02/tensorflow.js-deploy-web/</url>
      
        <content type="html"><![CDATA[<h1 id="tensorflow-js部署到web-笔记"><a href="#tensorflow-js部署到web-笔记" class="headerlink" title="tensorflow.js部署到web 笔记"></a>tensorflow.js部署到web 笔记</h1><h2 id="BUG："><a href="#BUG：" class="headerlink" title="BUG："></a>BUG：</h2><ol><li><p>无法加载源映射</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">Could not <span class="token builtin class-name">read</span> <span class="token builtin class-name">source</span> map <span class="token keyword">for</span> https://cdn.jsdelivr.net/npm/@tensorflow/tfjs@latest: Unexpected <span class="token number">404</span> response from https://cdn.jsdelivr.net/npm/@tensorflow/tf.min.js.map: Failed to resolve the requested file.<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>解决：（<a href="https://www.nuomiphp.com/eplan/188052.html%EF%BC%89">https://www.nuomiphp.com/eplan/188052.html）</a></p><pre class="line-numbers language-none"><code class="language-none">换成"&lt;script src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs/dist/tf.min.js"&gt; &lt;/script&gt;"<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></li><li><p>加载模型报错 lambda，<strong>inception_resnet_v2报错</strong>，<strong>inceptionV3</strong>并不报错</p><pre class="line-numbers language-none"><code class="language-none">Uncaught (in promise) Error: Unknown layer: Lambda. This may be due to one of the following reasons:The layer is defined in Python, in which case it needs to be ported to TensorFlow.js or your JavaScript code.The custom layer is defined in JavaScript, but is not registered properly with tf.serialization.registerClass().at new t (errors.ts:48)at deserializeKerasObject (generic_utils.ts:202)at deserialize (serialization.ts:27)at i (container.ts:1329)at t.fromConfig (container.ts:1355)at deserializeKerasObject (generic_utils.ts:235)at deserialize (serialization.ts:27)at models.ts:270at index.ts:79at Object.next (index.ts:79)<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>参考：</p><p><a href="https://github.com/tensorspace-team/tensorspace/issues/121">https://github.com/tensorspace-team/tensorspace/issues/121</a></p><p><a href="https://stackoverflow.com/questions/66616597/tensorflow-js-error-in-loading-augmentation-layers-operation">https://stackoverflow.com/questions/66616597/tensorflow-js-error-in-loading-augmentation-layers-operation</a></p><p><a href="https://www.jianshu.com/p/dd2bebfa867d">https://www.jianshu.com/p/dd2bebfa867d</a></p><p><a href="https://zhuanlan.zhihu.com/p/86355195">https://zhuanlan.zhihu.com/p/86355195</a></p></li><li><p>bug2在替换掉lambda后出现，基础库</p><pre class="line-numbers language-none"><code class="language-none">Uncaught (in promise) TypeError: undefined is not iterable (cannot read property Symbol(Symbol.iterator))    at Fv (runtime.js:747)    at t.fromConfig (container.js:1232)    at eO (generic_utils.js:278)    at aM (serialization.js:31)    at u (container.js:1206)    at t.fromConfig (container.js:1234)    at eO (generic_utils.js:278)    at aM (serialization.js:31)    at models.js:295    at c (runtime.js:63)<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></li><li><p>tf.fromPixels</p><pre class="line-numbers language-none"><code class="language-none">Uncaught (in promise) TypeError: tf.fromPixels is not a function<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>已解决：<a href="https://stackoverflow.com/questions/55402551/why-am-i-getting-the-error-tf-frompixels-is-not-a-function">https://stackoverflow.com/questions/55402551/why-am-i-getting-the-error-tf-frompixels-is-not-a-function</a></p><p>tf.fromPixels was deprecated in version 1.0.0, use: <code>tf.browser.fromPixels()</code></p></li><li><p>getImageData</p><pre class="line-numbers language-none"><code class="language-none">'getImageData' on 'CanvasRenderingContext2D': Value is not of type 'long'.<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>我是这么写的：</p><pre class="line-numbers language-none"><code class="language-none">const imgData = context.getImageData(0,0,canvas.width,canvas.height);<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>已解决：换成<code>const imgData = context.getImageData(0,0,299,299);</code></p></li><li><p>tensorflow.js没有tf.argmax，变成了<strong>tf.argMax</strong></p></li></ol><h2 id="加载模型时路径的写法"><a href="#加载模型时路径的写法" class="headerlink" title="加载模型时路径的写法"></a>加载模型时路径的写法</h2><pre class="line-numbers language-none"><code class="language-none">const my_model = await tf.loadLayersModel("model_js/model.json")//正确<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><pre class="line-numbers language-none"><code class="language-none">  const my_model = await tf.loadLayersModel("http://127.0.0.1:5502/TensorFlow%20Deployment/Course%201%20-%20TensorFlow-JS/Week%204/Examples/model_js/model.json")//正确,前面一大串是工作区文件夹名称<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><h2 id="tensorflow-js的预测结果与tensorflow大相径庭"><a href="#tensorflow-js的预测结果与tensorflow大相径庭" class="headerlink" title="tensorflow.js的预测结果与tensorflow大相径庭"></a>tensorflow.js的预测结果与tensorflow大相径庭</h2><p>图片：hym_003(-)_180.jpg</p><h3 id="tensorflow-js"><a href="#tensorflow-js" class="headerlink" title="tensorflow.js"></a>tensorflow.js</h3><pre class="line-numbers language-none"><code class="language-none">[[0.0038602, 0.0000056, 0.136271, 0.0231699, 4e-7, 5e-7, 1e-7, 0.0000079, 4e-7, 0.836684],]<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h3 id="tensorflow-python"><a href="#tensorflow-python" class="headerlink" title="tensorflow-python"></a>tensorflow-python</h3><pre class="line-numbers language-none"><code class="language-none">array([[6.1449555e-08, 7.2196451e-07, 9.9997318e-01, 2.7251541e-08,        4.4864832e-09, 2.8673458e-07, 1.8537765e-05, 2.0686712e-06,        9.0471025e-10, 5.0913218e-06]], dtype=float32)<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p><a href="https://github.com/tensorflow/tfjs/issues/776">https://github.com/tensorflow/tfjs/issues/776</a></p><p>后续更新部署。</p>]]></content>
      
      
      <categories>
          
          <category> tensorflow </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 深度学习 </tag>
            
            <tag> tensorflow </tag>
            
            <tag> tensorflow.js </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>基于InceptionV3深度学习实现岩石图像智能识别与分类</title>
      <link href="/2021/09/01/by-InceptionV3-transfer-learning/"/>
      <url>/2021/09/01/by-InceptionV3-transfer-learning/</url>
      
        <content type="html"><![CDATA[<h1 id="基于InceptionV3深度学习实现岩石图像智能识别与分类"><a href="#基于InceptionV3深度学习实现岩石图像智能识别与分类" class="headerlink" title="基于InceptionV3深度学习实现岩石图像智能识别与分类"></a>基于InceptionV3深度学习实现岩石图像智能识别与分类</h1><h2 id="总体流程"><a href="#总体流程" class="headerlink" title="总体流程"></a>总体流程</h2><ul><li>整理数据集（训练集、验证集），按照目录格式分类</li><li>读取数据集图像，归一化处理和数据增强</li><li>加载预训练模型<code>InceptionV3</code>，作为基础模型</li><li>在Inception卷积神经网络的瓶颈层后设计适用于本项目的网络结构，成为my_mode</li><li>冻结预训练模型的所有层，变为不可训练，便于正确获得瓶颈层输出的特征，自己添加的层需要训练。相当于把InceptionV3变为一个特征提取器</li><li>编译、训练、保存</li><li><strong>预测</strong>：读取需识别的图像，转换数据格式，预测输出</li></ul><h2 id="数据预处理"><a href="#数据预处理" class="headerlink" title="数据预处理"></a>数据预处理</h2><p>使用一个<code>ImageDataGenerator</code>图片生成器，定义图片处理以及数据增强相关</p><ul><li><code>ImageDataGenerator</code>，这个API提供数据处理相关功能，以及<strong>数据增强功能</strong>，使得数据多样化</li></ul><pre class="line-numbers language-python" data-language="python"><code class="language-python">datagen <span class="token operator">=</span> ImageDataGenerator<span class="token punctuation">(</span>rescale<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">.</span> <span class="token operator">/</span> <span class="token number">255</span><span class="token punctuation">,</span>  <span class="token comment"># 归一化</span>                                         zoom_range<span class="token operator">=</span><span class="token number">0.2</span><span class="token punctuation">,</span>                                          rotation_range<span class="token operator">=</span><span class="token number">40</span><span class="token punctuation">.</span><span class="token punctuation">,</span>                                         channel_shift_range<span class="token operator">=</span><span class="token number">25</span><span class="token punctuation">.</span><span class="token punctuation">,</span>                                         width_shift_range<span class="token operator">=</span><span class="token number">0.2</span><span class="token punctuation">,</span>                                         height_shift_range<span class="token operator">=</span><span class="token number">0.2</span><span class="token punctuation">,</span>                                         horizontal_flip<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span>                                         fill_mode<span class="token operator">=</span><span class="token string">'nearest'</span><span class="token punctuation">)</span>                                           <span class="token comment"># fill_mode：‘constant’，‘nearest’，‘reflect’或‘wrap’之一，</span>                                         <span class="token comment"># 当进行变换时超出边界的点将根据本参数给定的方法进行处理</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><ul><li><p>参数（参考：<a href="http://www.51zixue.net/Keras/853.html%EF%BC%89">http://www.51zixue.net/Keras/853.html）</a></p><ul><li><strong>featurewise_cente</strong>r：布尔值，使输入数据集去中心化（均值为0）, 按feature执行</li><li><strong>samplewise_center</strong>：布尔值，使输入数据的每个样本均值为0</li><li><strong>featurewise_std_normalization</strong>：布尔值，将输入除以数据集的标准差以完成标准化, 按feature执行</li><li><strong>samplewise_std_normalization</strong>：布尔值，将输入的每个样本除以其自身的标准差</li><li><strong>zca_whitening</strong>：布尔值，对输入数据施加ZCA白</li><li><strong>zca_epsilon</strong>: ZCA使用的eposilon，默认1e-6</li><li><strong>rotation_range</strong>：整数，数据提升时图片随机转动的角度</li><li><strong>width_shift_range</strong>：浮点数，图片宽度的某个比例，数据提升时图片水平偏移的幅度</li><li><strong>height_shift_range</strong>：浮点数，图片高度的某个比例，数据提升时图片竖直偏移的幅度</li><li><strong>shear_range</strong>：浮点数，剪切强度（逆时针方向的剪切变换角度）</li><li><strong>zoom_range</strong>：浮点数或形如[lower,upper]的列表，随机缩放的幅度，若为浮点数，则相当于[lower,upper] = [1 - zoom_range, 1+zoom_range]</li><li><strong>channel_shift_range</strong>：浮点数，随机通道偏移的幅度</li><li><strong>fill_mode</strong>：；‘constant’，‘nearest’，‘reflect’或‘wrap’之一，当进行变换时超出边界的点将根据本参数给定的方法进行处理</li><li><strong>cval</strong>：浮点数或整数，当fill_mode=constant时，指定要向超出边界的点填充的值</li><li><strong>horizontal_flip</strong>：布尔值，进行随机水平翻转</li><li><strong>vertical_flip</strong>：布尔值，进行随机竖直翻转</li><li><strong>rescale</strong>: 重放缩因子,默认为None. 如果为None或0则不进行放缩,否则会将该数值乘到数据上(在应用其他变换之前)</li></ul></li><li><p><code>ImageDataGenerator.flow_from_directory()</code> ，实现了自动给固定格式目录下的数据集打标签，分批无序读取，返回张量类型数据集。</p><ul><li>这个API要求有严格的目录格式，如下：</li></ul></li></ul><pre class="line-numbers language-python" data-language="python"><code class="language-python">data<span class="token operator">/</span>    train<span class="token operator">/</span>        dogs<span class="token operator">/</span>            dog001<span class="token punctuation">.</span>jpg            dog002<span class="token punctuation">.</span>jpg            <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>        cats<span class="token operator">/</span>            cat001<span class="token punctuation">.</span>jpg            cat002<span class="token punctuation">.</span>jpg            <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>    validation<span class="token operator">/</span>        dogs<span class="token operator">/</span>            dog001<span class="token punctuation">.</span>jpg            dog002<span class="token punctuation">.</span>jpg            <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>        cats<span class="token operator">/</span>            cat001<span class="token punctuation">.</span>jpg            cat002<span class="token punctuation">.</span>jpg            <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python">generator <span class="token operator">=</span> datagen<span class="token punctuation">.</span>flow_from_directory<span class="token punctuation">(</span>                                                dir_path<span class="token punctuation">,</span>  <span class="token comment"># 数据存放路径</span>                                                target_size<span class="token operator">=</span><span class="token punctuation">(</span>img_row<span class="token punctuation">,</span> img_col<span class="token punctuation">)</span><span class="token punctuation">,</span>  <span class="token comment"># 目标形状</span>                                                batch_size<span class="token operator">=</span>batch_size<span class="token punctuation">,</span>  <span class="token comment"># 批数量大小</span>                                                class_mode<span class="token operator">=</span><span class="token string">'categorical'</span><span class="token punctuation">,</span>  <span class="token comment"># 二分类使用binary</span>                                                <span class="token comment"># "categorical" ：2D one-hot encoded labels</span>                                                <span class="token comment"># "binary" will be 1D binary labels</span>                                                shuffle<span class="token operator">=</span>is_train  <span class="token comment"># 是否打乱</span>                                            <span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><ul><li><p>参数：(参考：<a href="https://blog.csdn.net/mieleizhi0522/article/details/82191331">https://blog.csdn.net/mieleizhi0522/article/details/82191331</a>)</p><p><strong>directory</strong>: 目标文件夹路径,对于每一个类,该文件夹都要包含一个子文件夹.子文件夹中任何JPG、PNG、BNP、PPM的图片都会被生成器使用.详情请查看此脚本<br><strong>target_size</strong>: 整数tuple,默认为(256, 256). 图像将被resize成该尺寸<br><strong>color_mode</strong>: 颜色模式,为”grayscale”,”rgb”之一,默认为”rgb”.代表这些图片是否会被转换为单通道或三通道的图片.<br><strong>classes</strong>: 可选参数,为子文件夹的列表,如[‘dogs’,’cats’]默认为None. 若未提供,则该类别列表将从directory下的子文件夹名称/结构自动推断。每一个子文件夹都会被认为是一个新的类。(类别的顺序将按照字母表顺序映射到标签值)。通过属性class_indices可获得文件夹名与类的序号的对应字典。<br><strong>class_mode</strong>: “categorical”, “binary”, “sparse”或None之一. 默认为”categorical. 该参数决定了返回的标签数组的形式, “categorical”会返回2D的one-hot编码标签,”binary”返回1D的二值标签.”sparse”返回1D的整数标签,如果为None则不返回任何标签, 生成器将仅仅生成batch数据, 这种情况在使用model.predict_generator()和model.evaluate_generator()等函数时会用到.<br><strong>batch_size</strong>: batch数据的大小,默认32<br><strong>shuffle</strong>: 是否打乱数据,默认为True<br><strong>seed</strong>: 可选参数,打乱数据和进行变换时的随机数种子<br><strong>save_to_dir</strong>: None或字符串，该参数能让你将提升后的图片保存起来，用以可视化<br><strong>save_prefix</strong>：字符串，保存提升后图片时使用的前缀, 仅当设置了save_to_dir时生效<br><strong>save_format</strong>：”png”或”jpeg”之一，指定保存图片的数据格式,默认”jpeg”<br>flollow_links: 是否访问子文件夹中的软链接</p></li></ul><h2 id="构建InceptionV3模型"><a href="#构建InceptionV3模型" class="headerlink" title="构建InceptionV3模型"></a>构建InceptionV3模型</h2><p><img src="https://cdn.jsdelivr.net/gh/JlexZhong/J.CS-note@main/%E5%9F%BA%E4%BA%8EInceptionV3%E8%BF%81%E7%A7%BB%E5%AD%A6%E4%B9%A0%E5%AE%9E%E7%8E%B0%E5%B2%A9%E7%9F%B3%E5%9B%BE%E5%83%8F%E6%99%BA%E8%83%BD%E8%AF%86%E5%88%AB.assets/inceptionV3%E7%BD%91%E7%BB%9C%E7%BB%93%E6%9E%84%E5%9B%BE.png"></p><p>Bottleneck feature即为瓶颈层输出的特征，后面的层被丢弃。我们在瓶颈层后添加全连接层进行分类，输出变为符合概率分布的概率。添加的层结构如下。</p><p><img src="https://cdn.jsdelivr.net/gh/JlexZhong/J.CS-note@main/%E5%9F%BA%E4%BA%8EInceptionV3%E8%BF%81%E7%A7%BB%E5%AD%A6%E4%B9%A0%E5%AE%9E%E7%8E%B0%E5%B2%A9%E7%9F%B3%E5%9B%BE%E5%83%8F%E6%99%BA%E8%83%BD%E8%AF%86%E5%88%AB.assets/%E8%87%AA%E5%BB%BA%E5%B1%82.png"></p><p>设置整体卷积神经网络的输入为（150，150，3）矩阵。</p><p>自建层输入的是3 * 3 * 2048 的张量，因为我们是分类5类图像，所以最后一层用5个神经元，使用softmax激活函数，输出五种类别各自的概率值。</p><p><strong>Flatten</strong>：Flatten层用来将输入“压平”，即把多维的输入一维化，常用在从卷积层到全连接层的过渡。Flatten不影响batch的大小。</p><p><strong>Dropout</strong>：做分类的时候，Dropout 层一般加在全连接层 防止过拟合，提升模型泛化能力。而很少见到卷积层后接Dropout（原因主要是 卷积参数少，不易过拟合）</p><p>冻结源模型的所有层，<strong>针对数据集大小有三种不同方案：</strong></p><ul><li>数据集少的就冻住所有的特征提取层</li><li>数据集中的可以冻住开始一部分的特征提取层</li><li>数据集多的可以自行训练参数</li></ul><p><strong>可视化神经网络结构</strong>：</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> tensorflow<span class="token punctuation">.</span>keras<span class="token punctuation">.</span>utils <span class="token keyword">import</span> plot_modelplot_model<span class="token punctuation">(</span>model<span class="token punctuation">,</span> to_file<span class="token operator">=</span><span class="token string">'inceptionV3_model.png'</span><span class="token punctuation">,</span>                       show_shapes<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">def</span> <span class="token function">InceptionV3_model</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> lr<span class="token operator">=</span><span class="token number">0.005</span><span class="token punctuation">,</span> decay<span class="token operator">=</span><span class="token number">1e</span><span class="token operator">-</span><span class="token number">6</span><span class="token punctuation">,</span> momentum<span class="token operator">=</span><span class="token number">0.9</span><span class="token punctuation">,</span> nb_classes<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">,</span>                             img_rows<span class="token operator">=</span><span class="token number">197</span><span class="token punctuation">,</span> img_cols<span class="token operator">=</span><span class="token number">197</span><span class="token punctuation">,</span> RGB<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span> is_plot_model<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token triple-quoted-string string">"""InceptionV3模型，建立自己的模型        Args:            lr (float, optional): 学习率. Defaults to 0.005.            decay ([type], optional): 学习衰减率. Defaults to 1e-6.            momentum (float, optional): Defaults to 0.9.            nb_classes (int, optional): 分类数. Defaults to 2.            img_rows (int, optional): 图片行数. Defaults to 197.            img_cols (int, optional): 图片列数. Defaults to 197.            RGB (bool, optional): 是否为3通道图片. Defaults to True.            is_plot_model (bool, optional): 是否画出模型网络结构图. Defaults to False.        Returns:            [type]: 返回模型        """</span>        color <span class="token operator">=</span> <span class="token number">3</span> <span class="token keyword">if</span> RGB <span class="token keyword">else</span> <span class="token number">1</span>        <span class="token comment"># 假设最后一层CNN的层输出为(img_rows, img_cols, color</span>        base_model <span class="token operator">=</span> InceptionV3<span class="token punctuation">(</span>weights<span class="token operator">=</span><span class="token string">'imagenet'</span><span class="token punctuation">,</span>                                 include_top<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">,</span>                                 input_shape<span class="token operator">=</span><span class="token punctuation">(</span>img_rows<span class="token punctuation">,</span> img_cols<span class="token punctuation">,</span> color<span class="token punctuation">)</span><span class="token punctuation">,</span>                                 <span class="token punctuation">)</span>        <span class="token comment"># 对我们的输出进行平铺操作,為全連接层做准备</span>        x <span class="token operator">=</span> layers<span class="token punctuation">.</span>Flatten<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">(</span>base_model<span class="token punctuation">.</span>output<span class="token punctuation">)</span>        <span class="token comment"># 增加一个全连接层，并使用relu作为激活函数，这是需要训练的</span>        x <span class="token operator">=</span> layers<span class="token punctuation">.</span>Dense<span class="token punctuation">(</span><span class="token number">1024</span><span class="token punctuation">,</span> activation<span class="token operator">=</span><span class="token string">'relu'</span><span class="token punctuation">)</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span>        <span class="token comment"># 添加随机失活，抑制过拟合</span>        x <span class="token operator">=</span> layers<span class="token punctuation">.</span>Dropout<span class="token punctuation">(</span><span class="token number">0.2</span><span class="token punctuation">)</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span>        <span class="token comment"># ，输出层，把输出设置成softmax函数</span>        predictions <span class="token operator">=</span> layers<span class="token punctuation">.</span>Dense<span class="token punctuation">(</span>nb_classes<span class="token punctuation">,</span> activation<span class="token operator">=</span><span class="token string">'softmax'</span><span class="token punctuation">)</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span>        <span class="token comment"># 训练模型</span>        model <span class="token operator">=</span> Model<span class="token punctuation">(</span>inputs<span class="token operator">=</span>base_model<span class="token punctuation">.</span><span class="token builtin">input</span><span class="token punctuation">,</span> outputs<span class="token operator">=</span>predictions<span class="token punctuation">)</span>        <span class="token comment"># 冻结base_model所有层，这样就可以正确获得bottleneck特征</span>        <span class="token keyword">for</span> layer <span class="token keyword">in</span> base_model<span class="token punctuation">.</span>layers<span class="token punctuation">:</span>            layer<span class="token punctuation">.</span>trainable <span class="token operator">=</span> <span class="token boolean">False</span>        sgd <span class="token operator">=</span> SGD<span class="token punctuation">(</span>lr<span class="token operator">=</span>lr<span class="token punctuation">,</span> decay<span class="token operator">=</span>decay<span class="token punctuation">,</span> momentum<span class="token operator">=</span>momentum<span class="token punctuation">,</span> nesterov<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>        model<span class="token punctuation">.</span><span class="token builtin">compile</span><span class="token punctuation">(</span>loss<span class="token operator">=</span><span class="token string">'categorical_crossentropy'</span><span class="token punctuation">,</span>                      optimizer<span class="token operator">=</span>sgd<span class="token punctuation">,</span> metrics<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'acc'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>        model<span class="token punctuation">.</span>summary<span class="token punctuation">(</span><span class="token punctuation">)</span>        <span class="token comment"># 可视化网络结构，生成图片</span>        <span class="token keyword">if</span> is_plot_model<span class="token punctuation">:</span>            plot_model<span class="token punctuation">(</span>model<span class="token punctuation">,</span> to_file<span class="token operator">=</span><span class="token string">'inceptionV3_model.png'</span><span class="token punctuation">,</span>                       show_shapes<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>        <span class="token keyword">return</span> model<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="训练、保存模型"><a href="#训练、保存模型" class="headerlink" title="训练、保存模型"></a>训练、保存模型</h2><p><strong>训练</strong>：用fit_generator函数，它可以避免了一次性加载大量的数据，并且生成器与模型将并行执行以提高效率。比如可以在CPU上进行实时的数据提升，同时在GPU上进行模型训练</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">def</span> <span class="token function">train_model</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> model<span class="token punctuation">,</span> epochs<span class="token punctuation">,</span> train_generator<span class="token punctuation">,</span> steps_per_epoch<span class="token punctuation">,</span>                     validation_generator<span class="token punctuation">,</span> validation_steps<span class="token punctuation">,</span>path_save_model<span class="token punctuation">,</span> is_load_model<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token triple-quoted-string string">"""训练模型，载入、保存、断点续训        Args:            model ([type]): 模型            epochs ([type]): 训练次数            train_generator ([type]): 训练集            steps_per_epoch ([type]):             validation_generator ([type]): 验证集            validation_steps ([type]):             path_save_model ([type]): 保存模型路径            is_load_model (bool, optional): 是否载入模型. Defaults to False.        Returns:            [type]: 训练记录        """</span>        <span class="token comment"># 载入模型</span>        <span class="token keyword">if</span> is_load_model <span class="token keyword">and</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>exists<span class="token punctuation">(</span>path_save_model<span class="token punctuation">)</span><span class="token punctuation">:</span>            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'================载入已训练模型==============='</span><span class="token punctuation">)</span>            model <span class="token operator">=</span> load_model<span class="token punctuation">(</span>path_save_model<span class="token punctuation">)</span>        <span class="token comment"># 使用tensorboard</span>        log_dir <span class="token operator">=</span> <span class="token string">"logs/fit/"</span> <span class="token operator">+</span> datetime<span class="token punctuation">.</span>datetime<span class="token punctuation">.</span>now<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>strftime<span class="token punctuation">(</span><span class="token string">"%Y%m%d-%H%M%S"</span><span class="token punctuation">)</span>        tensorboard_callback <span class="token operator">=</span> tf<span class="token punctuation">.</span>keras<span class="token punctuation">.</span>callbacks<span class="token punctuation">.</span>TensorBoard<span class="token punctuation">(</span>            log_dir<span class="token operator">=</span>log_dir<span class="token punctuation">,</span> histogram_freq<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span>        <span class="token comment"># 断点续训</span>        <span class="token comment"># 格式化字符，防止文件名冲突</span>        checkpoint_path <span class="token operator">=</span> <span class="token string">'ckpt/transfer_{epoch:02d}-{val_acc:.2f}.h5'</span>        checkpoint_callback <span class="token operator">=</span> tf<span class="token punctuation">.</span>keras<span class="token punctuation">.</span>callbacks<span class="token punctuation">.</span>ModelCheckpoint<span class="token punctuation">(</span>            checkpoint_path<span class="token punctuation">,</span>  <span class="token comment"># 保存路径，指定为tensorflow二进制文件ckpt</span>            monitor<span class="token operator">=</span><span class="token string">'val_acc'</span><span class="token punctuation">,</span>  <span class="token comment"># 监测指标，这里是测试集的acc</span>                                save_best_only<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">,</span>  <span class="token comment"># 是否只保存最佳</span>            save_weights_only<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span>  <span class="token comment"># 只保存权重</span>            mode<span class="token operator">=</span><span class="token string">'max'</span><span class="token punctuation">,</span>            period<span class="token operator">=</span><span class="token number">1</span>  <span class="token comment"># 每period个周期保存一次</span>        <span class="token punctuation">)</span>        <span class="token comment"># 训练</span>        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'================开始训练================'</span><span class="token punctuation">)</span>        history_ft <span class="token operator">=</span> model<span class="token punctuation">.</span>fit_generator<span class="token punctuation">(</span>            train_generator<span class="token punctuation">,</span>            steps_per_epoch<span class="token operator">=</span>steps_per_epoch<span class="token punctuation">,</span>            epochs<span class="token operator">=</span>epochs<span class="token punctuation">,</span>            validation_data<span class="token operator">=</span>validation_generator<span class="token punctuation">,</span>            validation_steps<span class="token operator">=</span>validation_steps<span class="token punctuation">,</span>            verbose<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span>  <span class="token comment"># 日志显示，0/1,1表示输出进度条日志信息</span>            callbacks<span class="token operator">=</span><span class="token punctuation">[</span>tensorboard_callback<span class="token punctuation">,</span> checkpoint_callback<span class="token punctuation">]</span><span class="token punctuation">)</span>        <span class="token comment"># 模型保存</span>        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'================保存模型================'</span><span class="token punctuation">)</span>        model<span class="token punctuation">.</span>save<span class="token punctuation">(</span>path_save_model<span class="token punctuation">,</span> overwrite<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>        <span class="token keyword">return</span> history_ft<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><strong>断点续训</strong>：在模型训练时保存检查点，防止因意外情况丢失训练进度。</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># 断点续训</span>        <span class="token comment"># 格式化字符，防止文件名冲突</span>        checkpoint_path <span class="token operator">=</span> <span class="token string">'ckpt/transfer_{epoch:02d}-{val_acc:.2f}.h5'</span>        checkpoint_callback <span class="token operator">=</span> tf<span class="token punctuation">.</span>keras<span class="token punctuation">.</span>callbacks<span class="token punctuation">.</span>ModelCheckpoint<span class="token punctuation">(</span>            checkpoint_path<span class="token punctuation">,</span>  <span class="token comment"># 保存路径，指定为tensorflow二进制文件ckpt</span>            monitor<span class="token operator">=</span><span class="token string">'val_acc'</span><span class="token punctuation">,</span>  <span class="token comment"># 监测指标，这里是测试集的acc</span>                                save_best_only<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">,</span>  <span class="token comment"># 是否只保存最佳</span>            save_weights_only<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span>  <span class="token comment"># 只保存权重</span>            mode<span class="token operator">=</span><span class="token string">'max'</span><span class="token punctuation">,</span>            period<span class="token operator">=</span><span class="token number">1</span>  <span class="token comment"># 每period个周期保存一次</span>        <span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><strong>保存、载入模型</strong>的详细用法，请参考我的另一篇博客：<a href="https://blog.csdn.net/jun_zhong866810/article/details/119708120?spm=1001.2014.3001.5501">https://blog.csdn.net/jun_zhong866810/article/details/119708120?spm=1001.2014.3001.5501</a></p><h2 id="可视化acc-loss图"><a href="#可视化acc-loss图" class="headerlink" title="可视化acc/loss图"></a>可视化acc/loss图</h2><pre class="line-numbers language-none"><code class="language-none">def plot_training(self, history):        """可视化acc/loss图        Args:            history ([type]): 训练        """        print('================绘制acc/loss图================')        acc = history.history['acc']        val_acc = history.history['val_acc']        loss = history.history['loss']        val_loss = history.history['val_loss']        epochs = range(len(acc))        plt.plot(epochs, acc, 'b-')        plt.plot(epochs, val_acc, 'r')        plt.title('Training and validation accuracy')        plt.figure()        plt.plot(epochs, loss, 'b-')        plt.plot(epochs, val_loss, 'r-')        plt.title('Training and validation loss')        plt.show()<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="预测"><a href="#预测" class="headerlink" title="预测"></a>预测</h2><ul><li>载入我们训练好的模型（读取全部模型或者读取权重）</li><li>输入待识别岩石图像，图像格式标准化</li><li>预测并输出对于的岩石标签</li></ul><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># 建立标签字典，便于输出结果</span>label_dict <span class="token operator">=</span> <span class="token punctuation">{</span>    <span class="token string">'0'</span><span class="token punctuation">:</span> <span class="token string">'安山岩'</span><span class="token punctuation">,</span>    <span class="token string">'1'</span><span class="token punctuation">:</span> <span class="token string">'石灰岩'</span><span class="token punctuation">,</span>    <span class="token string">'2'</span><span class="token punctuation">:</span> <span class="token string">'石英岩'</span><span class="token punctuation">,</span>    <span class="token string">'3'</span><span class="token punctuation">:</span> <span class="token string">'砾岩'</span><span class="token punctuation">,</span>    <span class="token string">'4'</span><span class="token punctuation">:</span> <span class="token string">'花岗岩'</span><span class="token punctuation">}</span><span class="token keyword">def</span> <span class="token function">loadModel</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token triple-quoted-string string">"""读取全部模型数据"""</span>    model <span class="token operator">=</span> tf<span class="token punctuation">.</span>keras<span class="token punctuation">.</span>models<span class="token punctuation">.</span>load_model<span class="token punctuation">(</span><span class="token string">'model/my_saved_InceptionV3_model.h5'</span><span class="token punctuation">)</span>    <span class="token keyword">return</span> model<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>    model <span class="token operator">=</span> loadModel<span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span>model<span class="token punctuation">.</span>summary<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token keyword">for</span> img_name <span class="token keyword">in</span> os<span class="token punctuation">.</span>listdir<span class="token punctuation">(</span>path<span class="token punctuation">)</span><span class="token punctuation">:</span>        img_path <span class="token operator">=</span> path<span class="token operator">+</span>img_name        img <span class="token operator">=</span> image<span class="token punctuation">.</span>load_img<span class="token punctuation">(</span>img_path<span class="token punctuation">,</span> target_size<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">150</span><span class="token punctuation">,</span> <span class="token number">150</span><span class="token punctuation">)</span><span class="token punctuation">)</span>        <span class="token comment"># 保持输入格式一致</span>        x <span class="token operator">=</span> image<span class="token punctuation">.</span>img_to_array<span class="token punctuation">(</span>img<span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">255</span>        <span class="token comment"># 变为四维数据</span>        x <span class="token operator">=</span> np<span class="token punctuation">.</span>expand_dims<span class="token punctuation">(</span>x<span class="token punctuation">,</span> axis<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">)</span>        <span class="token comment"># 预测</span>        result <span class="token operator">=</span> model<span class="token punctuation">.</span>predict<span class="token punctuation">(</span>x<span class="token punctuation">)</span>        <span class="token comment"># 返回最大概率值的索引，类型是张量</span>        index <span class="token operator">=</span> tf<span class="token punctuation">.</span>argmax<span class="token punctuation">(</span>result<span class="token punctuation">,</span> axis<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span>        <span class="token keyword">print</span><span class="token punctuation">(</span>img_name<span class="token punctuation">,</span> <span class="token string">'======================&gt;'</span><span class="token punctuation">,</span> label_dict<span class="token punctuation">[</span><span class="token builtin">str</span><span class="token punctuation">(</span><span class="token builtin">int</span><span class="token punctuation">(</span>index<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span>        <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><img src="https://cdn.jsdelivr.net/gh/JlexZhong/J.CS-note@main/%E5%9F%BA%E4%BA%8EInceptionV3%E8%BF%81%E7%A7%BB%E5%AD%A6%E4%B9%A0%E5%AE%9E%E7%8E%B0%E5%B2%A9%E7%9F%B3%E5%9B%BE%E5%83%8F%E6%99%BA%E8%83%BD%E8%AF%86%E5%88%AB.assets/%E9%A2%84%E6%B5%8B%E7%BB%93%E6%9E%9C.png"></p><p>原始图像：</p><p><img src="https://cdn.jsdelivr.net/gh/JlexZhong/J.CS-note@main/%E5%9F%BA%E4%BA%8EInceptionV3%E8%BF%81%E7%A7%BB%E5%AD%A6%E4%B9%A0%E5%AE%9E%E7%8E%B0%E5%B2%A9%E7%9F%B3%E5%9B%BE%E5%83%8F%E6%99%BA%E8%83%BD%E8%AF%86%E5%88%AB.assets/%E9%A2%84%E6%B5%8B%E5%9B%BE%E5%83%8F%E9%9B%86.png"></p><h2 id="源代码与数据集"><a href="#源代码与数据集" class="headerlink" title="源代码与数据集"></a>源代码与数据集</h2><p><strong>数据集</strong>：</p><p>链接：<a href="https://pan.baidu.com/s/15ZfB79YGxdMZwT4I3OPRiQ">https://pan.baidu.com/s/15ZfB79YGxdMZwT4I3OPRiQ</a><br>提取码：zjsg</p><p><strong>train.py</strong></p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># -*- coding: utf-8 -*-</span><span class="token comment"># @Time    :  2021/08/15</span><span class="token comment"># @Author  : Z.J</span><span class="token comment"># @File    : train.py</span><span class="token comment"># @Software: vs code</span><span class="token comment"># -*- coding: utf-8 -*-</span><span class="token keyword">import</span> os<span class="token keyword">import</span> datetime<span class="token keyword">import</span> tensorflow <span class="token keyword">as</span> tf<span class="token keyword">import</span> matplotlib<span class="token punctuation">.</span>pyplot <span class="token keyword">as</span> plt<span class="token keyword">from</span> tensorflow<span class="token punctuation">.</span>keras <span class="token keyword">import</span> layers<span class="token keyword">from</span> tensorflow<span class="token punctuation">.</span>keras<span class="token punctuation">.</span>utils <span class="token keyword">import</span> plot_model<span class="token keyword">from</span> tensorflow<span class="token punctuation">.</span>keras<span class="token punctuation">.</span>applications<span class="token punctuation">.</span>inception_v3 <span class="token keyword">import</span> InceptionV3<span class="token keyword">from</span> tensorflow<span class="token punctuation">.</span>keras<span class="token punctuation">.</span>models <span class="token keyword">import</span> Model<span class="token punctuation">,</span> load_model<span class="token keyword">from</span> tensorflow<span class="token punctuation">.</span>keras<span class="token punctuation">.</span>optimizers <span class="token keyword">import</span> SGD<span class="token keyword">from</span> tensorflow<span class="token punctuation">.</span>keras<span class="token punctuation">.</span>preprocessing<span class="token punctuation">.</span>image <span class="token keyword">import</span> ImageDataGenerator<span class="token keyword">from</span> tensorflow<span class="token punctuation">.</span>keras<span class="token punctuation">.</span>regularizers <span class="token keyword">import</span> l2<span class="token keyword">class</span> <span class="token class-name">PowerTransferMode</span><span class="token punctuation">:</span>    <span class="token triple-quoted-string string">"""迁移学习类    """</span>    <span class="token keyword">def</span> <span class="token function">DataGen</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> dir_path<span class="token punctuation">,</span> img_row<span class="token punctuation">,</span> img_col<span class="token punctuation">,</span> batch_size<span class="token punctuation">,</span> is_train<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token triple-quoted-string string">"""读取数据集，并进行数据增强和打标签        Args:            dir_path (str)): 数据集路径            img_row (int): 行数            img_col (int): 行数            batch_size (int): 批数量            is_train (bool): 是否为训练集        Returns:            [type]: 数据集        """</span>        <span class="token keyword">if</span> is_train<span class="token punctuation">:</span>            <span class="token comment"># ImageDataGenerator :生产图片的批次张量值并且提供数据增强功能</span>            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'==================读取训练数据================'</span><span class="token punctuation">)</span>            datagen <span class="token operator">=</span> ImageDataGenerator<span class="token punctuation">(</span>rescale<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">.</span> <span class="token operator">/</span> <span class="token number">255</span><span class="token punctuation">,</span>                                         zoom_range<span class="token operator">=</span><span class="token number">0.2</span><span class="token punctuation">,</span>                                         rotation_range<span class="token operator">=</span><span class="token number">40</span><span class="token punctuation">.</span><span class="token punctuation">,</span>                                         channel_shift_range<span class="token operator">=</span><span class="token number">25</span><span class="token punctuation">.</span><span class="token punctuation">,</span>                                         width_shift_range<span class="token operator">=</span><span class="token number">0.2</span><span class="token punctuation">,</span>                                         height_shift_range<span class="token operator">=</span><span class="token number">0.2</span><span class="token punctuation">,</span>                                         horizontal_flip<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span>                                         fill_mode<span class="token operator">=</span><span class="token string">'nearest'</span><span class="token punctuation">)</span>  <span class="token comment"># fill_mode：‘constant’，‘nearest’，‘reflect’或‘wrap’之一，</span>                                                                <span class="token comment"># 当进行变换时超出边界的点将根据本参数给定的方法进行处理</span>        <span class="token keyword">else</span><span class="token punctuation">:</span>            <span class="token comment"># 验证集不需要数据增强</span>            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'==================读取验证数据================'</span><span class="token punctuation">)</span>            datagen <span class="token operator">=</span> ImageDataGenerator<span class="token punctuation">(</span>rescale<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">.</span> <span class="token operator">/</span> <span class="token number">255</span><span class="token punctuation">)</span>        generator <span class="token operator">=</span> datagen<span class="token punctuation">.</span>flow_from_directory<span class="token punctuation">(</span>                                                dir_path<span class="token punctuation">,</span>  <span class="token comment"># 数据存放路径</span>                                                target_size<span class="token operator">=</span><span class="token punctuation">(</span>img_row<span class="token punctuation">,</span> img_col<span class="token punctuation">)</span><span class="token punctuation">,</span>  <span class="token comment"># 目标形状</span>                                                batch_size<span class="token operator">=</span>batch_size<span class="token punctuation">,</span>  <span class="token comment"># 批数量大小</span>                                                class_mode<span class="token operator">=</span><span class="token string">'categorical'</span><span class="token punctuation">,</span>  <span class="token comment"># 二分类使用binary</span>                                                <span class="token comment"># "categorical" ：2D one-hot encoded labels</span>                                                <span class="token comment"># "binary" will be 1D binary labels</span>                                                shuffle<span class="token operator">=</span>is_train  <span class="token comment"># 是否打乱</span>                                            <span class="token punctuation">)</span>        <span class="token keyword">return</span> generator    <span class="token comment"># InceptionV3模型</span>    <span class="token keyword">def</span> <span class="token function">InceptionV3_model</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> lr<span class="token operator">=</span><span class="token number">0.005</span><span class="token punctuation">,</span> decay<span class="token operator">=</span><span class="token number">1e</span><span class="token operator">-</span><span class="token number">6</span><span class="token punctuation">,</span> momentum<span class="token operator">=</span><span class="token number">0.9</span><span class="token punctuation">,</span> nb_classes<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">,</span>                             img_rows<span class="token operator">=</span><span class="token number">197</span><span class="token punctuation">,</span> img_cols<span class="token operator">=</span><span class="token number">197</span><span class="token punctuation">,</span> RGB<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span> is_plot_model<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token triple-quoted-string string">"""InceptionV3模型，建立自己的模型        Args:            lr (float, optional): 学习率. Defaults to 0.005.            decay ([type], optional): 学习衰减率. Defaults to 1e-6.            momentum (float, optional): Defaults to 0.9.            nb_classes (int, optional): 分类数. Defaults to 2.            img_rows (int, optional): 图片行数. Defaults to 197.            img_cols (int, optional): 图片列数. Defaults to 197.            RGB (bool, optional): 是否为3通道图片. Defaults to True.            is_plot_model (bool, optional): 是否画出模型网络结构图. Defaults to False.        Returns:            [type]: 返回模型        """</span>        color <span class="token operator">=</span> <span class="token number">3</span> <span class="token keyword">if</span> RGB <span class="token keyword">else</span> <span class="token number">1</span>        <span class="token comment"># 假设最后一层CNN的层输出为(img_rows, img_cols, color)</span>        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'=================加载预训练模型================='</span><span class="token punctuation">)</span>        base_model <span class="token operator">=</span> InceptionV3<span class="token punctuation">(</span>weights<span class="token operator">=</span><span class="token string">'imagenet'</span><span class="token punctuation">,</span>                                 include_top<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">,</span>                                 input_shape<span class="token operator">=</span><span class="token punctuation">(</span>img_rows<span class="token punctuation">,</span> img_cols<span class="token punctuation">,</span> color<span class="token punctuation">)</span><span class="token punctuation">,</span>                                 <span class="token punctuation">)</span>        <span class="token comment"># 对我们的输出进行平铺操作,為全連接层做准备</span>        x <span class="token operator">=</span> layers<span class="token punctuation">.</span>Flatten<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">(</span>base_model<span class="token punctuation">.</span>output<span class="token punctuation">)</span>        <span class="token comment"># 增加一个全连接层，并使用relu作为激活函数，这是需要训练的</span>        x <span class="token operator">=</span> layers<span class="token punctuation">.</span>Dense<span class="token punctuation">(</span><span class="token number">1024</span><span class="token punctuation">,</span> activation<span class="token operator">=</span><span class="token string">'relu'</span><span class="token punctuation">)</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span>        <span class="token comment"># 添加随机失活，抑制过拟合</span>        x <span class="token operator">=</span> layers<span class="token punctuation">.</span>Dropout<span class="token punctuation">(</span><span class="token number">0.2</span><span class="token punctuation">)</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span>        <span class="token comment"># ，输出层，把输出设置成softmax函数</span>        predictions <span class="token operator">=</span> layers<span class="token punctuation">.</span>Dense<span class="token punctuation">(</span>nb_classes<span class="token punctuation">,</span> activation<span class="token operator">=</span><span class="token string">'softmax'</span><span class="token punctuation">)</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span>        <span class="token comment"># 训练模型</span>        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'================创建自己的模型=================='</span><span class="token punctuation">)</span>        model <span class="token operator">=</span> Model<span class="token punctuation">(</span>inputs<span class="token operator">=</span>base_model<span class="token punctuation">.</span><span class="token builtin">input</span><span class="token punctuation">,</span> outputs<span class="token operator">=</span>predictions<span class="token punctuation">)</span>        <span class="token comment"># 冻结base_model所有层，这样就可以正确获得bottleneck特征</span>        <span class="token keyword">for</span> layer <span class="token keyword">in</span> base_model<span class="token punctuation">.</span>layers<span class="token punctuation">:</span>            layer<span class="token punctuation">.</span>trainable <span class="token operator">=</span> <span class="token boolean">False</span>        sgd <span class="token operator">=</span> SGD<span class="token punctuation">(</span>lr<span class="token operator">=</span>lr<span class="token punctuation">,</span> decay<span class="token operator">=</span>decay<span class="token punctuation">,</span> momentum<span class="token operator">=</span>momentum<span class="token punctuation">,</span> nesterov<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'================编译模型================='</span><span class="token punctuation">)</span>        model<span class="token punctuation">.</span><span class="token builtin">compile</span><span class="token punctuation">(</span>loss<span class="token operator">=</span><span class="token string">'categorical_crossentropy'</span><span class="token punctuation">,</span>                      optimizer<span class="token operator">=</span>sgd<span class="token punctuation">,</span> metrics<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'acc'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'=================打印模型结构信息================='</span><span class="token punctuation">)</span>        model<span class="token punctuation">.</span>summary<span class="token punctuation">(</span><span class="token punctuation">)</span>        <span class="token comment"># 可视化网络结构，生成图片</span>        <span class="token keyword">if</span> is_plot_model<span class="token punctuation">:</span>            plot_model<span class="token punctuation">(</span>model<span class="token punctuation">,</span> to_file<span class="token operator">=</span><span class="token string">'inceptionV3_model.png'</span><span class="token punctuation">,</span>                       show_shapes<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>        <span class="token keyword">return</span> model    <span class="token keyword">def</span> <span class="token function">train_model</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> model<span class="token punctuation">,</span> epochs<span class="token punctuation">,</span> train_generator<span class="token punctuation">,</span> steps_per_epoch<span class="token punctuation">,</span>                     validation_generator<span class="token punctuation">,</span> validation_steps<span class="token punctuation">,</span>path_save_model<span class="token punctuation">,</span> is_load_model<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token triple-quoted-string string">"""训练模型，载入、保存、断点续训        Args:            model ([type]): 模型            epochs ([type]): 训练次数            train_generator ([type]): 训练集            steps_per_epoch ([type]):             validation_generator ([type]): 验证集            validation_steps ([type]):             path_save_model ([type]): 保存模型路径            is_load_model (bool, optional): 是否载入模型. Defaults to False.        Returns:            [type]: 训练记录        """</span>        <span class="token comment"># 载入模型</span>        <span class="token keyword">if</span> is_load_model <span class="token keyword">and</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>exists<span class="token punctuation">(</span>path_save_model<span class="token punctuation">)</span><span class="token punctuation">:</span>            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'================载入已训练模型==============='</span><span class="token punctuation">)</span>            model <span class="token operator">=</span> load_model<span class="token punctuation">(</span>path_save_model<span class="token punctuation">)</span>        <span class="token comment"># 使用tensorboard</span>        log_dir <span class="token operator">=</span> <span class="token string">"logs/fit/"</span> <span class="token operator">+</span> datetime<span class="token punctuation">.</span>datetime<span class="token punctuation">.</span>now<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>strftime<span class="token punctuation">(</span><span class="token string">"%Y%m%d-%H%M%S"</span><span class="token punctuation">)</span>        tensorboard_callback <span class="token operator">=</span> tf<span class="token punctuation">.</span>keras<span class="token punctuation">.</span>callbacks<span class="token punctuation">.</span>TensorBoard<span class="token punctuation">(</span>            log_dir<span class="token operator">=</span>log_dir<span class="token punctuation">,</span> histogram_freq<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span>        <span class="token comment"># 断点续训</span>        <span class="token comment"># 格式化字符，防止文件名冲突</span>        checkpoint_path <span class="token operator">=</span> <span class="token string">'ckpt/transfer_{epoch:02d}-{val_acc:.2f}.h5'</span>        checkpoint_callback <span class="token operator">=</span> tf<span class="token punctuation">.</span>keras<span class="token punctuation">.</span>callbacks<span class="token punctuation">.</span>ModelCheckpoint<span class="token punctuation">(</span>            checkpoint_path<span class="token punctuation">,</span>  <span class="token comment"># 保存路径，指定为tensorflow二进制文件ckpt</span>            monitor<span class="token operator">=</span><span class="token string">'val_acc'</span><span class="token punctuation">,</span>  <span class="token comment"># 监测指标，这里是测试集的acc</span>                                save_best_only<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">,</span>  <span class="token comment"># 是否只保存最佳</span>            save_weights_only<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span>  <span class="token comment"># 只保存权重</span>            mode<span class="token operator">=</span><span class="token string">'max'</span><span class="token punctuation">,</span>            period<span class="token operator">=</span><span class="token number">1</span>  <span class="token comment"># 每period个周期保存一次</span>        <span class="token punctuation">)</span>        <span class="token comment"># 训练</span>        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'================开始训练================'</span><span class="token punctuation">)</span>        history_ft <span class="token operator">=</span> model<span class="token punctuation">.</span>fit_generator<span class="token punctuation">(</span>            train_generator<span class="token punctuation">,</span>            steps_per_epoch<span class="token operator">=</span>steps_per_epoch<span class="token punctuation">,</span>            epochs<span class="token operator">=</span>epochs<span class="token punctuation">,</span>            validation_data<span class="token operator">=</span>validation_generator<span class="token punctuation">,</span>            validation_steps<span class="token operator">=</span>validation_steps<span class="token punctuation">,</span>            verbose<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span>  <span class="token comment"># 日志显示，0/1,1表示输出进度条日志信息</span>            callbacks<span class="token operator">=</span><span class="token punctuation">[</span>tensorboard_callback<span class="token punctuation">,</span> checkpoint_callback<span class="token punctuation">]</span><span class="token punctuation">)</span>        <span class="token comment"># 模型保存</span>        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'================保存模型================'</span><span class="token punctuation">)</span>        model<span class="token punctuation">.</span>save<span class="token punctuation">(</span>path_save_model<span class="token punctuation">,</span> overwrite<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>        <span class="token keyword">return</span> history_ft    <span class="token keyword">def</span> <span class="token function">plot_training</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> history<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token triple-quoted-string string">"""可视化acc/loss图        Args:            history ([type]): 训练        """</span>        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'================绘制acc/loss图================'</span><span class="token punctuation">)</span>        acc <span class="token operator">=</span> history<span class="token punctuation">.</span>history<span class="token punctuation">[</span><span class="token string">'acc'</span><span class="token punctuation">]</span>        val_acc <span class="token operator">=</span> history<span class="token punctuation">.</span>history<span class="token punctuation">[</span><span class="token string">'val_acc'</span><span class="token punctuation">]</span>        loss <span class="token operator">=</span> history<span class="token punctuation">.</span>history<span class="token punctuation">[</span><span class="token string">'loss'</span><span class="token punctuation">]</span>        val_loss <span class="token operator">=</span> history<span class="token punctuation">.</span>history<span class="token punctuation">[</span><span class="token string">'val_loss'</span><span class="token punctuation">]</span>        epochs <span class="token operator">=</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>acc<span class="token punctuation">)</span><span class="token punctuation">)</span>        plt<span class="token punctuation">.</span>plot<span class="token punctuation">(</span>epochs<span class="token punctuation">,</span> acc<span class="token punctuation">,</span> <span class="token string">'b-'</span><span class="token punctuation">)</span>        plt<span class="token punctuation">.</span>plot<span class="token punctuation">(</span>epochs<span class="token punctuation">,</span> val_acc<span class="token punctuation">,</span> <span class="token string">'r'</span><span class="token punctuation">)</span>        plt<span class="token punctuation">.</span>title<span class="token punctuation">(</span><span class="token string">'Training and validation accuracy'</span><span class="token punctuation">)</span>        plt<span class="token punctuation">.</span>figure<span class="token punctuation">(</span><span class="token punctuation">)</span>        plt<span class="token punctuation">.</span>plot<span class="token punctuation">(</span>epochs<span class="token punctuation">,</span> loss<span class="token punctuation">,</span> <span class="token string">'b-'</span><span class="token punctuation">)</span>        plt<span class="token punctuation">.</span>plot<span class="token punctuation">(</span>epochs<span class="token punctuation">,</span> val_loss<span class="token punctuation">,</span> <span class="token string">'r-'</span><span class="token punctuation">)</span>        plt<span class="token punctuation">.</span>title<span class="token punctuation">(</span><span class="token string">'Training and validation loss'</span><span class="token punctuation">)</span>        plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>    image_size <span class="token operator">=</span> <span class="token number">150</span>    batch_size <span class="token operator">=</span> <span class="token number">20</span>    num_train <span class="token operator">=</span> <span class="token number">300</span>    num_val <span class="token operator">=</span> <span class="token number">100</span>    transfer_model <span class="token operator">=</span> PowerTransferMode<span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token comment"># 得到数据</span>    train_generator <span class="token operator">=</span> transfer_model<span class="token punctuation">.</span>DataGen<span class="token punctuation">(</span><span class="token string">'./data/岩石数据集/train'</span><span class="token punctuation">,</span>                                             image_size<span class="token punctuation">,</span>                                             image_size<span class="token punctuation">,</span>                                             batch_size<span class="token punctuation">,</span>                                             <span class="token boolean">True</span><span class="token punctuation">)</span>    validation_generator <span class="token operator">=</span> transfer_model<span class="token punctuation">.</span>DataGen<span class="token punctuation">(</span><span class="token string">'./data/岩石数据集/validation'</span><span class="token punctuation">,</span>                                                  image_size<span class="token punctuation">,</span>                                                  image_size<span class="token punctuation">,</span>                                                  batch_size<span class="token punctuation">,</span>                                                  <span class="token boolean">False</span><span class="token punctuation">)</span>    <span class="token comment"># InceptionV3</span>    model <span class="token operator">=</span> transfer_model<span class="token punctuation">.</span>InceptionV3_model<span class="token punctuation">(</span>nb_classes<span class="token operator">=</span><span class="token number">5</span><span class="token punctuation">,</span>                                             img_rows<span class="token operator">=</span>image_size<span class="token punctuation">,</span>                                             img_cols<span class="token operator">=</span>image_size<span class="token punctuation">,</span>                                             is_plot_model<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span>    <span class="token comment"># 训练模型</span>    history_ft <span class="token operator">=</span> transfer_model<span class="token punctuation">.</span>train_model<span class="token punctuation">(</span>model<span class="token punctuation">,</span>                                            epochs<span class="token operator">=</span><span class="token number">50</span><span class="token punctuation">,</span>                                            train_generator<span class="token operator">=</span>train_generator<span class="token punctuation">,</span>                                            steps_per_epoch<span class="token operator">=</span>num_train <span class="token operator">/</span> batch_size<span class="token punctuation">,</span>                                            validation_generator<span class="token operator">=</span>validation_generator<span class="token punctuation">,</span>                                            validation_steps<span class="token operator">=</span>num_val <span class="token operator">/</span> batch_size<span class="token punctuation">,</span>                                            path_save_model<span class="token operator">=</span><span class="token string">'model/my_saved_InceptionV3_model.h5'</span><span class="token punctuation">,</span>                                            is_load_model<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>    transfer_model<span class="token punctuation">.</span>plot_training<span class="token punctuation">(</span>history_ft<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><strong>predict.py</strong></p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># -*- coding: utf-8 -*-</span><span class="token comment"># @Time    : 2021/08/15</span><span class="token comment"># @Author  : Z.J</span><span class="token comment"># @File    : predict.py</span><span class="token comment"># @Software: vs code</span><span class="token keyword">from</span> tensorflow<span class="token punctuation">.</span>keras<span class="token punctuation">.</span>preprocessing <span class="token keyword">import</span> image<span class="token keyword">import</span> numpy <span class="token keyword">as</span> np<span class="token keyword">import</span> os<span class="token keyword">import</span> tensorflow <span class="token keyword">as</span> tf<span class="token keyword">import</span> train<span class="token keyword">from</span> tensorflow<span class="token punctuation">.</span>python<span class="token punctuation">.</span>training<span class="token punctuation">.</span>checkpoint_management <span class="token keyword">import</span> latest_checkpointpath <span class="token operator">=</span> <span class="token string">"./tmp/predict/"</span>  <span class="token comment"># 预测图片的路径</span>path_save_model <span class="token operator">=</span> <span class="token string">'./model/my_saved_InceptionV3_model.h5'</span>  <span class="token comment"># 保存的模型的路径</span>checkpoint_path <span class="token operator">=</span> <span class="token string">'ckpt/transfer_{epoch:02d}-{val_acc:.2f}.h5'</span>  <span class="token comment"># 检查点路径</span>checkpoint_root <span class="token operator">=</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>dirname<span class="token punctuation">(</span>checkpoint_path<span class="token punctuation">)</span>  <span class="token comment"># 检查点文件根目录</span>image_size <span class="token operator">=</span> <span class="token number">150</span>  <span class="token comment"># 图片格式(150,150)</span><span class="token comment"># 建立标签字典，便于输出结果</span>label_dict <span class="token operator">=</span> <span class="token punctuation">{</span>    <span class="token string">'0'</span><span class="token punctuation">:</span> <span class="token string">'安山岩'</span><span class="token punctuation">,</span>    <span class="token string">'1'</span><span class="token punctuation">:</span> <span class="token string">'石灰岩'</span><span class="token punctuation">,</span>    <span class="token string">'2'</span><span class="token punctuation">:</span> <span class="token string">'石英岩'</span><span class="token punctuation">,</span>    <span class="token string">'3'</span><span class="token punctuation">:</span> <span class="token string">'砾岩'</span><span class="token punctuation">,</span>    <span class="token string">'4'</span><span class="token punctuation">:</span> <span class="token string">'花岗岩'</span><span class="token punctuation">}</span><span class="token keyword">def</span> <span class="token function">loadWeights</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token triple-quoted-string string">"""    读取保存的权重数据，需先构建网络结构一致的新模型    """</span>    base_model <span class="token operator">=</span> train<span class="token punctuation">.</span>PowerTransferMode<span class="token punctuation">(</span><span class="token punctuation">)</span>    model <span class="token operator">=</span> base_model<span class="token punctuation">.</span>InceptionV3_model<span class="token punctuation">(</span>        nb_classes<span class="token operator">=</span><span class="token number">5</span><span class="token punctuation">,</span>        img_rows<span class="token operator">=</span>image_size<span class="token punctuation">,</span>        img_cols<span class="token operator">=</span>image_size<span class="token punctuation">,</span>        is_plot_model<span class="token operator">=</span><span class="token boolean">False</span>    <span class="token punctuation">)</span>    <span class="token comment"># 从检查点恢复权重</span>    saved_weights <span class="token operator">=</span> <span class="token string">'./ckpt/transfer_50-1.00.h5'</span>    <span class="token comment"># latest_weights = tf.train.latest_checkpoint(checkpoint_root)  只对ckpt格式文件有用！</span>    model<span class="token punctuation">.</span>load_weights<span class="token punctuation">(</span>saved_weights<span class="token punctuation">)</span>    <span class="token keyword">return</span> model<span class="token keyword">def</span> <span class="token function">loadModel</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token triple-quoted-string string">"""读取全部模型数据"""</span>    model <span class="token operator">=</span> tf<span class="token punctuation">.</span>keras<span class="token punctuation">.</span>models<span class="token punctuation">.</span>load_model<span class="token punctuation">(</span><span class="token string">'model/my_saved_InceptionV3_model.h5'</span><span class="token punctuation">)</span>    <span class="token keyword">return</span> model<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>    model <span class="token operator">=</span> loadWeights<span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span>model<span class="token punctuation">.</span>summary<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token keyword">for</span> img_name <span class="token keyword">in</span> os<span class="token punctuation">.</span>listdir<span class="token punctuation">(</span>path<span class="token punctuation">)</span><span class="token punctuation">:</span>        img_path <span class="token operator">=</span> path<span class="token operator">+</span>img_name        img <span class="token operator">=</span> image<span class="token punctuation">.</span>load_img<span class="token punctuation">(</span>img_path<span class="token punctuation">,</span> target_size<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">150</span><span class="token punctuation">,</span> <span class="token number">150</span><span class="token punctuation">)</span><span class="token punctuation">)</span>        <span class="token comment"># 保持输入格式一致</span>        x <span class="token operator">=</span> image<span class="token punctuation">.</span>img_to_array<span class="token punctuation">(</span>img<span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">255</span>        <span class="token comment"># 变为四维数据</span>        x <span class="token operator">=</span> np<span class="token punctuation">.</span>expand_dims<span class="token punctuation">(</span>x<span class="token punctuation">,</span> axis<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">)</span>        <span class="token comment"># 预测</span>        result <span class="token operator">=</span> model<span class="token punctuation">.</span>predict<span class="token punctuation">(</span>x<span class="token punctuation">)</span>        <span class="token comment"># 返回最大概率值的索引，类型是张量</span>        index <span class="token operator">=</span> tf<span class="token punctuation">.</span>argmax<span class="token punctuation">(</span>result<span class="token punctuation">,</span> axis<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span>        <span class="token keyword">print</span><span class="token punctuation">(</span>img_name<span class="token punctuation">,</span> <span class="token string">'======================&gt;'</span><span class="token punctuation">,</span> label_dict<span class="token punctuation">[</span><span class="token builtin">str</span><span class="token punctuation">(</span><span class="token builtin">int</span><span class="token punctuation">(</span>index<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h2><p><a href="https://blog.csdn.net/pengdali/article/details/79050662">https://blog.csdn.net/pengdali/article/details/79050662</a></p><p><a href="https://blog.csdn.net/m0_46334316/article/details/117607628">https://blog.csdn.net/m0_46334316/article/details/117607628</a> 感谢博主提供的岩石数据集</p><p><a href="https://blog.csdn.net/weixin_43999137/article/details/104093095">https://blog.csdn.net/weixin_43999137/article/details/104093095</a></p><p><a href="http://www.51zixue.net/Keras/853.html">http://www.51zixue.net/Keras/853.html</a></p><p><a href="https://blog.csdn.net/mieleizhi0522/article/details/82191331">https://blog.csdn.net/mieleizhi0522/article/details/82191331</a></p>]]></content>
      
      
      <categories>
          
          <category> 图像分类 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 深度学习 </tag>
            
            <tag> tensorflow </tag>
            
            <tag> keras </tag>
            
            <tag> 图像分类 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Python批量删除含有指定字符的文件或文件夹</title>
      <link href="/2021/08/30/Python-batch-delet-files/"/>
      <url>/2021/08/30/Python-batch-delet-files/</url>
      
        <content type="html"><![CDATA[<h1 id="Python批量删除含有指定字符的文件或文件夹"><a href="#Python批量删除含有指定字符的文件或文件夹" class="headerlink" title="Python批量删除含有指定字符的文件或文件夹"></a>Python批量删除含有指定字符的文件或文件夹</h1><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># encoding: UTF-8</span><span class="token keyword">import</span> os<span class="token keyword">from</span> pathlib <span class="token keyword">import</span> Pathp <span class="token operator">=</span> Path<span class="token punctuation">(</span><span class="token string">r'./test/erli'</span><span class="token punctuation">)</span><span class="token comment"># 这里不得不感慨，Python的库，几乎满足你所有需要，看，连这个递归查找过滤都有了！</span><span class="token comment"># 实现思路：递归遍历文件夹中的文件，如果文件名包含"(-)"，就删掉，下面是代码：</span><span class="token keyword">for</span> <span class="token builtin">file</span> <span class="token keyword">in</span> p<span class="token punctuation">.</span>rglob<span class="token punctuation">(</span><span class="token string">'*(-)*'</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">if</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>isfile<span class="token punctuation">(</span><span class="token builtin">file</span><span class="token punctuation">)</span><span class="token punctuation">:</span>      <span class="token comment">#这里判断下，如果是文件夹就先不删</span>        os<span class="token punctuation">.</span>remove<span class="token punctuation">(</span><span class="token builtin">file</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>参考：</p><p><a href="https://www.jianshu.com/p/17ae57c19d1d">https://www.jianshu.com/p/17ae57c19d1d</a></p>]]></content>
      
      
      <categories>
          
          <category> python </category>
          
      </categories>
      
      
        <tags>
            
            <tag> python </tag>
            
            <tag> 算法 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>pyqt5小记| QSS开源暗黑主题qdarkstyle ，读取QSS主题文件</title>
      <link href="/2021/08/30/pyqt5-QSS-qdarkstyle/"/>
      <url>/2021/08/30/pyqt5-QSS-qdarkstyle/</url>
      
        <content type="html"><![CDATA[<h1 id="pyqt5小记-QSS开源暗黑主题qdarkstyle-，读取QSS主题文件"><a href="#pyqt5小记-QSS开源暗黑主题qdarkstyle-，读取QSS主题文件" class="headerlink" title="pyqt5小记| QSS开源暗黑主题qdarkstyle ，读取QSS主题文件"></a>pyqt5小记| QSS开源暗黑主题qdarkstyle ，读取QSS主题文件</h1><h2 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h2><pre class="line-numbers language-python" data-language="python"><code class="language-python">Pip install qdarkstyle<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h2 id="使用"><a href="#使用" class="headerlink" title="使用"></a>使用</h2><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> sys<span class="token keyword">from</span> PyQt5<span class="token punctuation">.</span>QtGui <span class="token keyword">import</span> QIcon<span class="token keyword">import</span> qdarkstyle<span class="token keyword">from</span> PyQt5 <span class="token keyword">import</span> QtCore<span class="token keyword">from</span> PyQt5<span class="token punctuation">.</span>QtWidgets <span class="token keyword">import</span> QApplication<span class="token punctuation">,</span>  QMainWindow<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>    app <span class="token operator">=</span> QApplication<span class="token punctuation">(</span>sys<span class="token punctuation">.</span>argv<span class="token punctuation">)</span>    app<span class="token punctuation">.</span>setAttribute<span class="token punctuation">(</span>QtCore<span class="token punctuation">.</span>Qt<span class="token punctuation">.</span>AA_EnableHighDpiScaling<span class="token punctuation">)</span>  <span class="token comment"># 适应高分辨率</span>    <span class="token comment"># qdarkstyle</span>    <span class="token comment"># 设置qdarkstyle！！！</span>    app<span class="token punctuation">.</span>setStyleSheet<span class="token punctuation">(</span>qdarkstyle<span class="token punctuation">.</span>load_stylesheet<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token comment">#</span>myMainWindow <span class="token operator">=</span> QMainWindow<span class="token punctuation">(</span><span class="token punctuation">)</span>    myUi <span class="token operator">=</span> wMain<span class="token punctuation">.</span>Ui_MainWindow<span class="token punctuation">(</span><span class="token punctuation">)</span>    myUi<span class="token punctuation">.</span>setupUi<span class="token punctuation">(</span>myMainWindow<span class="token punctuation">)</span>    myMainWindow<span class="token punctuation">.</span>setWindowTitle<span class="token punctuation">(</span><span class="token string">'ZDEMViewer    离散元数值模拟可视化程序'</span><span class="token punctuation">)</span>    myMainWindow<span class="token punctuation">.</span>setWindowIcon<span class="token punctuation">(</span>QIcon<span class="token punctuation">(</span><span class="token string">"./icons/logo.ico"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    myMainWindow<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>    sys<span class="token punctuation">.</span>exit<span class="token punctuation">(</span>app<span class="token punctuation">.</span>exec_<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="效果"><a href="#效果" class="headerlink" title="效果"></a>效果</h2><p>![](<a href="https://cdn.jsdelivr.net/gh/JlexZhong/J.CS-note@main/pyqt5">https://cdn.jsdelivr.net/gh/JlexZhong/J.CS-note@main/pyqt5</a> QSS开源暗黑主题qdarkstyle.assets/暗黑主题 2021-08-19 113230.png)</p><h2 id="如何读取QSS文件作为GUI主题"><a href="#如何读取QSS文件作为GUI主题" class="headerlink" title="如何读取QSS文件作为GUI主题"></a>如何读取QSS文件作为GUI主题</h2><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">'./QSS/myQSS.qss'</span><span class="token punctuation">,</span> encoding<span class="token operator">=</span><span class="token string">'utf-8'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span>qss <span class="token operator">=</span> f<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span>app<span class="token punctuation">.</span>setStyleSheet<span class="token punctuation">(</span>qss<span class="token punctuation">)</span>  <span class="token comment"># 设置主题</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>]]></content>
      
      
      
        <tags>
            
            <tag> PyQt </tag>
            
            <tag> GUI </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>pyqt5 setWindowTitle 设置窗口标题失效解决办法</title>
      <link href="/2021/08/30/pyqt5-setWindowTitle/"/>
      <url>/2021/08/30/pyqt5-setWindowTitle/</url>
      
        <content type="html"><![CDATA[<h1 id="pyqt5-setWindowTitle-设置窗口标题失效解决办法"><a href="#pyqt5-setWindowTitle-设置窗口标题失效解决办法" class="headerlink" title="pyqt5 setWindowTitle 设置窗口标题失效解决办法"></a>pyqt5 setWindowTitle 设置窗口标题失效解决办法</h1><pre class="line-numbers language-python" data-language="python"><code class="language-python">myMainWindow <span class="token operator">=</span> QMainWindow<span class="token punctuation">(</span><span class="token punctuation">)</span>myUi <span class="token operator">=</span> wMain<span class="token punctuation">.</span>Ui_MainWindow<span class="token punctuation">(</span><span class="token punctuation">)</span>myUi<span class="token punctuation">.</span>setupUi<span class="token punctuation">(</span>myMainWindow<span class="token punctuation">)</span>myMainWindow<span class="token punctuation">.</span>setWindowTitle<span class="token punctuation">(</span><span class="token string">'ZDEMViewer    离散元数值模拟可视化程序'</span><span class="token punctuation">)</span>myMainWindow<span class="token punctuation">.</span>setWindowIcon<span class="token punctuation">(</span>QIcon<span class="token punctuation">(</span><span class="token string">"./icons/logo.ico"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>myMainWindow<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>如上所示的设置顺序可以成功</p><p>如果是：</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">myMainWindow <span class="token operator">=</span> QMainWindow<span class="token punctuation">(</span><span class="token punctuation">)</span>myMainWindow<span class="token punctuation">.</span>setWindowTitle<span class="token punctuation">(</span><span class="token string">'ZDEMViewer    离散元数值模拟可视化程序'</span><span class="token punctuation">)</span>myMainWindow<span class="token punctuation">.</span>setWindowIcon<span class="token punctuation">(</span>QIcon<span class="token punctuation">(</span><span class="token string">"./icons/logo.ico"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>myUi <span class="token operator">=</span> wMain<span class="token punctuation">.</span>Ui_MainWindow<span class="token punctuation">(</span><span class="token punctuation">)</span>myUi<span class="token punctuation">.</span>setupUi<span class="token punctuation">(</span>myMainWindow<span class="token punctuation">)</span>myMainWindow<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>会出现<strong>图标能够生效</strong>，但是标题在生效之后一闪而过，变为“MainWindow”</p>]]></content>
      
      
      <categories>
          
          <category> PyQt </category>
          
      </categories>
      
      
        <tags>
            
            <tag> PyQt </tag>
            
            <tag> GUI </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>pyqtgraph嵌入pyqt界面中 | 修改pyqtgraph背景颜色 | 坐标轴等比例缩放</title>
      <link href="/2021/08/30/pyqtgraph-to-pyqt-background-axes-square/"/>
      <url>/2021/08/30/pyqtgraph-to-pyqt-background-axes-square/</url>
      
        <content type="html"><![CDATA[<h1 id="pyqtgraph嵌入pyqt界面中-修改pyqtgraph背景颜色-坐标轴等比例缩放"><a href="#pyqtgraph嵌入pyqt界面中-修改pyqtgraph背景颜色-坐标轴等比例缩放" class="headerlink" title="pyqtgraph嵌入pyqt界面中 | 修改pyqtgraph背景颜色 | 坐标轴等比例缩放"></a>pyqtgraph嵌入pyqt界面中 | 修改pyqtgraph背景颜色 | 坐标轴等比例缩放</h1><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">class</span> <span class="token class-name">pyqtgraph_widget</span><span class="token punctuation">(</span>QWidget<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token triple-quoted-string string">"""将pyqtgraph嵌入到pyqt界面中    Args:        QWidget ([type]): 基于QWidget组件    """</span>    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> parent<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token triple-quoted-string string">"""        :param parent: 父组件        """</span>               QWidget<span class="token punctuation">.</span>__init__<span class="token punctuation">(</span>self<span class="token punctuation">,</span> parent<span class="token punctuation">)</span>        <span class="token comment"># 创建垂直布局</span>        self<span class="token punctuation">.</span>layout <span class="token operator">=</span> QtWidgets<span class="token punctuation">.</span>QVBoxLayout<span class="token punctuation">(</span>self<span class="token punctuation">)</span>        self<span class="token punctuation">.</span>layout<span class="token punctuation">.</span>setObjectName<span class="token punctuation">(</span><span class="token string">'layout'</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>layout<span class="token punctuation">.</span>setContentsMargins<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span>        <span class="token comment"># 修改背景颜色</span>        pg<span class="token punctuation">.</span>setConfigOption<span class="token punctuation">(</span><span class="token string">'background'</span><span class="token punctuation">,</span> <span class="token string">'#FFFFFF'</span><span class="token punctuation">)</span>        pg<span class="token punctuation">.</span>setConfigOption<span class="token punctuation">(</span><span class="token string">'foreground'</span><span class="token punctuation">,</span> <span class="token string">'k'</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>plot_widget <span class="token operator">=</span> pg<span class="token punctuation">.</span>PlotWidget<span class="token punctuation">(</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>layout<span class="token punctuation">.</span>addWidget<span class="token punctuation">(</span>self<span class="token punctuation">.</span>plot_widget<span class="token punctuation">)</span>        self<span class="token punctuation">.</span>plot_widget<span class="token punctuation">.</span>setAspectLocked<span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment"># 坐标轴等比例缩放</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>]]></content>
      
      
      <categories>
          
          <category> PyQt </category>
          
      </categories>
      
      
        <tags>
            
            <tag> PyQt </tag>
            
            <tag> GUI </tag>
            
            <tag> pyqtgraph </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>pyqt小记|侧边栏（QListWidget+QStackedWidget）实现</title>
      <link href="/2021/08/30/pyqt-listbar-QListWidget+QStackedWidget/"/>
      <url>/2021/08/30/pyqt-listbar-QListWidget+QStackedWidget/</url>
      
        <content type="html"><![CDATA[<h1 id="pyqt小记-侧边栏（QListWidget-QStackedWidget）实现"><a href="#pyqt小记-侧边栏（QListWidget-QStackedWidget）实现" class="headerlink" title="pyqt小记|侧边栏（QListWidget+QStackedWidget）实现"></a>pyqt小记|侧边栏（QListWidget+QStackedWidget）实现</h1><h2 id="效果"><a href="#效果" class="headerlink" title="效果"></a>效果</h2><p>![](<a href="https://cdn.jsdelivr.net/gh/JlexZhong/J.CS-note@main/pyqt%E5%B0%8F%E8%AE%B0%E4%BE%A7%E8%BE%B9%E6%A0%8F%EF%BC%88QListWidget+QStackedWidget%EF%BC%89%E5%AE%9E%E7%8E%B0.assets/2021-08-19">https://cdn.jsdelivr.net/gh/JlexZhong/J.CS-note@main/pyqt小记侧边栏（QListWidget+QStackedWidget）实现.assets/2021-08-19</a> 112919.png)</p><h2 id="思路"><a href="#思路" class="headerlink" title="思路"></a>思路</h2><ul><li>左边是<strong>listwidget</strong>，右边是<strong>stackedwidget</strong>。</li><li>点击listwidget的不同item，跳转到stackedwidget不同的页面。</li><li>最后通过<strong>qss美化</strong>。</li></ul><p><img src="https://cdn.jsdelivr.net/gh/JlexZhong/J.CS-note@main/pyqt%E5%B0%8F%E8%AE%B0%E4%BE%A7%E8%BE%B9%E6%A0%8F%EF%BC%88QListWidget+QStackedWidget%EF%BC%89%E5%AE%9E%E7%8E%B0.assets/%E4%BE%A7%E8%BE%B9%E6%A0%8F%E7%BB%93%E6%9E%84.png"></p><h2 id="实现"><a href="#实现" class="headerlink" title="实现"></a>实现</h2><h3 id="初始化界面"><a href="#初始化界面" class="headerlink" title="初始化界面"></a>初始化界面</h3><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">def</span> <span class="token function">init_leftWidget</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token comment"># self.leftFrame是父组件</span>    self<span class="token punctuation">.</span>leftFrame_HLayout <span class="token operator">=</span> QtWidgets<span class="token punctuation">.</span>QHBoxLayout<span class="token punctuation">(</span>self<span class="token punctuation">.</span>leftFrame<span class="token punctuation">)</span>   self<span class="token punctuation">.</span>leftFrame_HLayout<span class="token punctuation">.</span>setSpacing<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>    self<span class="token punctuation">.</span>leftFrame_HLayout<span class="token punctuation">.</span>setContentsMargins<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span>   self<span class="token punctuation">.</span>leftFrame_HLayout<span class="token punctuation">.</span>setAlignment<span class="token punctuation">(</span>QtCore<span class="token punctuation">.</span>Qt<span class="token punctuation">.</span>AlignCenter<span class="token punctuation">)</span>      <span class="token comment"># 实例化两个组件</span>   self<span class="token punctuation">.</span>left_list_widget <span class="token operator">=</span> QtWidgets<span class="token punctuation">.</span>QListWidget<span class="token punctuation">(</span>self<span class="token punctuation">.</span>leftFrame<span class="token punctuation">)</span>   self<span class="token punctuation">.</span>left_stacked_widget <span class="token operator">=</span> QtWidgets<span class="token punctuation">.</span>QStackedWidget<span class="token punctuation">(</span>self<span class="token punctuation">.</span>leftFrame<span class="token punctuation">)</span>   self<span class="token punctuation">.</span>left_stacked_widget<span class="token punctuation">.</span>setContentsMargins<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span>   self<span class="token punctuation">.</span>leftFrame_HLayout<span class="token punctuation">.</span>addWidget<span class="token punctuation">(</span>self<span class="token punctuation">.</span>left_list_widget<span class="token punctuation">)</span>   self<span class="token punctuation">.</span>leftFrame_HLayout<span class="token punctuation">.</span>addWidget<span class="token punctuation">(</span>self<span class="token punctuation">.</span>left_stacked_widget<span class="token punctuation">)</span>                 self<span class="token punctuation">.</span>left_list_widget<span class="token punctuation">.</span>setFrameShape<span class="token punctuation">(</span>QtWidgets<span class="token punctuation">.</span>QListWidget<span class="token punctuation">.</span>NoFrame<span class="token punctuation">)</span> <span class="token comment"># 去除边框</span>    self<span class="token punctuation">.</span>left_list_widget<span class="token punctuation">.</span>setVerticalScrollBarPolicy<span class="token punctuation">(</span>Qt<span class="token punctuation">.</span>ScrollBarPolicy<span class="token punctuation">.</span>ScrollBarAlwaysOff<span class="token punctuation">)</span>  <span class="token comment"># 隐藏垂直滚动条</span>    self<span class="token punctuation">.</span>left_list_widget<span class="token punctuation">.</span>setHorizontalScrollBarPolicy<span class="token punctuation">(</span>Qt<span class="token punctuation">.</span>ScrollBarPolicy<span class="token punctuation">.</span>ScrollBarAlwaysOff<span class="token punctuation">)</span><span class="token comment"># 隐藏水平滚动条</span>    <span class="token comment"># 设置字体</span>    font_1 <span class="token operator">=</span> QtGui<span class="token punctuation">.</span>QFont<span class="token punctuation">(</span><span class="token punctuation">)</span>    font_1<span class="token punctuation">.</span>setFamily<span class="token punctuation">(</span><span class="token string">"黑体"</span><span class="token punctuation">)</span>    font_1<span class="token punctuation">.</span>setPointSize<span class="token punctuation">(</span><span class="token number">12</span><span class="token punctuation">)</span>    font_1<span class="token punctuation">.</span>setBold<span class="token punctuation">(</span><span class="token boolean">False</span><span class="token punctuation">)</span>    self<span class="token punctuation">.</span>left_list_widget<span class="token punctuation">.</span>setFont<span class="token punctuation">(</span>font_1<span class="token punctuation">)</span>    <span class="token comment"># 文件管理</span>    dataView_icon <span class="token operator">=</span> QtGui<span class="token punctuation">.</span>QIcon<span class="token punctuation">(</span><span class="token punctuation">)</span>    dataView_icon<span class="token punctuation">.</span>addPixmap<span class="token punctuation">(</span>QtGui<span class="token punctuation">.</span>QPixmap<span class="token punctuation">(</span><span class="token string">"./icons/dataView.png"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    QtGui<span class="token punctuation">.</span>QIcon<span class="token punctuation">.</span>Normal<span class="token punctuation">,</span> QtGui<span class="token punctuation">.</span>QIcon<span class="token punctuation">.</span>Off<span class="token punctuation">)</span>    self<span class="token punctuation">.</span>dataView_item <span class="token operator">=</span> QtWidgets<span class="token punctuation">.</span>QListWidgetItem<span class="token punctuation">(</span>dataView_icon<span class="token punctuation">,</span><span class="token string">'文件管理'</span><span class="token punctuation">,</span>self<span class="token punctuation">.</span>left_list_widget<span class="token punctuation">)</span>    self<span class="token punctuation">.</span>dataView_item<span class="token punctuation">.</span>setSizeHint<span class="token punctuation">(</span>QSize<span class="token punctuation">(</span><span class="token number">30</span><span class="token punctuation">,</span><span class="token number">60</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    self<span class="token punctuation">.</span>dataView_item<span class="token punctuation">.</span>setTextAlignment<span class="token punctuation">(</span>QtCore<span class="token punctuation">.</span>Qt<span class="token punctuation">.</span>AlignCenter<span class="token punctuation">)</span>    <span class="token comment"># 数据信息</span>    dataLog_icon <span class="token operator">=</span> QtGui<span class="token punctuation">.</span>QIcon<span class="token punctuation">(</span><span class="token punctuation">)</span>    dataLog_icon<span class="token punctuation">.</span>addPixmap<span class="token punctuation">(</span>QtGui<span class="token punctuation">.</span>QPixmap<span class="token punctuation">(</span><span class="token string">"./icons/dataLog.png"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    QtGui<span class="token punctuation">.</span>QIcon<span class="token punctuation">.</span>Normal<span class="token punctuation">,</span> QtGui<span class="token punctuation">.</span>QIcon<span class="token punctuation">.</span>Off<span class="token punctuation">)</span>    self<span class="token punctuation">.</span>dataLog_item <span class="token operator">=</span> QtWidgets<span class="token punctuation">.</span>QListWidgetItem<span class="token punctuation">(</span>dataLog_icon<span class="token punctuation">,</span><span class="token string">'数据信息'</span><span class="token punctuation">,</span>self<span class="token punctuation">.</span>left_list_widget<span class="token punctuation">)</span>    self<span class="token punctuation">.</span>dataLog_item<span class="token punctuation">.</span>setSizeHint<span class="token punctuation">(</span>QSize<span class="token punctuation">(</span><span class="token number">30</span><span class="token punctuation">,</span><span class="token number">60</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    self<span class="token punctuation">.</span>dataLog_item<span class="token punctuation">.</span>setTextAlignment<span class="token punctuation">(</span>QtCore<span class="token punctuation">.</span>Qt<span class="token punctuation">.</span>AlignCenter<span class="token punctuation">)</span>    <span class="token comment"># 图像参数</span>    param_icon <span class="token operator">=</span> QtGui<span class="token punctuation">.</span>QIcon<span class="token punctuation">(</span><span class="token punctuation">)</span>    param_icon<span class="token punctuation">.</span>addPixmap<span class="token punctuation">(</span>QtGui<span class="token punctuation">.</span>QPixmap<span class="token punctuation">(</span><span class="token string">"./icons/figureParam.png"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    QtGui<span class="token punctuation">.</span>QIcon<span class="token punctuation">.</span>Normal<span class="token punctuation">,</span> QtGui<span class="token punctuation">.</span>QIcon<span class="token punctuation">.</span>Off<span class="token punctuation">)</span>    self<span class="token punctuation">.</span>param_item <span class="token operator">=</span> QtWidgets<span class="token punctuation">.</span>QListWidgetItem<span class="token punctuation">(</span>param_icon<span class="token punctuation">,</span><span class="token string">'图像参数'</span><span class="token punctuation">,</span>self<span class="token punctuation">.</span>left_list_widget<span class="token punctuation">)</span>    self<span class="token punctuation">.</span>param_item<span class="token punctuation">.</span>setSizeHint<span class="token punctuation">(</span>QSize<span class="token punctuation">(</span><span class="token number">30</span><span class="token punctuation">,</span><span class="token number">60</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    self<span class="token punctuation">.</span>param_item<span class="token punctuation">.</span>setTextAlignment<span class="token punctuation">(</span>QtCore<span class="token punctuation">.</span>Qt<span class="token punctuation">.</span>AlignCenter<span class="token punctuation">)</span>    <span class="token comment"># 导出</span>    export_icon <span class="token operator">=</span> QtGui<span class="token punctuation">.</span>QIcon<span class="token punctuation">(</span><span class="token punctuation">)</span>    export_icon<span class="token punctuation">.</span>addPixmap<span class="token punctuation">(</span>QtGui<span class="token punctuation">.</span>QPixmap<span class="token punctuation">(</span><span class="token string">"./icons/save.png"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    QtGui<span class="token punctuation">.</span>QIcon<span class="token punctuation">.</span>Normal<span class="token punctuation">,</span> QtGui<span class="token punctuation">.</span>QIcon<span class="token punctuation">.</span>Off<span class="token punctuation">)</span>    self<span class="token punctuation">.</span>export_item <span class="token operator">=</span> QtWidgets<span class="token punctuation">.</span>QListWidgetItem<span class="token punctuation">(</span>export_icon<span class="token punctuation">,</span><span class="token string">'导出'</span><span class="token punctuation">,</span>self<span class="token punctuation">.</span>left_list_widget<span class="token punctuation">)</span>    self<span class="token punctuation">.</span>export_item<span class="token punctuation">.</span>setSizeHint<span class="token punctuation">(</span>QSize<span class="token punctuation">(</span><span class="token number">30</span><span class="token punctuation">,</span><span class="token number">60</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    self<span class="token punctuation">.</span>export_item<span class="token punctuation">.</span>setTextAlignment<span class="token punctuation">(</span>QtCore<span class="token punctuation">.</span>Qt<span class="token punctuation">.</span>AlignCenter<span class="token punctuation">)</span>    self<span class="token punctuation">.</span>export_item<span class="token punctuation">.</span>whatsThis<span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token comment"># 为listitem添加点击事件，切换stackedwidget页面</span>    self<span class="token punctuation">.</span>left_list_widget<span class="token punctuation">.</span>itemClicked<span class="token punctuation">.</span>connect<span class="token punctuation">(</span>self<span class="token punctuation">.</span>item_clicked<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="点击事件，实现窗口的切换"><a href="#点击事件，实现窗口的切换" class="headerlink" title="点击事件，实现窗口的切换"></a>点击事件，实现窗口的切换</h3><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">def</span> <span class="token function">item_clicked</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token comment"># 获取当前选中的item</span>    item <span class="token operator">=</span> self<span class="token punctuation">.</span>left_list_widget<span class="token punctuation">.</span>selectedItems<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>    <span class="token keyword">if</span> item<span class="token punctuation">.</span>text<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token string">'文件管理'</span><span class="token punctuation">:</span>        self<span class="token punctuation">.</span>switch_dataView<span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token keyword">elif</span> <span class="token punctuation">(</span>item<span class="token punctuation">.</span>text<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token string">'数据信息'</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        self<span class="token punctuation">.</span>switch_dataLog<span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token keyword">elif</span> item<span class="token punctuation">.</span>text<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token string">'图像参数'</span><span class="token punctuation">:</span>        self<span class="token punctuation">.</span>switch_paramWidget<span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token keyword">else</span><span class="token punctuation">:</span>        self<span class="token punctuation">.</span>switch_export<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="QSS美化"><a href="#QSS美化" class="headerlink" title="QSS美化"></a>QSS美化</h3><p>.qss文件：</p><pre class="line-numbers language-none"><code class="language-none">QListWidget, QListView, QTreeWidget, QTreeView {    outline: 0px;}QListWidget {    min-width: 120px;    max-width: 120px;    color: Black;    background: #F5F5F5;}QListWidget::Item:hover {background: rgb(255, 255, 255);    border-left: 5px solid rgb(112, 66, 219);}QListWidget::Item:selected {    background: lightGray;    border-left: 5px solid rgb(112, 66, 219);}HistoryPanel:hover {    background: rgb(52, 52, 52);}<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>]]></content>
      
      
      <categories>
          
          <category> PyQt </category>
          
      </categories>
      
      
        <tags>
            
            <tag> PyQt </tag>
            
            <tag> GUI </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>pyqy小记|生成gif并嵌入到GUI中</title>
      <link href="/2021/08/30/pyqy-compose-gif-to-gui/"/>
      <url>/2021/08/30/pyqy-compose-gif-to-gui/</url>
      
        <content type="html"><![CDATA[<h1 id="pyqy小记-生成gif并嵌入到GUI中"><a href="#pyqy小记-生成gif并嵌入到GUI中" class="headerlink" title="pyqy小记|生成gif并嵌入到GUI中"></a>pyqy小记|生成gif并嵌入到GUI中</h1><h2 id="生成gif，嵌入到标签QLabel中"><a href="#生成gif，嵌入到标签QLabel中" class="headerlink" title="生成gif，嵌入到标签QLabel中"></a>生成gif，嵌入到标签QLabel中</h2><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">def</span> <span class="token function">compose_gif</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token triple-quoted-string string">"""生成gif """</span>    jpgPath_List <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>    <span class="token comment"># 读取图片集</span>    jpgList <span class="token operator">=</span> os<span class="token punctuation">.</span>listdir<span class="token punctuation">(</span><span class="token string">"./temp save files"</span><span class="token punctuation">)</span>  <span class="token comment"># 参数是图片集存放的路径，返回该路径下的所有文件名</span>    <span class="token keyword">for</span> jpgName <span class="token keyword">in</span> jpgList<span class="token punctuation">:</span>        absolutePath <span class="token operator">=</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>join<span class="token punctuation">(</span><span class="token string">"./temp save files/"</span><span class="token punctuation">,</span> jpgName<span class="token punctuation">)</span>  <span class="token comment"># 拼接成绝对路径</span>        jpgPath_List<span class="token punctuation">.</span>append<span class="token punctuation">(</span>absolutePath<span class="token punctuation">)</span>    gif_images <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>    <span class="token comment"># 读取单个图片，将数据存入列表中</span>    <span class="token keyword">for</span> path <span class="token keyword">in</span> jpgPath_List<span class="token punctuation">:</span>        gif_images<span class="token punctuation">.</span>append<span class="token punctuation">(</span>imageio<span class="token punctuation">.</span>imread<span class="token punctuation">(</span>path<span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token comment">#保存为gif，fps=2</span>    imageio<span class="token punctuation">.</span>mimsave<span class="token punctuation">(</span><span class="token string">"./temp save files/test.gif"</span><span class="token punctuation">,</span> gif_images<span class="token punctuation">,</span> fps<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">)</span>    <span class="token comment"># 实例化QMovie</span>    self<span class="token punctuation">.</span>gif <span class="token operator">=</span> QMovie<span class="token punctuation">(</span><span class="token string">'./temp save files/test.gif'</span><span class="token punctuation">)</span>    <span class="token comment"># tabwidget增加一页</span>    gif_tab <span class="token operator">=</span> QtWidgets<span class="token punctuation">.</span>QWidget<span class="token punctuation">(</span><span class="token punctuation">)</span>    gif_tab<span class="token punctuation">.</span>setObjectName<span class="token punctuation">(</span><span class="token string">'gif_tab'</span><span class="token punctuation">)</span>    self<span class="token punctuation">.</span>tabWidget<span class="token punctuation">.</span>addTab<span class="token punctuation">(</span>gif_tab<span class="token punctuation">,</span> <span class="token string">'GIF'</span><span class="token punctuation">)</span>    gif_verticalLAYOUT <span class="token operator">=</span> QtWidgets<span class="token punctuation">.</span>QVBoxLayout<span class="token punctuation">(</span>gif_tab<span class="token punctuation">)</span>    <span class="token comment"># </span>    gif_verticalLAYOUT<span class="token punctuation">.</span>setObjectName<span class="token punctuation">(</span><span class="token string">'gif_verticalLAYOUT'</span><span class="token punctuation">)</span>    <span class="token comment"># 用gifLabel展示gif</span>    self<span class="token punctuation">.</span>gifLabel <span class="token operator">=</span> QtWidgets<span class="token punctuation">.</span>QLabel<span class="token punctuation">(</span>gif_tab<span class="token punctuation">)</span>    self<span class="token punctuation">.</span>gifLabel<span class="token punctuation">.</span>setObjectName<span class="token punctuation">(</span><span class="token string">'gifLabel'</span><span class="token punctuation">)</span>    gif_verticalLAYOUT<span class="token punctuation">.</span>addWidget<span class="token punctuation">(</span>self<span class="token punctuation">.</span>gifLabel<span class="token punctuation">)</span>    self<span class="token punctuation">.</span>tabWidget<span class="token punctuation">.</span>setCurrentWidget<span class="token punctuation">(</span>gif_tab<span class="token punctuation">)</span>  <span class="token comment"># 设置当前页为gif播放tab</span>    <span class="token comment"># 把gif嵌入到label</span>    self<span class="token punctuation">.</span>gifLabel<span class="token punctuation">.</span>setMovie<span class="token punctuation">(</span>self<span class="token punctuation">.</span>gif<span class="token punctuation">)</span>    self<span class="token punctuation">.</span>gif<span class="token punctuation">.</span>start<span class="token punctuation">(</span><span class="token punctuation">)</span>    self<span class="token punctuation">.</span>gifLabel<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="播放-暂停gif"><a href="#播放-暂停gif" class="headerlink" title="播放/暂停gif"></a>播放/暂停gif</h2><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">def</span> <span class="token function">pauseGif</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>self<span class="token punctuation">.</span>gif<span class="token punctuation">.</span>setPaused<span class="token punctuation">(</span><span class="token boolean">True</span><span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">playGif</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>self<span class="token punctuation">.</span>gif<span class="token punctuation">.</span>setPaused<span class="token punctuation">(</span><span class="token boolean">False</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>]]></content>
      
      
      
        <tags>
            
            <tag> PyQt </tag>
            
            <tag> GUI </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>🎃一个坏掉的番茄个人主页——魔改教程、遇坑总结</title>
      <link href="/2021/08/30/tomotoes_blog/"/>
      <url>/2021/08/30/tomotoes_blog/</url>
      
        <content type="html"><![CDATA[<h1 id="🎃一个坏掉的番茄个人主页——魔改教程、遇坑总结"><a href="#🎃一个坏掉的番茄个人主页——魔改教程、遇坑总结" class="headerlink" title="🎃一个坏掉的番茄个人主页——魔改教程、遇坑总结"></a>🎃一个坏掉的番茄个人主页——魔改教程、遇坑总结</h1><p><strong>主页模板地址</strong>：<code>https://github.com/Tomotoes/HomePage</code></p><p><strong>中文使用文档</strong>：<code>https://github.com/Tomotoes/HomePage/blob/master/README.zh_CN.md</code></p><p>配置步骤在作者的使用文档中写的以及非常详细了，我总结一下如何<strong>自定义</strong>。</p><h2 id="标题、文字、头像"><a href="#标题、文字、头像" class="headerlink" title="标题、文字、头像"></a>标题、文字、头像</h2><p>在<code>config.json</code></p><pre class="line-numbers language-json" data-language="json"><code class="language-json"><span class="token punctuation">{</span><span class="token property">"head"</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token property">"title"</span><span class="token operator">:</span> <span class="token string">"钟军的小黑板"</span><span class="token punctuation">,</span><span class="token property">"description"</span><span class="token operator">:</span> <span class="token string">"Author:Jlex Zhong,Category:Personal Blog"</span><span class="token punctuation">,</span><span class="token property">"favicon"</span><span class="token operator">:</span> <span class="token string">"favicon.ico"</span>  <span class="token comment">// 暂未找到网站图标的修改方法</span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token property">"intro"</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token property">"title"</span><span class="token operator">:</span> <span class="token string">"Jlex Zhong"</span><span class="token punctuation">,</span><span class="token property">"subtitle"</span><span class="token operator">:</span> <span class="token string">"Wellcome to my HomePage"</span><span class="token punctuation">,</span><span class="token property">"enter"</span><span class="token operator">:</span> <span class="token string">"enter"</span><span class="token punctuation">,</span><span class="token property">"supportAuthor"</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span><span class="token property">"background"</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token property">"main"</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token property">"name"</span><span class="token operator">:</span> <span class="token string">"Jlex Zhong"</span><span class="token punctuation">,</span><span class="token property">"signature"</span><span class="token operator">:</span> <span class="token string">"向日葵晚上在干啥呢？"</span><span class="token punctuation">,</span> <span class="token property">"avatar"</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token property">"link"</span><span class="token operator">:</span> <span class="token string">"assets/avatar.jpg"</span><span class="token punctuation">,</span> <span class="token comment">// 头像，将路径下的图片替换即可</span><span class="token property">"height"</span><span class="token operator">:</span> <span class="token string">"100"</span><span class="token punctuation">,</span><span class="token property">"width"</span><span class="token operator">:</span> <span class="token string">"100"</span><span class="token punctuation">}</span><span class="token punctuation">,</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="增加页面"><a href="#增加页面" class="headerlink" title="增加页面"></a>增加页面</h2><p>在<code>config.json</code>中</p><pre class="line-numbers language-none"><code class="language-none">"ul": {"first": {"href": "blog/","icon": "blog","text": "Blog"},"second": {"href": "blog/about/","icon": "guanyuwo","text": "About Me"},"third": {"href": "mailto:junzhong0917@163.com","icon": "email","text": "Email"},"fourth": {"href": "blog/about/",  //我添加的页面"icon": "AIRESEARCH","text": "AI Lab"},"five": {"href": "https://github.com/JlexZhong","icon": "github","text": "Github"}<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>在<code>src\components\main.pug</code></p><pre class="line-numbers language-pug" data-language="pug"><code class="language-pug"><span class="token tag">ul</span><span class="token tag">li</span><span class="token tag">a<span class="token attributes"><span class="token punctuation">(</span><span class="token attr-name">href</span><span class="token punctuation">=</span><span class="token attr-value"><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>first<span class="token punctuation">.</span>href<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span> aria<span class="token operator">-</span>label<span class="token operator">=</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>first<span class="token punctuation">.</span>text<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span></span><span class="token punctuation">)</span></span></span><span class="token tag">i<span class="token attributes"><span class="token punctuation">(</span><span class="token attr-name">class</span><span class="token punctuation">=</span><span class="token attr-value"><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">icon icon-</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>first<span class="token punctuation">.</span>icon<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span></span><span class="token punctuation">)</span></span></span><span class="token tag">span<span class="token attributes"><span class="token punctuation">(</span><span class="token attr-name">data-translate</span><span class="token punctuation">=</span><span class="token attr-value"><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>first<span class="token punctuation">.</span>text<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span></span><span class="token punctuation">)</span></span></span> <span class="token plain-text">#{first.text}</span><span class="token tag">li</span><span class="token tag">a<span class="token attributes"><span class="token punctuation">(</span><span class="token attr-name">href</span><span class="token punctuation">=</span><span class="token attr-value"><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>second<span class="token punctuation">.</span>href<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span> aria<span class="token operator">-</span>label<span class="token operator">=</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>second<span class="token punctuation">.</span>text<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span></span><span class="token punctuation">)</span></span></span><span class="token tag">i<span class="token attributes"><span class="token punctuation">(</span><span class="token attr-name">class</span><span class="token punctuation">=</span><span class="token attr-value"><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">icon icon-</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>second<span class="token punctuation">.</span>icon<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span></span><span class="token punctuation">)</span></span></span><span class="token tag">span<span class="token attributes"><span class="token punctuation">(</span><span class="token attr-name">data-translate</span><span class="token punctuation">=</span><span class="token attr-value"><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>second<span class="token punctuation">.</span>text<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span></span><span class="token punctuation">)</span></span></span> <span class="token plain-text">#{second.text}</span><span class="token tag">li</span><span class="token tag">a<span class="token attributes"><span class="token punctuation">(</span><span class="token attr-name">href</span><span class="token punctuation">=</span><span class="token attr-value"><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>third<span class="token punctuation">.</span>href<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span> aria<span class="token operator">-</span>label<span class="token operator">=</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>third<span class="token punctuation">.</span>text<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span> target<span class="token operator">=</span><span class="token string">"_blank"</span></span><span class="token punctuation">)</span></span></span><span class="token tag">i<span class="token attributes"><span class="token punctuation">(</span><span class="token attr-name">class</span><span class="token punctuation">=</span><span class="token attr-value"><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">icon icon-</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>third<span class="token punctuation">.</span>icon<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span></span><span class="token punctuation">)</span></span></span><span class="token tag">span<span class="token attributes"><span class="token punctuation">(</span><span class="token attr-name">data-translate</span><span class="token punctuation">=</span><span class="token attr-value"><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>third<span class="token punctuation">.</span>text<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span></span><span class="token punctuation">)</span></span></span> <span class="token plain-text">#{third.text}</span><span class="token tag">li</span><span class="token tag">a<span class="token attributes"><span class="token punctuation">(</span><span class="token attr-name">href</span><span class="token punctuation">=</span><span class="token attr-value"><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>fourth<span class="token punctuation">.</span>href<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span> aria<span class="token operator">-</span>label<span class="token operator">=</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>fourth<span class="token punctuation">.</span>text<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span> target<span class="token operator">=</span><span class="token string">"_blank"</span></span><span class="token punctuation">)</span></span></span><span class="token tag">i<span class="token attributes"><span class="token punctuation">(</span><span class="token attr-name">class</span><span class="token punctuation">=</span><span class="token attr-value"><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">icon icon-</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>fourth<span class="token punctuation">.</span>icon<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span></span><span class="token punctuation">)</span></span></span><span class="token tag">span<span class="token attributes"><span class="token punctuation">(</span><span class="token attr-name">data-translate</span><span class="token punctuation">=</span><span class="token attr-value"><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>fourth<span class="token punctuation">.</span>text<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span></span><span class="token punctuation">)</span></span></span> <span class="token plain-text">#{fourth.text}</span><span class="token tag">li</span><span class="token tag">a<span class="token attributes"><span class="token punctuation">(</span><span class="token attr-name">href</span><span class="token punctuation">=</span><span class="token attr-value"><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>five<span class="token punctuation">.</span>href<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span> aria<span class="token operator">-</span>label<span class="token operator">=</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>five<span class="token punctuation">.</span>text<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span> target<span class="token operator">=</span><span class="token string">"_blank"</span></span><span class="token punctuation">)</span></span></span><span class="token tag">i<span class="token attributes"><span class="token punctuation">(</span><span class="token attr-name">class</span><span class="token punctuation">=</span><span class="token attr-value"><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">icon icon-</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>five<span class="token punctuation">.</span>icon<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span></span><span class="token punctuation">)</span></span></span><span class="token tag">span<span class="token attributes"><span class="token punctuation">(</span><span class="token attr-name">data-translate</span><span class="token punctuation">=</span><span class="token attr-value"><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>five<span class="token punctuation">.</span>text<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span></span><span class="token punctuation">)</span></span></span> <span class="token plain-text">#{five.text}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="更换图标"><a href="#更换图标" class="headerlink" title="更换图标"></a>更换图标</h2><ol><li>到阿里矢量图标网站中找到自己的图标，并添加到一个项目中。<a href="https://www.iconfont.cn/">https://www.iconfont.cn/</a></li><li>把图标调成白色</li><li>进入项目设置，把这些勾选上</li><li><img src="https://cdn.jsdelivr.net/gh/JlexZhong/J.CS-note@main/tomotoes_blog.assets/setting.png"></li><li>点击Font Class, 查看在线链接，点击该链接</li><li><img src="https://cdn.jsdelivr.net/gh/JlexZhong/J.CS-note@main/tomotoes_blog.assets/iconfont.png"></li><li>复制链接中的所有内容，除了以下部分，其余全部替换掉。</li></ol><pre class="line-numbers language-none"><code class="language-none">.icon {display: block;width: 1.5em;height: 1.5em;margin: 0 auto;fill: currentColor;font-family: 'iconfont' !important;font-size: inherit;font-style: normal;-webkit-font-smoothing: antialiased;-moz-osx-font-smoothing: grayscale;}<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>最后去<code>config.json</code>中修改图标的名称，不用加<code>icon-</code>。</p>]]></content>
      
      
      <categories>
          
          <category> hexo </category>
          
      </categories>
      
      
        <tags>
            
            <tag> hexo </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>pyqt小记|matplotlib嵌入pyqt界面|添加工具条 | matplotlib保存太慢解决方法</title>
      <link href="/2021/08/29/pyqt-matplotlib-to-pyqt-add-toolbar-matplotlib-save-too-slowly/"/>
      <url>/2021/08/29/pyqt-matplotlib-to-pyqt-add-toolbar-matplotlib-save-too-slowly/</url>
      
        <content type="html"><![CDATA[<h1 id="pyqt小记-matplotlib嵌入pyqt界面-添加工具条-matplotlib保存太慢解决方法"><a href="#pyqt小记-matplotlib嵌入pyqt界面-添加工具条-matplotlib保存太慢解决方法" class="headerlink" title="pyqt小记|matplotlib嵌入pyqt界面|添加工具条 | matplotlib保存太慢解决方法"></a>pyqt小记|matplotlib嵌入pyqt界面|添加工具条 | matplotlib保存太慢解决方法</h1><p>上源码：</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> PyQt5 <span class="token keyword">import</span> QtWidgets<span class="token keyword">from</span> matplotlib<span class="token punctuation">.</span>figure <span class="token keyword">import</span> Figure<span class="token keyword">from</span> matplotlib<span class="token punctuation">.</span>backends<span class="token punctuation">.</span>backend_qt5 <span class="token keyword">import</span> NavigationToolbar2QT <span class="token keyword">as</span> NavigationToolbar<span class="token keyword">from</span> matplotlib<span class="token punctuation">.</span>backends<span class="token punctuation">.</span>backend_qt5agg <span class="token keyword">import</span> FigureCanvasQTAgg  <span class="token comment"># pyqt5的画布</span><span class="token keyword">import</span> io<span class="token keyword">import</span> cv2<span class="token keyword">import</span> matplotlib<span class="token keyword">import</span> numpy <span class="token keyword">as</span> np<span class="token keyword">from</span> PIL <span class="token keyword">import</span> Image<span class="token keyword">from</span> PyQt5<span class="token punctuation">.</span>QtWidgets <span class="token keyword">import</span> QWidgetmatplotlib<span class="token punctuation">.</span>use<span class="token punctuation">(</span><span class="token string">"Qt5Agg"</span><span class="token punctuation">)</span>  <span class="token comment"># 声明使用pyqt5</span><span class="token keyword">class</span> <span class="token class-name">MatplotlibFigure</span><span class="token punctuation">(</span>FigureCanvasQTAgg<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token triple-quoted-string string">"""    创建一个画布类，并把画布放到FigureCanvasQTAgg    """</span>    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> parent<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span> filePrefix<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token triple-quoted-string string">"""                :param parent:        :param filePrefix:        """</span>        self<span class="token punctuation">.</span>figs <span class="token operator">=</span> Figure<span class="token punctuation">(</span>figsize<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">,</span> dpi<span class="token operator">=</span><span class="token number">200</span><span class="token punctuation">)</span>        <span class="token builtin">super</span><span class="token punctuation">(</span>MatplotlibFigure<span class="token punctuation">,</span> self<span class="token punctuation">)</span><span class="token punctuation">.</span>__init__<span class="token punctuation">(</span>self<span class="token punctuation">.</span>figs<span class="token punctuation">)</span>  <span class="token comment"># 在父类中激活self.fig</span>        self<span class="token punctuation">.</span>setParent<span class="token punctuation">(</span>parent<span class="token punctuation">)</span>        self<span class="token punctuation">.</span>filePrefix <span class="token operator">=</span> filePrefix        self<span class="token punctuation">.</span>axes <span class="token operator">=</span> self<span class="token punctuation">.</span>figs<span class="token punctuation">.</span>add_subplot<span class="token punctuation">(</span><span class="token number">111</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>axes<span class="token punctuation">.</span>patch<span class="token punctuation">.</span>set_alpha<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>  <span class="token comment"># 设置ax区域背景颜色透明度</span>        <span class="token comment"># self.figs.canvas.setStyleSheet("background-color:transparent;")</span>        FigureCanvasQTAgg<span class="token punctuation">.</span>setSizePolicy<span class="token punctuation">(</span>            self<span class="token punctuation">,</span> QtWidgets<span class="token punctuation">.</span>QSizePolicy<span class="token punctuation">.</span>Expanding<span class="token punctuation">,</span> QtWidgets<span class="token punctuation">.</span>QSizePolicy<span class="token punctuation">.</span>Expanding<span class="token punctuation">)</span>        <span class="token comment"># 用于告知包含该widget的layout：该widget的size hint已发生变化，layout会自动进行调整。</span>        FigureCanvasQTAgg<span class="token punctuation">.</span>updateGeometry<span class="token punctuation">(</span>self<span class="token punctuation">)</span>    <span class="token keyword">def</span> <span class="token function">saveFig</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token triple-quoted-string string">"""        保存图片，使用二进制字节流存储，opencv读取。速度优秀        """</span>        <span class="token builtin">buffer</span> <span class="token operator">=</span> io<span class="token punctuation">.</span>BytesIO<span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment"># 字节流对象</span>        self<span class="token punctuation">.</span>figs<span class="token punctuation">.</span>canvas<span class="token punctuation">.</span>print_png<span class="token punctuation">(</span><span class="token builtin">buffer</span><span class="token punctuation">)</span>  <span class="token comment"># 把画布写入字节流</span>        data <span class="token operator">=</span> <span class="token builtin">buffer</span><span class="token punctuation">.</span>getvalue<span class="token punctuation">(</span><span class="token punctuation">)</span>        <span class="token builtin">buffer</span><span class="token punctuation">.</span>write<span class="token punctuation">(</span>data<span class="token punctuation">)</span>        img <span class="token operator">=</span> Image<span class="token punctuation">.</span><span class="token builtin">open</span><span class="token punctuation">(</span><span class="token builtin">buffer</span><span class="token punctuation">)</span>        img <span class="token operator">=</span> np<span class="token punctuation">.</span>asarray<span class="token punctuation">(</span>img<span class="token punctuation">)</span>        img <span class="token operator">=</span> cv2<span class="token punctuation">.</span>cvtColor<span class="token punctuation">(</span>img<span class="token punctuation">,</span> cv2<span class="token punctuation">.</span>COLOR_BGR2RGB<span class="token punctuation">)</span>        cv2<span class="token punctuation">.</span>imwrite<span class="token punctuation">(</span><span class="token string">"./temp save files/"</span> <span class="token operator">+</span> self<span class="token punctuation">.</span>filePrefix <span class="token operator">+</span> <span class="token string">".png"</span><span class="token punctuation">,</span> img<span class="token punctuation">)</span>    <span class="token keyword">def</span> <span class="token function">saveFig2</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token triple-quoted-string string">"""        FIXME:需要优化保存图片的速度        """</span>        self<span class="token punctuation">.</span>figs<span class="token punctuation">.</span>savefig<span class="token punctuation">(</span><span class="token string">"./temp save files/"</span> <span class="token operator">+</span> self<span class="token punctuation">.</span>filePrefix <span class="token operator">+</span>                          <span class="token string">".jpg"</span><span class="token punctuation">,</span> dpi<span class="token operator">=</span><span class="token number">144</span><span class="token punctuation">,</span> bbox_inches<span class="token operator">=</span><span class="token string">"tight"</span><span class="token punctuation">)</span><span class="token keyword">class</span> <span class="token class-name">MplWidget</span><span class="token punctuation">(</span>QWidget<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token triple-quoted-string string">"""Qt控件，用于嵌入matplotlib画布和工具栏    Args:        QWidget ([type]): [description]    """</span>    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> parent<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span> filePrefix<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token triple-quoted-string string">"""        :param parent:        """</span>               QWidget<span class="token punctuation">.</span>__init__<span class="token punctuation">(</span>self<span class="token punctuation">,</span> parent<span class="token punctuation">)</span>        self<span class="token punctuation">.</span>qCanvas <span class="token operator">=</span> MatplotlibFigure<span class="token punctuation">(</span>parent<span class="token punctuation">,</span> filePrefix<span class="token punctuation">)</span>        self<span class="token punctuation">.</span>mpl_toolbar <span class="token operator">=</span> NavigationToolbar<span class="token punctuation">(</span>self<span class="token punctuation">.</span>qCanvas<span class="token punctuation">,</span> self<span class="token punctuation">)</span>  <span class="token comment"># 创建工具条</span>        <span class="token comment"># 创建布局，把画布类组件对象和工具条对象添加到QWidget控件中</span>        self<span class="token punctuation">.</span>vbl <span class="token operator">=</span> QtWidgets<span class="token punctuation">.</span>QVBoxLayout<span class="token punctuation">(</span>self<span class="token punctuation">)</span>        self<span class="token punctuation">.</span>vbl<span class="token punctuation">.</span>addWidget<span class="token punctuation">(</span>self<span class="token punctuation">.</span>qCanvas<span class="token punctuation">)</span>        self<span class="token punctuation">.</span>vbl<span class="token punctuation">.</span>addWidget<span class="token punctuation">(</span>self<span class="token punctuation">.</span>mpl_toolbar<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>]]></content>
      
      
      <categories>
          
          <category> PyQt </category>
          
      </categories>
      
      
        <tags>
            
            <tag> PyQt </tag>
            
            <tag> GUI </tag>
            
            <tag> matplotlib </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>HTML学习笔记</title>
      <link href="/2021/08/29/HTML-note/"/>
      <url>/2021/08/29/HTML-note/</url>
      
        <content type="html"><![CDATA[<h1 id="HTML-学习笔记"><a href="#HTML-学习笔记" class="headerlink" title="HTML 学习笔记"></a>HTML 学习笔记</h1><h2 id="lt-li-gt"><a href="#lt-li-gt" class="headerlink" title="<li>"></a>&lt;li&gt;</h2><p>定义列表。</p><p>“</p><ol>“：有序列表；</ol><p></p><p>“</p><ul>“：无序列表。</ul><p></p><h2 id="lt-a-gt"><a href="#lt-a-gt" class="headerlink" title="<a>"></a>&lt;a&gt;</h2><p>定义超链接</p><h2 id="id-name-class的理解"><a href="#id-name-class的理解" class="headerlink" title="id,name,class的理解"></a>id,name,class的理解</h2><ul><li><p>id、name、class属性是什么？</p><ul><li>id是html页面中元素的唯一标示，属性值在页面中不能重复，每个元素的id不同，可以设置也可以不设置；</li><li>name属性值可以重复，指的是标签的名称；</li><li>class可简单的理解为类属性，属性值在页面中不唯一；</li></ul></li><li><p>id、name、class的用途</p><ul><li><p>id是标签的唯一标识，多用于<strong>js脚本</strong>中，比如页面中有多个元素，让我们想在js脚本中对某个特定元素进行设置的时候，我们可以根据id来直接访问该元素。<br>同时，id也可用于<strong>css样式</strong>中，当我们想对某个单独的元素做出改变样式时候可以进行设置，使用  <code>#元素id{ }</code> 方式来改变样式</p></li><li><p>name多用于<strong>表单</strong>中，用来和服务器进行交互，如CheckBox标签和radio标签等，对应的name属性的值就是提交表单后变量的名称。</p></li><li><p>class多用于设置<strong>CSS样式</strong> ，当我们想让很多元素拥有相同的样式时，可以通过class属性的值来统一选择，通常为 <code>.class的属性{} </code> 设置css样式做法一般是先通过类设置大部分相同的元素样式，再通过ID设置独特的元素样式。</p></li></ul></li></ul><h2 id="lt-a-gt-中的-target-”-blank”属性"><a href="#lt-a-gt-中的-target-”-blank”属性" class="headerlink" title="<a>中的 target=”_blank”属性"></a>&lt;a&gt;中的 target=”_blank”属性</h2><ul><li>_blank – 在新窗口中打开链接</li><li>_parent – 在父窗体中打开链接</li><li>_self – 在当前窗体打开链接,此为<strong>默认值</strong></li><li>_top – 在当前窗体打开链接，并替换当前的整个窗体(框架页)</li><li>一个对应的框架页的名称 – 在对应框架页中打开</li></ul><h2 id="data-aoc"><a href="#data-aoc" class="headerlink" title="data-aoc"></a>data-aoc</h2><pre class="line-numbers language-none"><code class="language-none">&lt;div data-aos="fade-up"&gt;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>平滑上升效果</p><h2 id="BUG：Uncaught-ReferenceError-is-not-defined"><a href="#BUG：Uncaught-ReferenceError-is-not-defined" class="headerlink" title="BUG：Uncaught ReferenceError: $ is not defined"></a><u>BUG</u>：Uncaught ReferenceError: $ is not defined</h2><p>使用CDN地址引用jQuery</p><pre class="line-numbers language-none"><code class="language-none">&lt;script src="https://apps.bdimg.com/libs/jquery/2.1.4/jquery.min.js"&gt;&lt;/script&gt;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h2 id="HTML中返回上级目录的写法"><a href="#HTML中返回上级目录的写法" class="headerlink" title="HTML中返回上级目录的写法"></a>HTML中返回上级目录的写法</h2><p>当前目录：<code>https://jlexzhong.github.io/blog/</code></p><p>返回上级应该为：<code>href="../index.html"</code></p><p><a href="https://www.cnblogs.com/kenshinobiy/p/7783135.html">https://www.cnblogs.com/kenshinobiy/p/7783135.html</a></p>]]></content>
      
      
      <categories>
          
          <category> HTML </category>
          
      </categories>
      
      
        <tags>
            
            <tag> HTML </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>pyqt小记|窗口阴影、透明、无边框</title>
      <link href="/2021/08/27/pyqt-shadow-frameless/"/>
      <url>/2021/08/27/pyqt-shadow-frameless/</url>
      
        <content type="html"><![CDATA[<h1 id="pyqt小记-窗口阴影、透明、无边框"><a href="#pyqt小记-窗口阴影、透明、无边框" class="headerlink" title="pyqt小记|窗口阴影、透明、无边框"></a>pyqt小记|窗口阴影、透明、无边框</h1><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># 设置无边框圆角带阴影窗口</span>self<span class="token punctuation">.</span>MainWindow<span class="token punctuation">.</span>setWindowFlag<span class="token punctuation">(</span>QtCore<span class="token punctuation">.</span>Qt<span class="token punctuation">.</span>FramelessWindowHint<span class="token punctuation">)</span>  <span class="token comment"># 无边框</span><span class="token comment"># ===============透明阴影====================</span>self<span class="token punctuation">.</span>MainWindow<span class="token punctuation">.</span>setAutoFillBackground<span class="token punctuation">(</span><span class="token boolean">True</span><span class="token punctuation">)</span> <span class="token comment">#一定要加上</span>self<span class="token punctuation">.</span>MainWindow<span class="token punctuation">.</span>setAttribute<span class="token punctuation">(</span>QtCore<span class="token punctuation">.</span>Qt<span class="token punctuation">.</span>WA_TranslucentBackground<span class="token punctuation">)</span>  <span class="token comment"># 窗口透明</span>shadow<span class="token operator">=</span>QGraphicsDropShadowEffect<span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment"># 创建阴影</span>shadow<span class="token punctuation">.</span>setBlurRadius<span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span>  <span class="token comment"># 设置阴影大小为9px</span>shadow<span class="token punctuation">.</span>setColor<span class="token punctuation">(</span>QColor<span class="token punctuation">(</span><span class="token string">"#444444"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment"># 设置颜色透明度为100的（0,0,0）黑色</span>shadow<span class="token punctuation">.</span>setOffset<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span>  <span class="token comment"># 阴影偏移距离为0px</span>self<span class="token punctuation">.</span>MainWindow<span class="token punctuation">.</span>setGraphicsEffect<span class="token punctuation">(</span>shadow<span class="token punctuation">)</span>  <span class="token comment"># 添加阴影</span>self<span class="token punctuation">.</span>MainWindow<span class="token punctuation">.</span>resize<span class="token punctuation">(</span><span class="token number">1600</span><span class="token punctuation">,</span> <span class="token number">900</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>]]></content>
      
      
      <categories>
          
          <category> PyQt </category>
          
      </categories>
      
      
        <tags>
            
            <tag> PyQt </tag>
            
            <tag> GUI </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Hexo+Github+matery免费搭建个人博客教程</title>
      <link href="/2021/08/23/Building-a-Blog/"/>
      <url>/2021/08/23/Building-a-Blog/</url>
      
        <content type="html"><![CDATA[<h1 id="Hexo-Github免费搭建个人博客详细教程"><a href="#Hexo-Github免费搭建个人博客详细教程" class="headerlink" title="Hexo+Github免费搭建个人博客详细教程"></a>Hexo+Github免费搭建个人博客详细教程</h1><h2 id="效果图"><a href="#效果图" class="headerlink" title="效果图"></a>效果图</h2><p><img src="https://cdn.jsdelivr.net/gh/JlexZhong/J.CS-note@main/Building-a-Blog.asserts/1.png"></p><p><img src="https://cdn.jsdelivr.net/gh/JlexZhong/J.CS-note@main/Building-a-Blog.asserts/2.png"></p><p><img src="https://cdn.jsdelivr.net/gh/JlexZhong/J.CS-note@main/Building-a-Blog.asserts/3.png"></p><h2 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h2><h3 id="安装Node-js"><a href="#安装Node-js" class="headerlink" title="安装Node.js"></a>安装Node.js</h3><p>安装<strong>Node.js</strong>，一直默认。输入：（查看是否安装正确）</p><ul><li><p>```<br>node -v</p><pre class="line-numbers language-none"><code class="language-none">- 添加环境变量：**C:\Program Files\nodejs\ **- 环境变量：**C:\Users\26780\AppData\Roaming\npm**### 配置npm查看**npm**是否安装成功：<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>npm -v</p><pre class="line-numbers language-none"><code class="language-none">- 出现**BUG**：<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>npm install出现一直停留在“fetchMetadata: sill resolveWithNewModule find-cache-dir@“</p><pre class="line-numbers language-none"><code class="language-none">- 解决：更换国内镜像源<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>更换成淘宝的源<br>npm config set registry <a href="https://registry.npm.taobao.org/">https://registry.npm.taobao.org</a><br>– 配置后可通过下面方式来验证是否成功<br>npm config get registry<br>– 或npm info express</p><pre class="line-numbers language-none"><code class="language-none">### 安装**hexo**<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>npm config set registry <a href="https://registry.npm.taobao.org/">https://registry.npm.taobao.org</a><br>npm install -g hexo-cli</p><pre class="line-numbers language-none"><code class="language-none">- 若出现warning，这是募捐提示，忽略即可- ```  run `npm fund` for details<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre></li><li><p>如果不想看到，输入命令：</p></li><li><p>```<br>npm install –no-fund</p><pre class="line-numbers language-none"><code class="language-none">### 安装git**Github**安装，教程网上很多请自行寻找，并配置好**SSH-Key**## Hexo搭建1. 建立空文件夹，我的是Blog，将来会在这个文件夹内存放与博客有关的内容2. 打开GIt Bash 或者命令行，输入：<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p> hexo init</p> <pre class="line-numbers language-none"><code class="language-none">3. 文件夹内会出现一些配置文件   - `node_modules:` 依赖包   - `public：`存放生成的页面   - `scaffolds：`生成文章的一些模板   - `source：`用来存放你的文章   - `themes：`**主题**   - `_config.yml:` 博客的**配置文件**4. 执行：<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p> hexo new hello Hexo    //新建一篇名为”hello Hexo”的博客<br> hexo g                 //生成静态文件<br> hexo s                 //本地部署预览</p> <pre class="line-numbers language-none"><code class="language-none">5. 会输出：<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p> INFO  Hexo is running at <a href="http://localhost:4000/">http://localhost:4000</a> . Press Ctrl+C to stop.</p> <pre class="line-numbers language-none"><code class="language-none">可能会出现加载不了的情况，因为4000端口太常用了，导致冲突。使用：<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p> hexo server -p 5000 //更改端口</p> <pre class="line-numbers language-none"><code class="language-none">6. **hexo常用命令**（参考：https://blog.csdn.net/weixin_42334475/article/details/101055364?utm_medium=distribute.pc_relevant.none-task-blog-2%7Edefault%7EBlogCommendFromBaidu%7Edefault-5.control&amp;depth_1-utm_source=distribute.pc_relevant.none-task-blog-2%7Edefault%7EBlogCommendFromBaidu%7Edefault-5.control）   - 初始化<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p>   npm install hexo -g //安装Hexo<br>   npm update hexo -g //升级<br>   hexo init //初始化博客</p>   <pre class="line-numbers language-none"><code class="language-none">- 命令简写<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>   hexo n “我的博客” = hexo new “我的博客” //新建文章<br>   hexo g = hexo generate //生成<br>   hexo s = hexo server //启动服务预览<br>   hexo d = hexo deploy //部署</p>   <pre class="line-numbers language-none"><code class="language-none">- 其他<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>   hexo server //Hexo会监视文件变动并自动更新，无须重启服务器<br>   hexo server -s //静态模式<br>   hexo server -p 5000 //更改端口<br>   hexo server -i 192.168.1.1 //自定义 IP<br>   hexo clean //清除缓存，若是网页正常情况下可以忽略这条命令</p>   <pre class="line-numbers language-none"><code class="language-none">## 推送网站1. 修改Blog文件夹下的**_config.yml**，在末尾修改成如下格式：<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><h1 id="Deployment"><a href="#Deployment" class="headerlink" title="Deployment"></a>Deployment</h1><h2 id="Docs-https-hexo-io-docs-one-command-deployment"><a href="#Docs-https-hexo-io-docs-one-command-deployment" class="headerlink" title="Docs: https://hexo.io/docs/one-command-deployment"></a>Docs: <a href="https://hexo.io/docs/one-command-deployment">https://hexo.io/docs/one-command-deployment</a></h2><p> deploy:<br>   type: git<br>   repo: <a href="https://github.com/JlexZhong/JlexZhong.github.io.git">https://github.com/JlexZhong/JlexZhong.github.io.git</a><br>   branch: main</p> <pre class="line-numbers language-none"><code class="language-none">   repo后的地址就是博客仓库的https地址2. 安装git部署插件：<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p> npm install hexo-deployer-git –save</p> <pre class="line-numbers language-none"><code class="language-none">3. 然后输入命令：<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p> hexo clean //清理静态文件<br> hexo g //生成静态文件<br> hexo d //部署</p> <pre class="line-numbers language-none"><code class="language-none">4. 出现**bug**：<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p> remote: Permission to JlexZhong/JlexZhong.github.io.git denied to junz2001.<br> fatal: unable to access ‘<a href="https://github.com/JlexZhong/JlexZhong.github.io.git/'">https://github.com/JlexZhong/JlexZhong.github.io.git/'</a>: The requested URL returned error: 403<br> [41mFATAL[49m {<br>   err: Error: Spawn failed</p><pre><code>   at ChildProcess.&lt;anonymous&gt; (E:\Blog\node_modules\hexo-util\lib\spawn.js:51:21)   at ChildProcess.emit (events.js:400:28)   at ChildProcess.cp.emit (E:\Blog\node_modules\cross-spawn\lib\enoent.js:34:29)   at Process.ChildProcess._handle.onexit (internal/child_process.js:277:12) { code: 128</code></pre><p>   }<br> } Something’s wrong. Maybe you can find the solution here: %s [4m<a href="https://hexo.io/docs/troubleshooting.html%1B[24m">https://hexo.io/docs/troubleshooting.html[24m</a></p> <pre class="line-numbers language-none"><code class="language-none">   解决：   - 如果不是代理问题，在_config.yml文件中把repo：后的地址改为git@github.com:JlexZhong/JlexZhong.github.io.git   - 是代理问题，清除代理5. 此时博客已经上线啦！可以通过网络访问了。浏览器输入博客网站地址**xxxx.github.io**6. **修改域名**：   现在你的个人网站的地址是`yourname.github.io`，如果觉得这个网址逼格不太够，这就需要你设置个人域名了。但是需要花钱。   &gt; 我没有选择购买域名，等后期再来更新吧### 发布博客：- 先`hexo new post "article title"`新建一篇文章，- 在博客文件夹，`Blog/source/_posts`目录下回多出一个Markdown文件，编写完markdown文件后，保存- 根目录下输入`hexo g`生成静态网页- 然后输入`hexo s`可以本地预览效果- 最后输入`hexo d`上传到`github`上### `_config.yml`**文件的修改建议**：- 请修改 `_config.yml` 的 `url` 的值为你的网站主 `URL`（如：`http://xxx.github.io`）。- 建议修改两个 `per_page` 的分页条数值为 `6` 的倍数，如：`12`、`18` 等，这样文章列表在各个屏幕下都能较好的显示。- 如果你是中文用户，则建议修改 `language` 的值为 `zh-CN`。- `subtitle`选项：在我使用的主题当中即为网页首页中间的字体块，若为空将显示为**subtitle**- `post_asset_folder`选项设置为：true。当该配置被应用后，使用hexo new命令创建新文章时，会生成相同名字的文件夹，也就是文章资源文件夹。## 文章Front-matter`Front-matter` 是`md`文件最上方以 `---`分隔的区域，用于指定个别文件的变量.`Front-matter` 选项中的所有内容均为**非必填**的。但我仍然建议至少填写 `title` 和 `date` 的值。### 选项详解| 配置选项      | 默认值                         | 描述                                                         || ------------- | ------------------------------ | ------------------------------------------------------------ || title         | `Markdown` 的文件标题          | 文章标题，强烈建议填写此选项                                 || date          | 文件创建时的日期时间           | 发布时间，强烈建议填写此选项，且最好保证全局唯一             || author        | 根 `_config.yml` 中的 `author` | 文章作者                                                     || img           | `featureImages` 中的某个值     | 文章特征图，推荐使用图床(腾讯云、七牛云、又拍云等)来做图片的路径.如: `http://xxx.com/xxx.jpg` || top           | `true`                         | 推荐文章（文章是否置顶），如果 `top` 值为 `true`，则会作为首页推荐文章 || hide          | `false`                        | 隐藏文章，如果`hide`值为`true`，则文章不会在首页显示         || cover         | `false`                        | `v1.0.2`版本新增，表示该文章是否需要加入到首页轮播封面中     || coverImg      | 无                             | `v1.0.2`版本新增，表示该文章在首页轮播封面需要显示的图片路径，如果没有，则默认使用文章的特色图片 || password      | 无                             | 文章阅读密码，如果要对文章设置阅读验证密码的话，就可以设置 `password` 的值，该值必须是用 `SHA256` 加密后的密码，防止被他人识破。前提是在主题的 `config.yml` 中激活了 `verifyPassword` 选项 || toc           | `true`                         | 是否开启 TOC，可以针对某篇文章单独关闭 TOC 的功能。前提是在主题的 `config.yml` 中激活了 `toc` 选项 || mathjax       | `false`                        | 是否开启数学公式支持 ，本文章是否开启 `mathjax`，且需要在主题的 `_config.yml` 文件中也需要开启才行 || summary       | 无                             | 文章摘要，自定义的文章摘要内容，如果这个属性有值，文章卡片摘要就显示这段文字，否则程序会自动截取文章的部分内容作为摘要 || categories    | 无                             | 文章分类，本主题的分类表示宏观上大的分类，只建议一篇文章一个分类 || tags          | 无                             | 文章标签，一篇文章可以多个标签                               || keywords      | 文章标题                       | 文章关键字，SEO 时需要                                       || reprintPolicy | cc_by                          | 文章转载规则， 可以是 cc_by, cc_by_nd, cc_by_sa, cc_by_nc, cc_by_nc_nd, cc_by_nc_sa, cc0, noreprint 或 pay 中的一个 |&gt; **注意**:&gt;&gt; 1. 如果 `img` 属性不填写的话，文章特色图会根据文章标题的 `hashcode` 的值取余，然后选取主题中对应的特色图片，从而达到让所有文章的特色图**各有特色**。&gt; 2. `date` 的值尽量保证每篇文章是唯一的，因为本主题中 `Gitalk` 和 `Gitment` 识别 `id` 是通过 `date` 的值来作为唯一标识的。&gt; 3. 如果要对文章设置阅读验证密码的功能，不仅要在 Front-matter 中设置采用了 SHA256 加密的 password 的值，还需要在主题的 `_config.yml` 中激活了配置。有些在线的 SHA256 加密的地址，可供你使用：[开源中国在线工具](http://tool.oschina.net/encrypt?type=2)、[chahuo](http://encode.chahuo.com/)、[站长工具](http://tool.chinaz.com/tools/hash.aspx)。&gt; 4. 您可以在文章md文件的 front-matter 中指定 reprintPolicy 来给单个文章配置转载规则以下为文章的 `Front-matter` 示例。### 最简示例```yaml---title: typora-vue-theme主题介绍date: 2018-09-07 09:25:00---<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></li></ul><h3 id="最全示例"><a href="#最全示例" class="headerlink" title="最全示例"></a>最全示例</h3><pre class="line-numbers language-yaml" data-language="yaml"><code class="language-yaml"><span class="token punctuation">---</span><span class="token key atrule">title</span><span class="token punctuation">:</span> 我的第一篇博客<span class="token key atrule">date</span><span class="token punctuation">:</span> <span class="token datetime number">2021-08-24 09:25:00</span><span class="token key atrule">author</span><span class="token punctuation">:</span> 钟军<span class="token key atrule">img</span><span class="token punctuation">:</span> /source/images/xxx.jpg<span class="token key atrule">top</span><span class="token punctuation">:</span> <span class="token boolean important">true</span><span class="token key atrule">hide</span><span class="token punctuation">:</span> <span class="token boolean important">false</span><span class="token key atrule">cover</span><span class="token punctuation">:</span> <span class="token boolean important">true</span><span class="token key atrule">coverImg</span><span class="token punctuation">:</span> /images/1.jpg<span class="token key atrule">password</span><span class="token punctuation">:</span> 8d969eef6ecad3c29a3a629280e686cf0c3f5d5a86aff3ca12020c923adc6c92<span class="token key atrule">toc</span><span class="token punctuation">:</span> <span class="token boolean important">false</span><span class="token key atrule">mathjax</span><span class="token punctuation">:</span> <span class="token boolean important">false</span><span class="token key atrule">summary</span><span class="token punctuation">:</span> 这是你自定义的文章摘要内容，如果这个属性有值，文章卡片摘要就显示这段文字，否则程序会自动截取文章的部分内容作为摘要<span class="token key atrule">categories</span><span class="token punctuation">:</span> Markdown<span class="token key atrule">tags</span><span class="token punctuation">:</span>  <span class="token punctuation">-</span> Typora  <span class="token punctuation">-</span> Markdown<span class="token punctuation">---</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="主题美化"><a href="#主题美化" class="headerlink" title="主题美化"></a>主题美化</h2><ol><li><p>在哪找？</p><p><a href="https://hexo.io/themes/">https://hexo.io/themes/</a></p></li><li><p>cd 进blog文件夹根目录，输入：</p><pre class="line-numbers language-none"><code class="language-none">git clone 主题http链接 themes/主题名称<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>主题会下载到themes文件夹下。</p></li><li><p>我用的是<a href="https://github.com/blinkfox/hexo-theme-matery%EF%BC%8C%E4%B8%BB%E9%A2%98%E5%90%8D%E7%A7%B0%E6%98%AFblinkfox%EF%BC%8C%E6%89%80%E4%BB%A5%E8%BE%93%E5%85%A5%EF%BC%9A">https://github.com/blinkfox/hexo-theme-matery，主题名称是blinkfox，所以输入：</a></p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">git</span> clone https://github.com/blinkfox/hexo-theme-matery themes/blinkfox<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></li><li><p>在下载的主题文件夹内有<strong>使用文档</strong>，中英文版本十分友好。</p></li><li><p>切换主题，找到根目录的_config.yml，将<code>landscape</code>改为<code>blinkfox</code>，也就是改为我们下载的主题名字：</p><pre class="line-numbers language-none"><code class="language-none"># Extensions## Plugins: https://hexo.io/plugins/## Themes: https://hexo.io/themes/theme: landscape<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre></li><li><p>然后再次部署网站，<code>hexo g</code>，<code>hexo d</code></p></li></ol><h3 id="主题更多个性化"><a href="#主题更多个性化" class="headerlink" title="主题更多个性化"></a>主题更多个性化</h3><p>我们可以通过修改根目录或者主题目录下的<code>_config.yml</code>，实现更多的<strong>个性化</strong>。当然，不同的主题的语法还有不同，修改方法请参考各主题的使用文档。例如：</p><ul><li><p><strong>代码高亮</strong></p><p>从 Hexo5.0 版本开始自带了 <code>prismjs</code> 代码语法高亮的支持，本主题对此进行了改造支持。</p><p>如果你的博客中曾经安装过 <code>hexo-prism-plugin</code> 的插件，那么你须要执行 <code>npm uninstall hexo-prism-plugin</code> 来卸载掉它，否则生成的代码中会有 <code>&amp;#123;</code> 和 <code>&amp;#125;</code> 的转义字符。</p><p>然后，修改 Hexo 根目录下 <code>_config.yml</code> 文件中 <code>highlight.enable</code> 的值为 <code>false</code>，并将 <code>prismjs.enable</code> 的值设置为 <code>true</code>，主要配置如下：</p><pre class="line-numbers language-yaml" data-language="yaml"><code class="language-yaml"><span class="token key atrule">highlight</span><span class="token punctuation">:</span>  <span class="token key atrule">enable</span><span class="token punctuation">:</span> <span class="token boolean important">false</span>  <span class="token key atrule">line_number</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>  <span class="token key atrule">auto_detect</span><span class="token punctuation">:</span> <span class="token boolean important">false</span>  <span class="token key atrule">tab_replace</span><span class="token punctuation">:</span> <span class="token string">''</span>  <span class="token key atrule">wrap</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>  <span class="token key atrule">hljs</span><span class="token punctuation">:</span> <span class="token boolean important">false</span><span class="token key atrule">prismjs</span><span class="token punctuation">:</span>  <span class="token key atrule">enable</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>  <span class="token key atrule">preprocess</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>  <span class="token key atrule">line_number</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>  <span class="token key atrule">tab_replace</span><span class="token punctuation">:</span> <span class="token string">''</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></li><li><p><strong>文章字数统计插件</strong>（建议安装）</p><p>如果你想要在文章中显示文章字数、阅读时长信息，可以安装 <a href="https://github.com/willin/hexo-wordcount">hexo-wordcount</a>插件。</p><p>安装命令如下：</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">npm</span> i --save hexo-wordcount<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>然后只需在本主题下的 <code>_config.yml</code> 文件中，将各个文章字数相关的配置激活即可：</p><pre class="line-numbers language-yaml" data-language="yaml"><code class="language-yaml"><span class="token key atrule">postInfo</span><span class="token punctuation">:</span>  <span class="token key atrule">date</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>  <span class="token key atrule">update</span><span class="token punctuation">:</span> <span class="token boolean important">false</span>  <span class="token key atrule">wordCount</span><span class="token punctuation">:</span> <span class="token boolean important">false</span> <span class="token comment"># 设置文章字数统计为 true.</span>  <span class="token key atrule">totalCount</span><span class="token punctuation">:</span> <span class="token boolean important">false</span> <span class="token comment"># 设置站点文章总字数统计为 true.</span>  <span class="token key atrule">min2read</span><span class="token punctuation">:</span> <span class="token boolean important">false</span> <span class="token comment"># 阅读时长.</span>  <span class="token key atrule">readCount</span><span class="token punctuation">:</span> <span class="token boolean important">false</span> <span class="token comment"># 阅读次数.</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></li><li><p>更多请查看主题使用文档</p></li></ul><h2 id="Github-amp-Coding-Pages-双部署"><a href="#Github-amp-Coding-Pages-双部署" class="headerlink" title="Github &amp; Coding Pages 双部署"></a>Github &amp; Coding Pages 双部署</h2><p>后续更新</p><h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><p>看到这里，相信您已经搭建出自己的个人博客网站了！</p>]]></content>
      
      
      <categories>
          
          <category> 博客搭建 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 搭建博客 </tag>
            
            <tag> hexo </tag>
            
            <tag> github </tag>
            
            <tag> matery </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>inception-resnet-v2超参数优化笔记</title>
      <link href="/2021/08/19/inception-resnet-v2-Parameter-optimization-note/"/>
      <url>/2021/08/19/inception-resnet-v2-Parameter-optimization-note/</url>
      
        <content type="html"><![CDATA[<h1 id="inception-resnet-v2优化笔记"><a href="#inception-resnet-v2优化笔记" class="headerlink" title="inception-resnet-v2优化笔记"></a>inception-resnet-v2优化笔记</h1><h2 id="csdn岩石数据集"><a href="#csdn岩石数据集" class="headerlink" title="csdn岩石数据集"></a>csdn岩石数据集</h2><h3 id="1"><a href="#1" class="headerlink" title="1"></a>1</h3><pre class="line-numbers language-none"><code class="language-none">   image_size = 299   batch_size = 32   num_train = 250   num_val = 50   epochs = 30model.compile(loss=tf.keras.losses.CategoricalCrossentropy(from_logits=False),  # BUG：交叉熵损失函数                     optimizer=tf.keras.optimizers.Adam(lr=0.001, beta_1=0.9, beta_2=0.999),                       metrics=['accuracy'])   x = layers.Dropout(0.5)(x)<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>![](<a href="https://cdn.jsdelivr.net/gh/JlexZhong/J.CS-note@main/inception-resnet-v2%E8%B6%85%E5%8F%82%E6%95%B0%E4%BC%98%E5%8C%96%E8%AE%B0%E5%BD%95.assets/2021-08-20-i">https://cdn.jsdelivr.net/gh/JlexZhong/J.CS-note@main/inception-resnet-v2超参数优化记录.assets/2021-08-20-i</a> and r 2 acc.png)</p><p>![](<a href="https://cdn.jsdelivr.net/gh/JlexZhong/J.CS-note@main/inception-resnet-v2%E8%B6%85%E5%8F%82%E6%95%B0%E4%BC%98%E5%8C%96%E8%AE%B0%E5%BD%95.assets/2021-08-20-i">https://cdn.jsdelivr.net/gh/JlexZhong/J.CS-note@main/inception-resnet-v2超参数优化记录.assets/2021-08-20-i</a> and r 2 loss.png)</p><h2 id="2"><a href="#2" class="headerlink" title="2"></a>2</h2><p>在1的基础上</p><pre class="line-numbers language-none"><code class="language-none">x = layers.Dropout(0.4)(x)reduce_lr =  tf.keras.callbacks.ReduceLROnPlateau(monitor='val_loss', patience=15,  verbose=1,mode='auto')<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p><img src="https://cdn.jsdelivr.net/gh/JlexZhong/J.CS-note@main/inception-resnet-v2%E8%B6%85%E5%8F%82%E6%95%B0%E4%BC%98%E5%8C%96%E8%AE%B0%E5%BD%95.assets/%E5%8A%A8%E6%80%81%E8%B0%83%E6%95%B4lr%EF%BC%8Cadam-los.png"></p><p><img src="https://cdn.jsdelivr.net/gh/JlexZhong/J.CS-note@main/inception-resnet-v2%E8%B6%85%E5%8F%82%E6%95%B0%E4%BC%98%E5%8C%96%E8%AE%B0%E5%BD%95.assets/%E5%8A%A8%E6%80%81%E8%B0%83%E6%95%B4lr%EF%BC%8Cadam-acc.png"></p><h3 id="3"><a href="#3" class="headerlink" title="3"></a>3</h3><pre class="line-numbers language-none"><code class="language-none">x = layers.Dropout(0.3)(x)lr=0.001, decay=0.0002, momentum=0.9sgd = SGD(lr=lr, decay=decay, momentum=momentum, nesterov=True)print('================编译模型=================')        model.compile(loss=tf.keras.losses.CategoricalCrossentropy(from_logits=False),  # BUG：交叉熵损失函数        optimizer=sgd,  #tf.keras.optimizers.Adam(lr=0.001, beta_1=0.9, beta_2=0.999)        metrics=['accuracy'])# 动态更改学习率reduce_lr =  tf.keras.callbacks.ReduceLROnPlateau()        <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>![](<a href="https://cdn.jsdelivr.net/gh/JlexZhong/J.CS-note@main/inception-resnet-v2%E8%B6%85%E5%8F%82%E6%95%B0%E4%BC%98%E5%8C%96%E8%AE%B0%E5%BD%95.assets/08-20-i">https://cdn.jsdelivr.net/gh/JlexZhong/J.CS-note@main/inception-resnet-v2超参数优化记录.assets/08-20-i</a> r sgd -loss.png)<br>![](<a href="https://cdn.jsdelivr.net/gh/JlexZhong/J.CS-note@main/inception-resnet-v2%E8%B6%85%E5%8F%82%E6%95%B0%E4%BC%98%E5%8C%96%E8%AE%B0%E5%BD%95.assets/08-20-i">https://cdn.jsdelivr.net/gh/JlexZhong/J.CS-note@main/inception-resnet-v2超参数优化记录.assets/08-20-i</a> r sgd -acc.png)</p><h2 id="scidbk镜下矿物薄片图像数据集"><a href="#scidbk镜下矿物薄片图像数据集" class="headerlink" title="scidbk镜下矿物薄片图像数据集"></a>scidbk镜下矿物薄片图像数据集</h2><h3 id="1-1"><a href="#1-1" class="headerlink" title="1"></a>1</h3><pre class="line-numbers language-python" data-language="python"><code class="language-python">总计：<span class="token number">989</span>train<span class="token punctuation">:</span><span class="token number">796</span>val<span class="token punctuation">:</span><span class="token number">147</span>test<span class="token punctuation">:</span><span class="token number">46</span>lr<span class="token operator">=</span><span class="token number">0.001</span><span class="token punctuation">,</span> decay<span class="token operator">=</span><span class="token number">0.0002</span><span class="token punctuation">,</span> momentum<span class="token operator">=</span><span class="token number">0.9</span>sgd <span class="token operator">=</span> SGD<span class="token punctuation">(</span>lr<span class="token operator">=</span>lr<span class="token punctuation">,</span> decay<span class="token operator">=</span>decay<span class="token punctuation">,</span> momentum<span class="token operator">=</span>momentum<span class="token punctuation">,</span> nesterov<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>reduce_lr <span class="token operator">=</span>  tf<span class="token punctuation">.</span>keras<span class="token punctuation">.</span>callbacks<span class="token punctuation">.</span>ReduceLROnPlateau<span class="token punctuation">(</span><span class="token punctuation">)</span>x <span class="token operator">=</span> layers<span class="token punctuation">.</span>Dropout<span class="token punctuation">(</span><span class="token number">0.4</span><span class="token punctuation">)</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-none"><code class="language-none">24/24 [==============================] - 374s 14s/step - loss: 2.1553 - accuracy: 0.4824 - val_loss: 0.7156 - val_accuracy: 0.7823Epoch 2/3024/24 [==============================] - 352s 14s/step - loss: 0.7679 - accuracy: 0.7475 - val_loss: 0.3818 - val_accuracy: 0.8503Epoch 3/3024/24 [==============================] - 290s 12s/step - loss: 0.4792 - accuracy: 0.8354 - val_loss: 0.3833 - val_accuracy: 0.8503Epoch 4/3024/24 [==============================] - 280s 11s/step - loss: 0.3891 - accuracy: 0.8693 - val_loss: 0.2691 - val_accuracy: 0.9048Epoch 5/3024/24 [==============================] - 331s 13s/step - loss: 0.2923 - accuracy: 0.8995 - val_loss: 0.2480 - val_accuracy: 0.8980Epoch 6/3024/24 [==============================] - 371s 15s/step - loss: 0.2635 - accuracy: 0.9133 - val_loss: 0.1679 - val_accuracy: 0.9388Epoch 7/3024/24 [==============================] - 374s 15s/step - loss: 0.3156 - accuracy: 0.8869 - val_loss: 0.1656 - val_accuracy: 0.9524Epoch 8/3024/24 [==============================] - 355s 14s/step - loss: 0.2576 - accuracy: 0.9146 - val_loss: 0.2341 - val_accuracy: 0.9116Epoch 9/3024/24 [==============================] - 365s 15s/step - loss: 0.2239 - accuracy: 0.9347 - val_loss: 0.1897 - val_accuracy: 0.9252Epoch 10/3024/24 [==============================] - 320s 13s/step - loss: 0.2377 - accuracy: 0.9196 - val_loss: 0.1559 - val_accuracy: 0.9456Epoch 11/3024/24 [==============================] - 289s 12s/step - loss: 0.2157 - accuracy: 0.9108 - val_loss: 0.1439 - val_accuracy: 0.9524Epoch 12/3024/24 [==============================] - 288s 12s/step - loss: 0.1980 - accuracy: 0.9296 - val_loss: 0.1760 - val_accuracy: 0.9320Epoch 13/3024/24 [==============================] - 288s 12s/step - loss: 0.1712 - accuracy: 0.9472 - val_loss: 0.1125 - val_accuracy: 0.9728Epoch 14/3024/24 [==============================] - 289s 12s/step - loss: 0.2244 - accuracy: 0.9246 - val_loss: 0.1753 - val_accuracy: 0.9252Epoch 15/3024/24 [==============================] - 290s 12s/step - loss: 0.2167 - accuracy: 0.9309 - val_loss: 0.1282 - val_accuracy: 0.9524Epoch 16/3024/24 [==============================] - 292s 12s/step - loss: 0.1749 - accuracy: 0.9372 - val_loss: 0.1213 - val_accuracy: 0.9456Epoch 17/3024/24 [==============================] - 300s 12s/step - loss: 0.2063 - accuracy: 0.9234 - val_loss: 0.1781 - val_accuracy: 0.9456Epoch 18/3024/24 [==============================] - 364s 15s/step - loss: 0.1768 - accuracy: 0.9397 - val_loss: 0.1639 - val_accuracy: 0.9456Epoch 19/3024/24 [==============================] - 357s 14s/step - loss: 0.1618 - accuracy: 0.9460 - val_loss: 0.1257 - val_accuracy: 0.9592Epoch 20/3024/24 [==============================] - 553s 22s/step - loss: 0.1960 - accuracy: 0.9422 - val_loss: 0.1187 - val_accuracy: 0.9524Epoch 21/3024/24 [==============================] - 355s 14s/step - loss: 0.1456 - accuracy: 0.9510 - val_loss: 0.1159 - val_accuracy: 0.9524Epoch 22/3024/24 [==============================] - 382s 15s/step - loss: 0.1256 - accuracy: 0.9523 - val_loss: 0.0699 - val_accuracy: 0.9660Epoch 23/3024/24 [==============================] - 356s 14s/step - loss: 0.1445 - accuracy: 0.9523 - val_loss: 0.0798 - val_accuracy: 0.9864Epoch 24/3024/24 [==============================] - 377s 15s/step - loss: 0.1284 - accuracy: 0.9422 - val_loss: 0.1049 - val_accuracy: 0.9592Epoch 25/3024/24 [==============================] - 344s 14s/step - loss: 0.1593 - accuracy: 0.9384 - val_loss: 0.1042 - val_accuracy: 0.9728Epoch 26/3024/24 [==============================] - 380s 15s/step - loss: 0.1241 - accuracy: 0.9598 - val_loss: 0.1363 - val_accuracy: 0.9592Epoch 27/3024/24 [==============================] - 367s 15s/step - loss: 0.1538 - accuracy: 0.9460 - val_loss: 0.1196 - val_accuracy: 0.9660Epoch 28/3024/24 [==============================] - 378s 15s/step - loss: 0.0946 - accuracy: 0.9636 - val_loss: 0.0695 - val_accuracy: 0.9592Epoch 29/3024/24 [==============================] - 366s 15s/step - loss: 0.1100 - accuracy: 0.9648 - val_loss: 0.1312 - val_accuracy: 0.9456Epoch 30/3024/24 [==============================] - 368s 14s/step - loss: 0.1270 - accuracy: 0.9560 - val_loss: 0.0658 - val_accuracy: 0.9660<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>![sci_drop0.4_sgd0.001 -loss](inception-resnet-v2超参数优化记录.assets/i and r loss.png)</p><p>![sci_drop0.4_sgd0.001 -acc](inception-resnet-v2超参数优化记录.assets/sci_drop0.4_sgd0.001 -acc.png)</p><h2 id="数据集8类（较少），ResNet152V2。adam默认优化器"><a href="#数据集8类（较少），ResNet152V2。adam默认优化器" class="headerlink" title="数据集8类（较少），ResNet152V2。adam默认优化器"></a>数据集8类（较少），ResNet152V2。adam默认优化器</h2><pre class="line-numbers language-python" data-language="python"><code class="language-python">x <span class="token operator">=</span> base_model<span class="token punctuation">.</span>output<span class="token comment">#添加自己的全链接分类层</span>x <span class="token operator">=</span> layers<span class="token punctuation">.</span>GlobalAveragePooling2D<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span>x <span class="token operator">=</span> layers<span class="token punctuation">.</span>Dense<span class="token punctuation">(</span><span class="token number">1024</span><span class="token punctuation">,</span> activation<span class="token operator">=</span><span class="token string">'relu'</span><span class="token punctuation">)</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span>predictions <span class="token operator">=</span> layers<span class="token punctuation">.</span>Dense<span class="token punctuation">(</span>nb_classes<span class="token punctuation">,</span> activation<span class="token operator">=</span><span class="token string">'softmax'</span><span class="token punctuation">)</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token comment">#训练模型</span>model <span class="token operator">=</span> Model<span class="token punctuation">(</span>inputs<span class="token operator">=</span>base_model<span class="token punctuation">.</span><span class="token builtin">input</span><span class="token punctuation">,</span> outputs<span class="token operator">=</span>predictions<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><strong>log：</strong></p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span>开始训练<span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span>Epoch <span class="token number">1</span>/40<span class="token number">17</span>/17 <span class="token punctuation">[</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token punctuation">]</span> - 57s 3s/step - loss: <span class="token number">2.3270</span> - accuracy: <span class="token number">0.4007</span> - val_loss: <span class="token number">0.7884</span> - val_accuracy: <span class="token number">0.7015</span>Epoch <span class="token number">2</span>/40<span class="token number">17</span>/17 <span class="token punctuation">[</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token punctuation">]</span> - 49s 3s/step - loss: <span class="token number">1.0187</span> - accuracy: <span class="token number">0.6690</span> - val_loss: <span class="token number">0.6000</span> - val_accuracy: <span class="token number">0.8209</span>Epoch <span class="token number">3</span>/40<span class="token number">17</span>/17 <span class="token punctuation">[</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token punctuation">]</span> - 50s 3s/step - loss: <span class="token number">0.7642</span> - accuracy: <span class="token number">0.7404</span> - val_loss: <span class="token number">0.5888</span> - val_accuracy: <span class="token number">0.7761</span>Epoch <span class="token number">4</span>/40<span class="token number">17</span>/17 <span class="token punctuation">[</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token punctuation">]</span> - 50s 3s/step - loss: <span class="token number">0.7589</span> - accuracy: <span class="token number">0.7265</span> - val_loss: <span class="token number">0.4681</span> - val_accuracy: <span class="token number">0.8507</span>Epoch <span class="token number">5</span>/40<span class="token number">17</span>/17 <span class="token punctuation">[</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token punctuation">]</span> - 50s 3s/step - loss: <span class="token number">0.5989</span> - accuracy: <span class="token number">0.7875</span> - val_loss: <span class="token number">0.5043</span> - val_accuracy: <span class="token number">0.8507</span>Epoch <span class="token number">6</span>/40<span class="token number">17</span>/17 <span class="token punctuation">[</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token punctuation">]</span> - 49s 3s/step - loss: <span class="token number">0.5459</span> - accuracy: <span class="token number">0.7997</span> - val_loss: <span class="token number">0.5242</span> - val_accuracy: <span class="token number">0.8507</span>Epoch <span class="token number">7</span>/40<span class="token number">17</span>/17 <span class="token punctuation">[</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token punctuation">]</span> - 50s 3s/step - loss: <span class="token number">0.4877</span> - accuracy: <span class="token number">0.8397</span> - val_loss: <span class="token number">0.5059</span> - val_accuracy: <span class="token number">0.8209</span>Epoch <span class="token number">8</span>/40<span class="token number">17</span>/17 <span class="token punctuation">[</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token punctuation">]</span> - 49s 3s/step - loss: <span class="token number">0.5193</span> - accuracy: <span class="token number">0.8136</span> - val_loss: <span class="token number">0.2059</span> - val_accuracy: <span class="token number">0.9254</span>Epoch <span class="token number">9</span>/40<span class="token number">17</span>/17 <span class="token punctuation">[</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token punctuation">]</span> - 50s 3s/step - loss: <span class="token number">0.4585</span> - accuracy: <span class="token number">0.8345</span> - val_loss: <span class="token number">0.3750</span> - val_accuracy: <span class="token number">0.8507</span>Epoch <span class="token number">10</span>/40<span class="token number">17</span>/17 <span class="token punctuation">[</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token punctuation">]</span> - 50s 3s/step - loss: <span class="token number">0.4579</span> - accuracy: <span class="token number">0.8519</span> - val_loss: <span class="token number">0.3463</span> - val_accuracy: <span class="token number">0.8657</span>Epoch <span class="token number">11</span>/40<span class="token number">17</span>/17 <span class="token punctuation">[</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token punctuation">]</span> - 50s 3s/step - loss: <span class="token number">0.3721</span> - accuracy: <span class="token number">0.8676</span> - val_loss: <span class="token number">0.1566</span> - val_accuracy: <span class="token number">0.9254</span>Epoch <span class="token number">12</span>/40<span class="token number">17</span>/17 <span class="token punctuation">[</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token punctuation">]</span> - 50s 3s/step - loss: <span class="token number">0.3437</span> - accuracy: <span class="token number">0.8815</span> - val_loss: <span class="token number">0.5633</span> - val_accuracy: <span class="token number">0.8358</span>Epoch <span class="token number">13</span>/40<span class="token number">17</span>/17 <span class="token punctuation">[</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token punctuation">]</span> - 50s 3s/step - loss: <span class="token number">0.4076</span> - accuracy: <span class="token number">0.8519</span> - val_loss: <span class="token number">0.2954</span> - val_accuracy: <span class="token number">0.9104</span>Epoch <span class="token number">14</span>/40<span class="token number">17</span>/17 <span class="token punctuation">[</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token punctuation">]</span> - 50s 3s/step - loss: <span class="token number">0.4405</span> - accuracy: <span class="token number">0.8449</span> - val_loss: <span class="token number">0.2551</span> - val_accuracy: <span class="token number">0.8806</span>Epoch <span class="token number">15</span>/40<span class="token number">17</span>/17 <span class="token punctuation">[</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token punctuation">]</span> - 50s 3s/step - loss: <span class="token number">0.3651</span> - accuracy: <span class="token number">0.8571</span> - val_loss: <span class="token number">0.3771</span> - val_accuracy: <span class="token number">0.8657</span>Epoch <span class="token number">16</span>/40<span class="token number">17</span>/17 <span class="token punctuation">[</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token punctuation">]</span> - 50s 3s/step - loss: <span class="token number">0.4123</span> - accuracy: <span class="token number">0.8659</span> - val_loss: <span class="token number">0.2305</span> - val_accuracy: <span class="token number">0.8806</span>Epoch <span class="token number">17</span>/40<span class="token number">17</span>/17 <span class="token punctuation">[</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token punctuation">]</span> - 49s 3s/step - loss: <span class="token number">0.3828</span> - accuracy: <span class="token number">0.8676</span> - val_loss: <span class="token number">0.3204</span> - val_accuracy: <span class="token number">0.9403</span>Epoch <span class="token number">18</span>/40<span class="token number">17</span>/17 <span class="token punctuation">[</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token punctuation">]</span> - 50s 3s/step - loss: <span class="token number">0.3089</span> - accuracy: <span class="token number">0.9059</span> - val_loss: <span class="token number">0.2343</span> - val_accuracy: <span class="token number">0.8955</span>Epoch <span class="token number">19</span>/40<span class="token number">17</span>/17 <span class="token punctuation">[</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token punctuation">]</span> - 50s 3s/step - loss: <span class="token number">0.4013</span> - accuracy: <span class="token number">0.8537</span> - val_loss: <span class="token number">0.2916</span> - val_accuracy: <span class="token number">0.8955</span>Epoch <span class="token number">20</span>/40<span class="token number">17</span>/17 <span class="token punctuation">[</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token punctuation">]</span> - 49s 3s/step - loss: <span class="token number">0.3247</span> - accuracy: <span class="token number">0.8693</span> - val_loss: <span class="token number">0.1626</span> - val_accuracy: <span class="token number">0.9403</span>Epoch <span class="token number">21</span>/40<span class="token number">17</span>/17 <span class="token punctuation">[</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token punctuation">]</span> - 50s 3s/step - loss: <span class="token number">0.3564</span> - accuracy: <span class="token number">0.8659</span> - val_loss: <span class="token number">0.2356</span> - val_accuracy: <span class="token number">0.9403</span>Epoch <span class="token number">22</span>/40<span class="token number">17</span>/17 <span class="token punctuation">[</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token punctuation">]</span> - 49s 3s/step - loss: <span class="token number">0.3821</span> - accuracy: <span class="token number">0.8589</span> - val_loss: <span class="token number">0.3760</span> - val_accuracy: <span class="token number">0.8657</span>Epoch <span class="token number">23</span>/40<span class="token number">17</span>/17 <span class="token punctuation">[</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token punctuation">]</span> - 50s 3s/step - loss: <span class="token number">0.3681</span> - accuracy: <span class="token number">0.8676</span> - val_loss: <span class="token number">0.2977</span> - val_accuracy: <span class="token number">0.8955</span>Epoch <span class="token number">24</span>/40<span class="token number">17</span>/17 <span class="token punctuation">[</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token punctuation">]</span> - 49s 3s/step - loss: <span class="token number">0.3279</span> - accuracy: <span class="token number">0.8850</span> - val_loss: <span class="token number">0.2885</span> - val_accuracy: <span class="token number">0.8955</span>Epoch <span class="token number">25</span>/40<span class="token number">17</span>/17 <span class="token punctuation">[</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token punctuation">]</span> - 50s 3s/step - loss: <span class="token number">0.2966</span> - accuracy: <span class="token number">0.8728</span> - val_loss: <span class="token number">0.3733</span> - val_accuracy: <span class="token number">0.8507</span>Epoch <span class="token number">26</span>/40<span class="token number">17</span>/17 <span class="token punctuation">[</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token punctuation">]</span> - 49s 3s/step - loss: <span class="token number">0.3201</span> - accuracy: <span class="token number">0.8868</span> - val_loss: <span class="token number">0.1600</span> - val_accuracy: <span class="token number">0.9701</span>Epoch <span class="token number">27</span>/40<span class="token number">17</span>/17 <span class="token punctuation">[</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token punctuation">]</span> - 50s 3s/step - loss: <span class="token number">0.3249</span> - accuracy: <span class="token number">0.8833</span> - val_loss: <span class="token number">0.1363</span> - val_accuracy: <span class="token number">0.9403</span>Epoch <span class="token number">28</span>/40<span class="token number">17</span>/17 <span class="token punctuation">[</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token punctuation">]</span> - 49s 3s/step - loss: <span class="token number">0.3399</span> - accuracy: <span class="token number">0.8763</span> - val_loss: <span class="token number">0.2085</span> - val_accuracy: <span class="token number">0.9254</span>Epoch <span class="token number">29</span>/40<span class="token number">17</span>/17 <span class="token punctuation">[</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token punctuation">]</span> - 50s 3s/step - loss: <span class="token number">0.2448</span> - accuracy: <span class="token number">0.9233</span> - val_loss: <span class="token number">0.2178</span> - val_accuracy: <span class="token number">0.9104</span>Epoch <span class="token number">30</span>/40<span class="token number">17</span>/17 <span class="token punctuation">[</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token punctuation">]</span> - 49s 3s/step - loss: <span class="token number">0.2751</span> - accuracy: <span class="token number">0.8955</span> - val_loss: <span class="token number">0.3133</span> - val_accuracy: <span class="token number">0.8806</span>Epoch <span class="token number">31</span>/40<span class="token number">17</span>/17 <span class="token punctuation">[</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token punctuation">]</span> - 49s 3s/step - loss: <span class="token number">0.2704</span> - accuracy: <span class="token number">0.8920</span> - val_loss: <span class="token number">0.1331</span> - val_accuracy: <span class="token number">0.9552</span>Epoch <span class="token number">32</span>/40<span class="token number">17</span>/17 <span class="token punctuation">[</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token punctuation">]</span> - 50s 3s/step - loss: <span class="token number">0.3623</span> - accuracy: <span class="token number">0.8868</span> - val_loss: <span class="token number">0.1144</span> - val_accuracy: <span class="token number">0.9552</span>Epoch <span class="token number">33</span>/40<span class="token number">17</span>/17 <span class="token punctuation">[</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token punctuation">]</span> - 49s 3s/step - loss: <span class="token number">0.2863</span> - accuracy: <span class="token number">0.8798</span> - val_loss: <span class="token number">0.1851</span> - val_accuracy: <span class="token number">0.9403</span>Epoch <span class="token number">34</span>/40<span class="token number">17</span>/17 <span class="token punctuation">[</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token punctuation">]</span> - 50s 3s/step - loss: <span class="token number">0.2935</span> - accuracy: <span class="token number">0.9059</span> - val_loss: <span class="token number">0.1641</span> - val_accuracy: <span class="token number">0.9552</span>Epoch <span class="token number">35</span>/40<span class="token number">17</span>/17 <span class="token punctuation">[</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token punctuation">]</span> - 49s 3s/step - loss: <span class="token number">0.2440</span> - accuracy: <span class="token number">0.9146</span> - val_loss: <span class="token number">0.2485</span> - val_accuracy: <span class="token number">0.9254</span>Epoch <span class="token number">36</span>/40<span class="token number">17</span>/17 <span class="token punctuation">[</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token punctuation">]</span> - 50s 3s/step - loss: <span class="token number">0.2578</span> - accuracy: <span class="token number">0.9111</span> - val_loss: <span class="token number">0.1363</span> - val_accuracy: <span class="token number">0.9552</span>Epoch <span class="token number">37</span>/40<span class="token number">17</span>/17 <span class="token punctuation">[</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token punctuation">]</span> - 50s 3s/step - loss: <span class="token number">0.2798</span> - accuracy: <span class="token number">0.9042</span> - val_loss: <span class="token number">0.1749</span> - val_accuracy: <span class="token number">0.9403</span>Epoch <span class="token number">38</span>/40<span class="token number">17</span>/17 <span class="token punctuation">[</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token punctuation">]</span> - 50s 3s/step - loss: <span class="token number">0.2619</span> - accuracy: <span class="token number">0.9077</span> - val_loss: <span class="token number">0.2854</span> - val_accuracy: <span class="token number">0.8955</span>Epoch <span class="token number">39</span>/40<span class="token number">17</span>/17 <span class="token punctuation">[</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token punctuation">]</span> - 49s 3s/step - loss: <span class="token number">0.1995</span> - accuracy: <span class="token number">0.9303</span> - val_loss: <span class="token number">0.1245</span> - val_accuracy: <span class="token number">0.9851</span>Epoch <span class="token number">40</span>/40<span class="token number">17</span>/17 <span class="token punctuation">[</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token punctuation">]</span> - 50s 3s/step - loss: <span class="token number">0.2499</span> - accuracy: <span class="token number">0.9111</span> - val_loss: <span class="token number">0.2573</span> - val_accuracy: <span class="token number">0.9254</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span>保存模型<span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>计算中断未获取到acc-loss图。</p>]]></content>
      
      
      <categories>
          
          <category> 图像分类 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 深度学习 </tag>
            
            <tag> tensorflow </tag>
            
            <tag> keras </tag>
            
            <tag> 图像分类 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>pyqt小记 | 添加右键菜单，添加图标和点击事件</title>
      <link href="/2021/08/17/pyqt-context-add-icon-click/"/>
      <url>/2021/08/17/pyqt-context-add-icon-click/</url>
      
        <content type="html"><![CDATA[<h1 id="pyqt小记-添加右键菜单，添加图标和点击事件"><a href="#pyqt小记-添加右键菜单，添加图标和点击事件" class="headerlink" title="pyqt小记 | 添加右键菜单，添加图标和点击事件"></a>pyqt小记 | 添加右键菜单，添加图标和点击事件</h1><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">def</span> <span class="token function">contextMenuEvent</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> pos<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token triple-quoted-string string">"""    右键菜单    :param pos:    :return:    """</span>    self<span class="token punctuation">.</span>contextMenu <span class="token operator">=</span> QMenu<span class="token punctuation">(</span><span class="token punctuation">)</span>    self<span class="token punctuation">.</span>action_pgPlot <span class="token operator">=</span> self<span class="token punctuation">.</span>contextMenu<span class="token punctuation">.</span>addAction<span class="token punctuation">(</span>        QIcon<span class="token punctuation">(</span><span class="token string">"./icons/logo.ico"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">u'| 使用PyqtGraph绘制散点图'</span><span class="token punctuation">)</span>    self<span class="token punctuation">.</span>action_plotCircle <span class="token operator">=</span> self<span class="token punctuation">.</span>contextMenu<span class="token punctuation">.</span>addAction<span class="token punctuation">(</span>        QIcon<span class="token punctuation">(</span><span class="token string">"./icons/plot.ico"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">u'| 使用matplotlib绘制二维圆图'</span><span class="token punctuation">)</span>    self<span class="token punctuation">.</span>action_plotPoint <span class="token operator">=</span> self<span class="token punctuation">.</span>contextMenu<span class="token punctuation">.</span>addAction<span class="token punctuation">(</span>        QIcon<span class="token punctuation">(</span><span class="token string">"./icons/plotPoint.png"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">u'| 使用matplotlib绘制散点图'</span><span class="token punctuation">)</span>    self<span class="token punctuation">.</span>action_clear_dataView <span class="token operator">=</span> self<span class="token punctuation">.</span>contextMenu<span class="token punctuation">.</span>addAction<span class="token punctuation">(</span>        QIcon<span class="token punctuation">(</span><span class="token string">"./icons/clear.ico"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">u'| 清除数据与图像'</span><span class="token punctuation">)</span>    self<span class="token punctuation">.</span>contextMenu<span class="token punctuation">.</span>popup<span class="token punctuation">(</span>QCursor<span class="token punctuation">.</span>pos<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment"># 菜单显示的位置</span>    self<span class="token punctuation">.</span>action_plotCircle<span class="token punctuation">.</span>triggered<span class="token punctuation">.</span>connect<span class="token punctuation">(</span>self<span class="token punctuation">.</span>plotAllSlot_circle<span class="token punctuation">)</span>    self<span class="token punctuation">.</span>action_plotPoint<span class="token punctuation">.</span>triggered<span class="token punctuation">.</span>connect<span class="token punctuation">(</span>self<span class="token punctuation">.</span>plotAllSlot_point<span class="token punctuation">)</span>    self<span class="token punctuation">.</span>action_pgPlot<span class="token punctuation">.</span>triggered<span class="token punctuation">.</span>connect<span class="token punctuation">(</span>self<span class="token punctuation">.</span>pg_plot<span class="token punctuation">)</span>    font <span class="token operator">=</span> QtGui<span class="token punctuation">.</span>QFont<span class="token punctuation">(</span><span class="token punctuation">)</span>    font<span class="token punctuation">.</span>setFamily<span class="token punctuation">(</span><span class="token string">"黑体"</span><span class="token punctuation">)</span>    font<span class="token punctuation">.</span>setPointSize<span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span>    font<span class="token punctuation">.</span>setBold<span class="token punctuation">(</span><span class="token boolean">True</span><span class="token punctuation">)</span>    self<span class="token punctuation">.</span>action_pgPlot<span class="token punctuation">.</span>setFont<span class="token punctuation">(</span>font<span class="token punctuation">)</span>    self<span class="token punctuation">.</span>action_clear_dataView<span class="token punctuation">.</span>triggered<span class="token punctuation">.</span>connect<span class="token punctuation">(</span>self<span class="token punctuation">.</span>clear_dataView<span class="token punctuation">)</span>    self<span class="token punctuation">.</span>contextMenu<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>类继承于QTableView</p><p><strong>效果：</strong></p><p>![](<a href="https://cdn.jsdelivr.net/gh/JlexZhong/J.CS-note@main/pyqt%E5%B0%8F%E8%AE%B0">https://cdn.jsdelivr.net/gh/JlexZhong/J.CS-note@main/pyqt小记</a>  添加右键菜单，添加图标和点击事件.assets/右键菜单 2021-08-19 133503.png)</p>]]></content>
      
      
      
        <tags>
            
            <tag> PyQt </tag>
            
            <tag> GUI </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>tensorflow2 模型的保存和载入 h5和ckpt的用法 断点续训</title>
      <link href="/2021/08/15/tensorflow2-load-save/"/>
      <url>/2021/08/15/tensorflow2-load-save/</url>
      
        <content type="html"><![CDATA[<h1 id="tensorflow2-模型的保存和载入-h5和ckpt的用法-小记"><a href="#tensorflow2-模型的保存和载入-h5和ckpt的用法-小记" class="headerlink" title="tensorflow2 模型的保存和载入 h5和ckpt的用法 | 小记"></a>tensorflow2 模型的保存和载入 h5和ckpt的用法 | 小记</h1><h2 id="断点续训-检查点"><a href="#断点续训-检查点" class="headerlink" title="断点续训/检查点"></a>断点续训/检查点</h2><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># 断点续训</span>checkpoint_path <span class="token operator">=</span> <span class="token string">'ckpt/transfer_{epoch:02d}-{val_acc:.2f}.ckpt'</span>  <span class="token comment"># 格式化字符，防止文件名冲突</span>checkpoint_callback <span class="token operator">=</span> tf<span class="token punctuation">.</span>keras<span class="token punctuation">.</span>callbacks<span class="token punctuation">.</span>ModelCheckpoint<span class="token punctuation">(</span>checkpoint_path<span class="token punctuation">,</span>  <span class="token comment"># 保存路径</span>                                monitor<span class="token operator">=</span><span class="token string">'val_acc'</span><span class="token punctuation">,</span>  <span class="token comment"># 监测指标，这里是测试集的acc</span>                                save_weights_only<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">,</span>  <span class="token comment">#是否只保存权重</span>                                mode<span class="token operator">=</span><span class="token string">'auto'</span><span class="token punctuation">,</span>                                period<span class="token operator">=</span><span class="token number">1</span>  <span class="token comment"># 每period个周期保存一次</span>                                <span class="token punctuation">)</span><span class="token comment"># 需要在fit/fit_generator()中添加该回调函数</span>history_ft <span class="token operator">=</span> model<span class="token punctuation">.</span>fit_generator<span class="token punctuation">(</span>                                        train_generator<span class="token punctuation">,</span>                                        steps_per_epoch<span class="token operator">=</span>steps_per_epoch<span class="token punctuation">,</span>                                        epochs<span class="token operator">=</span>epochs<span class="token punctuation">,</span>                                        validation_data<span class="token operator">=</span>validation_generator<span class="token punctuation">,</span>                                        validation_steps<span class="token operator">=</span>validation_steps<span class="token punctuation">,</span>                                        callbacks <span class="token operator">=</span> <span class="token punctuation">[</span>checkpoint_callback<span class="token punctuation">]</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="保存全部模型（ckpt）："><a href="#保存全部模型（ckpt）：" class="headerlink" title="保存全部模型（ckpt）："></a><strong>保存全部模型</strong>（ckpt）：</h3><p>![image-20210814230542472](<a href="https://cdn.jsdelivr.net/gh/JlexZhong/J.CS-note@main/tensorflow2">https://cdn.jsdelivr.net/gh/JlexZhong/J.CS-note@main/tensorflow2</a> 模型的保存和载入用法.assets/all_ckpt.png)</p><p>读取方法：</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">model <span class="token operator">=</span> tf<span class="token punctuation">.</span>keras<span class="token punctuation">.</span>models<span class="token punctuation">.</span>load_model<span class="token punctuation">(</span><span class="token string">'./ckpt/transfer_03-0.98.ckpt'</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h3 id="保存全部模型（h5）"><a href="#保存全部模型（h5）" class="headerlink" title="保存全部模型（h5）:"></a>保存全部模型（h5）:</h3><p>![image-20210814233340073](<a href="https://cdn.jsdelivr.net/gh/JlexZhong/J.CS-note@main/tensorflow2">https://cdn.jsdelivr.net/gh/JlexZhong/J.CS-note@main/tensorflow2</a> 模型的保存和载入用法.assets/all_h5.png)</p><p>读取方法:</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">model <span class="token operator">=</span> load_model<span class="token punctuation">(</span><span class="token string">'./ckpt/transfer_06-0.94.h5'</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h3 id="仅保存权重（ckpt）："><a href="#仅保存权重（ckpt）：" class="headerlink" title="仅保存权重（ckpt）："></a><strong>仅保存权重（ckpt）</strong>：</h3><p>读取方法：</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">checkpoint_path <span class="token operator">=</span> <span class="token string">'ckpt/transfer_{epoch:02d}-{val_acc:.2f}.ckpt'</span>checkpoint_dir <span class="token operator">=</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>dirname<span class="token punctuation">(</span>checkpoint_path<span class="token punctuation">)</span>latest_model <span class="token operator">=</span> tf<span class="token punctuation">.</span>train<span class="token punctuation">.</span>latest_checkpoint<span class="token punctuation">(</span>checkpoint_dir<span class="token punctuation">)</span>  <span class="token comment"># 找到最新保存的断点</span>model<span class="token punctuation">.</span>load_weights<span class="token punctuation">(</span>latest_model<span class="token punctuation">)</span>  <span class="token comment"># 读取权重，model的结构必须与训练的网络结构一致</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><h3 id="仅保存权重（h5）"><a href="#仅保存权重（h5）" class="headerlink" title="仅保存权重（h5）"></a>仅保存权重（h5）</h3><p>![](<a href="https://cdn.jsdelivr.net/gh/JlexZhong/J.CS-note@main/tensorflow2">https://cdn.jsdelivr.net/gh/JlexZhong/J.CS-note@main/tensorflow2</a> 模型的保存和载入用法.assets/only_h5.png)</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">model<span class="token punctuation">.</span>load_weights<span class="token punctuation">(</span><span class="token string">'./ckpt/transfer_18-0.97.h5'</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><strong>tf.train.latest_checkpoint()</strong> 方法用于找到目录下<strong>最新</strong>的检查点</p><p>并且似乎<strong>只对ckpt有作用</strong></p><h2 id="model-save-保存模型"><a href="#model-save-保存模型" class="headerlink" title="model.save()保存模型"></a>model.save()保存模型</h2><pre class="line-numbers language-python" data-language="python"><code class="language-python">path_save_model <span class="token operator">=</span> <span class="token string">'model/my_saved_InceptionV3_model.h5'</span>model<span class="token punctuation">.</span>save<span class="token punctuation">(</span>path_save_model<span class="token punctuation">,</span> overwrite<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>]]></content>
      
      
      <categories>
          
          <category> tensorflow </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 深度学习 </tag>
            
            <tag> tensorflow </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>我的第一篇博客</title>
      <link href="/2021/08/13/first_blog/"/>
      <url>/2021/08/13/first_blog/</url>
      
        <content type="html"><![CDATA[<p>大家好，这是我的第一篇博客，见证了自建个人博客的成功。</p><p>接下来，我将在这里发布我的学习记录和问题，以及一些项目，敬请期待！</p><p>本人非科班选手，如有不足还望各位指正哦！</p>]]></content>
      
      
      
        <tags>
            
            <tag> 生活 </tag>
            
        </tags>
      
    </entry>
    
    
  
  
</search>
